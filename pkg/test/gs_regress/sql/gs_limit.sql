DROP TABLE IF EXISTS T_LIMIT_1;
DROP TABLE IF EXISTS T_LIMIT_2;
CREATE TABLE T_LIMIT_1 (F_INT1 INT, F_INT2 INT, F_CHAR CHAR(16), F_DATE TIMESTAMP);
CREATE TABLE T_LIMIT_2 (F_INT1 INT, F_INT2 INT, F_CHAR CHAR(16), F_DATE TIMESTAMP);

SELECT * FROM T_LIMIT_1 ORDER BY F_INT1,F_INT2 LIMIT 2,1 LIMIT 2,1;
SELECT * FROM T_LIMIT_1 LIMIT 4 LIMIT 4 UNION ALL SELECT * FROM T_LIMIT_2 LIMIT 4 OFFSET 1;

SELECT * FROM T_LIMIT_1 ORDER BY F_INT1,F_INT2 LIMIT 2,1;
SELECT * FROM (SELECT * FROM T_LIMIT_1 ORDER BY F_INT1,F_INT2 LIMIT 2,1);
(SELECT F_INT1 FROM T_LIMIT_1 ORDER BY F_INT1 LIMIT 2) UNION ALL (SELECT F_INT1 FROM T_LIMIT_2 ORDER BY F_INT1 DESC LIMIT 1) ORDER BY F_INT1 DESC LIMIT 1,1;
(SELECT F_INT1 FROM T_LIMIT_1 GROUP BY F_INT1) UNION ALL (SELECT F_INT1 FROM T_LIMIT_2 GROUP BY F_INT1) ORDER BY F_INT1 DESC LIMIT 2,4;
SELECT * FROM T_LIMIT_1 UNION ALL SELECT * FROM T_LIMIT_2 ORDER BY F_INT1,F_INT2 DESC LIMIT 4 OFFSET 1;
(SELECT * FROM T_LIMIT_1) UNION ALL (SELECT * FROM T_LIMIT_2) ORDER BY F_INT1,F_INT2 DESC LIMIT 3,1;
(SELECT * FROM T_LIMIT_1) UNION ALL (SELECT * FROM T_LIMIT_2) ORDER BY F_DATE DESC,F_INT1 DESC LIMIT 0,1;
(SELECT * FROM T_LIMIT_1) UNION ALL (SELECT * FROM T_LIMIT_2) UNION ALL (SELECT * FROM T_LIMIT_1) ORDER BY F_INT1,F_INT2 DESC LIMIT 1;
(SELECT * FROM T_LIMIT_1) UNION ALL (SELECT * FROM T_LIMIT_2) UNION ALL (SELECT * FROM T_LIMIT_1) ORDER BY F_DATE DESC,F_INT1 DESC LIMIT 1 OFFSET 0;
(SELECT * FROM T_LIMIT_1 WHERE F_INT1 = 1) UNION ALL (SELECT * FROM T_LIMIT_2 WHERE F_INT2 = 3) UNION ALL (SELECT * FROM T_LIMIT_1) ORDER BY F_INT1,F_INT2 DESC LIMIT 2,1;

INSERT INTO T_LIMIT_1 VALUES(1,2,'A','2017-12-11 14:08:00.1408');
INSERT INTO T_LIMIT_1 VALUES(3,4,'C','2017-12-12 16:08:00.1608');
INSERT INTO T_LIMIT_1 VALUES(1,3,'A','2017-12-11 14:18:00.1418');
INSERT INTO T_LIMIT_1 VALUES(2,3,'B','2017-12-11 16:08:00.1608');
INSERT INTO T_LIMIT_2 VALUES(4,2,'A','2017-12-11 14:08:00.1408');
INSERT INTO T_LIMIT_2 VALUES(6,4,'C','2017-12-12 16:08:00.1608');
INSERT INTO T_LIMIT_2 VALUES(4,3,'A','2017-12-11 14:18:00.1418');
INSERT INTO T_LIMIT_2 VALUES(5,3,'B','2017-12-11 16:08:00.1608');

SELECT * FROM T_LIMIT_1 ORDER BY F_INT1,F_INT2 LIMIT 2,1;
SELECT * FROM (SELECT * FROM T_LIMIT_1 ORDER BY F_INT1,F_INT2 LIMIT 2,1);
(SELECT F_INT1 FROM T_LIMIT_1 ORDER BY F_INT1 LIMIT 2) UNION ALL (SELECT F_INT1 FROM T_LIMIT_2 ORDER BY F_INT1 DESC LIMIT 1) ORDER BY F_INT1 DESC LIMIT 1,1;
(SELECT F_INT1 FROM T_LIMIT_1 GROUP BY F_INT1) UNION ALL (SELECT F_INT1 FROM T_LIMIT_2 GROUP BY F_INT1) ORDER BY F_INT1 DESC LIMIT 2,4;
SELECT * FROM T_LIMIT_1 UNION ALL SELECT * FROM T_LIMIT_2 ORDER BY F_INT1,F_INT2 DESC LIMIT 4 OFFSET 1;
(SELECT * FROM T_LIMIT_1) UNION ALL (SELECT * FROM T_LIMIT_2) ORDER BY F_INT1,F_INT2 DESC LIMIT 3,1;
(SELECT * FROM T_LIMIT_1) UNION ALL (SELECT * FROM T_LIMIT_2) ORDER BY F_DATE DESC,F_INT1 DESC LIMIT 0,1;
(SELECT * FROM T_LIMIT_1) UNION ALL (SELECT * FROM T_LIMIT_2) UNION ALL (SELECT * FROM T_LIMIT_1) ORDER BY F_INT1,F_INT2 DESC LIMIT 1;
(SELECT * FROM T_LIMIT_1) UNION ALL (SELECT * FROM T_LIMIT_2) UNION ALL (SELECT * FROM T_LIMIT_1) ORDER BY F_DATE DESC,F_INT1 DESC LIMIT 1 OFFSET 0;
(SELECT * FROM T_LIMIT_1 WHERE F_INT1 = 1) UNION ALL (SELECT * FROM T_LIMIT_2 WHERE F_INT2 = 3) UNION ALL (SELECT * FROM T_LIMIT_1) ORDER BY F_INT1,F_INT2 DESC LIMIT 2,1;

DELETE FROM T_LIMIT_1;
DELETE FROM T_LIMIT_2;
DROP TABLE IF EXISTS T_LIMIT_3;
CREATE TABLE T_LIMIT_3 (F_INT1 INT, F_INT3 INT, F_CHAR2 CHAR(16));
INSERT INTO T_LIMIT_1 VALUES(1,2,'A','2017-12-11 14:08:00.1408');
INSERT INTO T_LIMIT_1 VALUES(3,4,'C','2017-12-12 16:08:00.1608');
INSERT INTO T_LIMIT_1 VALUES(1,3,'A','2017-12-11 14:18:00.1418');
INSERT INTO T_LIMIT_1 VALUES(2,3,'B','2017-12-11 16:08:00.1608');
INSERT INTO T_LIMIT_2 VALUES(4,2,'A','2017-12-11 14:08:00.1408');
INSERT INTO T_LIMIT_2 VALUES(6,4,'C','2017-12-12 16:08:00.1608');
INSERT INTO T_LIMIT_2 VALUES(4,3,'A','2017-12-11 14:18:00.1418');
INSERT INTO T_LIMIT_2 VALUES(5,3,'B','2017-12-11 16:08:00.1608');
INSERT INTO T_LIMIT_3 VALUES(1,3,'A');
INSERT INTO T_LIMIT_3 VALUES(2,3,'B');
INSERT INTO T_LIMIT_3 VALUES(4,3,'A');
INSERT INTO T_LIMIT_3 VALUES(5,3,'B');

SELECT * FROM T_LIMIT_1 ORDER BY F_INT1,F_INT2 LIMIT 2::bigint + 0::bigint, '1'::bigint;
SELECT * FROM (SELECT * FROM T_LIMIT_1 ORDER BY F_INT1,F_INT2 LIMIT  1::bigint + '1', 1);
SELECT * FROM T_LIMIT_1 ORDER BY F_INT1,F_INT2 OFFSET '2' + 0::bigint;
SELECT * FROM T_LIMIT_1 ORDER BY F_INT1,F_INT2 OFFSET '2' + 0::bigint LIMIT '10';
SELECT (SELECT AVG(F_CHAR) FROM T_LIMIT_1 GROUP BY F_INT1 LIMIT 0), F_INT1, F_CHAR FROM T_LIMIT_1 ORDER BY F_INT1 LIMIT (1+2);
SELECT * FROM T_LIMIT_1 ORDER BY F_INT1 OFFSET 2;
SELECT * FROM T_LIMIT_1 ORDER BY F_INT1 OFFSET 2+0;
SELECT * FROM T_LIMIT_1 ORDER BY F_INT1 LIMIT NULL;
DROP TABLE IF EXISTS T_LIMIT_3;
DELETE FROM T_LIMIT_1;
DELETE FROM T_LIMIT_2;

CREATE INDEX T_LIMIT_1_INDEX_1 ON T_LIMIT_1(F_INT1);
CREATE INDEX T_LIMIT_2_INDEX_1 ON T_LIMIT_2(F_INT1);

SELECT * FROM T_LIMIT_1 WHERE F_INT1 >1 ORDER BY F_INT1,F_INT2 LIMIT 2,1;
SELECT * FROM (SELECT * FROM T_LIMIT_1 WHERE F_INT1 = 1 ORDER BY F_INT1,F_INT2 LIMIT 2,1);
(SELECT F_INT1 FROM T_LIMIT_1 ORDER BY F_INT1 LIMIT 2) UNION ALL (SELECT F_INT1 FROM T_LIMIT_2 ORDER BY F_INT1 DESC LIMIT 1) ORDER BY F_INT1 DESC LIMIT 1,1;
(SELECT F_INT1 FROM T_LIMIT_1 GROUP BY F_INT1) UNION ALL (SELECT F_INT1 FROM T_LIMIT_2 GROUP BY F_INT1) ORDER BY F_INT1 DESC LIMIT 2,4;
SELECT * FROM T_LIMIT_1 UNION ALL SELECT * FROM T_LIMIT_2 ORDER BY F_INT1,F_INT2 DESC LIMIT 4 OFFSET 1;
(SELECT * FROM T_LIMIT_1 WHERE F_INT1 >1 ) UNION ALL (SELECT * FROM T_LIMIT_2) ORDER BY F_INT1,F_INT2 DESC LIMIT 3,1;
(SELECT * FROM T_LIMIT_1) UNION ALL (SELECT * FROM T_LIMIT_2) ORDER BY F_DATE DESC,F_INT1 DESC LIMIT 0,1;
(SELECT * FROM T_LIMIT_1) UNION ALL (SELECT * FROM T_LIMIT_2) UNION ALL (SELECT * FROM T_LIMIT_1) ORDER BY F_INT1,F_INT2 DESC LIMIT 1;
(SELECT * FROM T_LIMIT_1) UNION ALL (SELECT * FROM T_LIMIT_2 WHERE F_INT1 >1 ) UNION ALL (SELECT * FROM T_LIMIT_1) ORDER BY F_DATE DESC,F_INT1 DESC LIMIT 1 OFFSET 0;
(SELECT * FROM T_LIMIT_1 WHERE F_INT1 = 1) UNION ALL (SELECT * FROM T_LIMIT_2 WHERE F_INT2 = 3) UNION ALL (SELECT * FROM T_LIMIT_1) ORDER BY F_INT1,F_INT2 DESC LIMIT 2,1;

INSERT INTO T_LIMIT_1 VALUES(1,2,'A','2017-12-11 14:08:00.1408');
INSERT INTO T_LIMIT_1 VALUES(3,4,'C','2017-12-12 16:08:00.1608');
INSERT INTO T_LIMIT_1 VALUES(1,3,'A','2017-12-11 14:18:00.1418');
INSERT INTO T_LIMIT_1 VALUES(2,3,'B','2017-12-11 16:08:00.1608');
INSERT INTO T_LIMIT_2 VALUES(4,2,'A','2017-12-11 14:08:00.1408');
INSERT INTO T_LIMIT_2 VALUES(6,4,'C','2017-12-12 16:08:00.1608');
INSERT INTO T_LIMIT_2 VALUES(4,3,'A','2017-12-11 14:18:00.1418');
INSERT INTO T_LIMIT_2 VALUES(5,3,'B','2017-12-11 16:08:00.1608');
COMMIT;

SELECT * FROM T_LIMIT_1 WHERE F_INT1 >1 ORDER BY F_INT1,F_INT2 LIMIT 1,1;
SELECT * FROM (SELECT * FROM T_LIMIT_1 WHERE F_INT1 = 1 ORDER BY F_INT1,F_INT2 LIMIT 1,1) TT;
(SELECT F_INT1 FROM T_LIMIT_1 ORDER BY F_INT1 LIMIT 2) UNION ALL (SELECT F_INT1 FROM T_LIMIT_2 ORDER BY F_INT1 DESC LIMIT 1) ORDER BY F_INT1 DESC LIMIT 1,1;
(SELECT F_INT1 FROM T_LIMIT_1 GROUP BY F_INT1) UNION ALL (SELECT F_INT1 FROM T_LIMIT_2 GROUP BY F_INT1) ORDER BY F_INT1 DESC LIMIT 2,4;
SELECT * FROM T_LIMIT_1 UNION ALL SELECT * FROM T_LIMIT_2 ORDER BY F_INT1,F_INT2 DESC LIMIT 4 OFFSET 1;
(SELECT * FROM T_LIMIT_1 WHERE F_INT1 >1 ) UNION ALL (SELECT * FROM T_LIMIT_2) ORDER BY F_INT1,F_INT2 DESC LIMIT 3,1;
(SELECT * FROM T_LIMIT_1) UNION ALL (SELECT * FROM T_LIMIT_2) ORDER BY F_DATE DESC,F_INT1 DESC LIMIT 0,1;
(SELECT * FROM T_LIMIT_1) UNION ALL (SELECT * FROM T_LIMIT_2) UNION ALL (SELECT * FROM T_LIMIT_1) ORDER BY F_INT1,F_INT2 DESC LIMIT 1;
(SELECT * FROM T_LIMIT_1) UNION ALL (SELECT * FROM T_LIMIT_2 WHERE F_INT1 >1 ) UNION ALL (SELECT * FROM T_LIMIT_1) ORDER BY F_DATE DESC,F_INT1 DESC LIMIT 1 OFFSET 0;
(SELECT * FROM T_LIMIT_1 WHERE F_INT1 = 1) UNION ALL (SELECT * FROM T_LIMIT_2 WHERE F_INT2 = 3) UNION ALL (SELECT * FROM T_LIMIT_1) ORDER BY F_INT1,F_INT2 DESC LIMIT 2,1;

DELETE FROM T_LIMIT_1;
INSERT INTO T_LIMIT_1 VALUES(1,2,'A','2017-12-11 14:08:00.1408');
INSERT INTO T_LIMIT_1 VALUES(3,4,'C','2017-12-12 16:08:00.1608');
INSERT INTO T_LIMIT_1 VALUES(1,3,'A','2017-12-11 14:18:00.1418');
INSERT INTO T_LIMIT_1 VALUES(2,3,'B','2017-12-11 16:08:00.1608');
DELETE FROM T_LIMIT_1 LIMIT 2.8;

DROP TABLE IF EXISTS RQG_SELECT_DIS_TBL;
-- CREATE TABLE RQG_SELECT_DIS_TBL(C_INTEGER INTEGER, C_BIGINT BIGINT, C_DOUBLE DOUBLE, C_NUMBER NUMBER, C_CHAR CHAR, C_VARCHAR VARCHAR, C_TIMESTAMP TIMESTAMP, C_TEXT TEXT, C_BOOL BOOL) DISTRIBUTE BY REPLICATION PARTITION BY RANGE (C_CHAR) (PARTITION CHARNAME1 VALUES LESS THAN ( 'g' ), PARTITION INTNAME2 VALUES LESS THAN ( 't' ), PARTITION INTNAME3 VALUES LESS THAN ( MAXVALUE ) );
CREATE TABLE RQG_SELECT_DIS_TBL(C_INTEGER INTEGER, C_BIGINT BIGINT, C_DOUBLE DOUBLE, C_NUMBER NUMBER, C_CHAR CHAR, C_VARCHAR VARCHAR(32), C_TIMESTAMP TIMESTAMP, C_TEXT TEXT, C_BOOL BOOL) PARTITION BY RANGE (C_CHAR) (PARTITION CHARNAME1 VALUES LESS THAN ( 'g' ), PARTITION INTNAME2 VALUES LESS THAN ( 't' ), PARTITION INTNAME3 VALUES LESS THAN ( MAXVALUE ) );
insert into  RQG_SELECT_DIS_TBL  values(1, 1, 1.1, 1.2 ,'1', 'a', to_timestamp('2018-01-27','yyyy-mm-dd'), 'this is text', 1);
insert into  RQG_SELECT_DIS_TBL  values(2, 2, 2.1, 2.2 ,'2', 'b', to_timestamp('2018-01-27','yyyy-mm-dd'), 'this is text', 1);
insert into  RQG_SELECT_DIS_TBL  values(3, 3, 3.1, 3.2 ,'3', 'c', to_timestamp('2018-01-27','yyyy-mm-dd'), 'this is text', 1);
insert into  RQG_SELECT_DIS_TBL  values(4, 4, 4.1, 3.2 ,'4', 'd', to_timestamp('2018-01-27','yyyy-mm-dd'), 'this is text', 1);
insert into  RQG_SELECT_DIS_TBL  values(5, 5, 5.1, 5.2 ,'1', 'a', to_timestamp('2018-01-27','yyyy-mm-dd'), 'this is text', 0);
insert into  RQG_SELECT_DIS_TBL  values(6, 6, 6.1, 6.2 ,'2', 'b', to_timestamp('2018-01-27','yyyy-mm-dd'), 'this is text', 0);
insert into  RQG_SELECT_DIS_TBL  values(7, 7, 7.1, 7.2 ,'2', 'c', to_timestamp('2018-01-27','yyyy-mm-dd'), 'this is text', 0);
insert into  RQG_SELECT_DIS_TBL  values(8, 8, 8.1, 8.2 ,'2', 'd', to_timestamp('2018-01-27','yyyy-mm-dd'), 'this is text', 0);
SELECT c_char, c_double, c_integer, SUM( c_char ) FROM RQG_SELECT_DIS_TBL GROUP BY c_char , c_double , c_integer ORDER BY c_char DESC, c_integer DESC, c_double DESC  LIMIT 4 OFFSET 0;
SELECT c_char, c_double, c_integer, SUM( c_char ) FROM RQG_SELECT_DIS_TBL GROUP BY c_char , c_double , c_integer ORDER BY c_char DESC, c_integer DESC, c_double DESC OFFSET 0 LIMIT 4;
COMMIT;


DROP TABLE IF EXISTS RQG_SELECT_DIS_TBL;
--CREATE TABLE RQG_SELECT_DIS_TBL(C_INTEGER INTEGER, C_BIGINT BIGINT, C_DOUBLE DOUBLE, C_NUMBER NUMBER, C_CHAR CHAR, C_VARCHAR VARCHAR, C_TIMESTAMP TIMESTAMP, C_TEXT TEXT, C_BOOL BOOL) DISTRIBUTE BY REPLICATION PARTITION BY RANGE (C_CHAR) (PARTITION CHARNAME1 VALUES LESS THAN ( 'g' ), PARTITION INTNAME2 VALUES LESS THAN ( 't' ), PARTITION INTNAME3 VALUES LESS THAN ( MAXVALUE ) );
CREATE TABLE RQG_SELECT_DIS_TBL(C_INTEGER INTEGER, C_BIGINT BIGINT, C_DOUBLE DOUBLE, C_NUMBER NUMBER, C_CHAR CHAR, C_VARCHAR VARCHAR(32), C_TIMESTAMP TIMESTAMP, C_TEXT TEXT, C_BOOL BOOL) PARTITION BY RANGE (C_CHAR) (PARTITION CHARNAME1 VALUES LESS THAN ( 'g' ), PARTITION INTNAME2 VALUES LESS THAN ( 't' ), PARTITION INTNAME3 VALUES LESS THAN ( MAXVALUE ) );
insert into  RQG_SELECT_DIS_TBL  values(1, 1, 1.1, 1.2 ,'1', 'a', to_timestamp('2018-01-27','yyyy-mm-dd'), 'this is text', 1);
insert into  RQG_SELECT_DIS_TBL  values(2, 2, 2.1, 2.2 ,'2', 'b', to_timestamp('2018-01-27','yyyy-mm-dd'), 'this is text', 1);
insert into  RQG_SELECT_DIS_TBL  values(3, 3, 3.1, 3.2 ,'3', 'c', to_timestamp('2018-01-27','yyyy-mm-dd'), 'this is text', 1);
insert into  RQG_SELECT_DIS_TBL  values(4, 4, 4.1, 3.2 ,'4', 'd', to_timestamp('2018-01-27','yyyy-mm-dd'), 'this is text', 1);
insert into  RQG_SELECT_DIS_TBL  values(5, 5, 5.1, 5.2 ,'1', 'a', to_timestamp('2018-01-27','yyyy-mm-dd'), 'this is text', 0);
insert into  RQG_SELECT_DIS_TBL  values(6, 6, 6.1, 6.2 ,'2', 'b', to_timestamp('2018-01-27','yyyy-mm-dd'), 'this is text', 0);
insert into  RQG_SELECT_DIS_TBL  values(7, 7, 7.1, 7.2 ,'2', 'c', to_timestamp('2018-01-27','yyyy-mm-dd'), 'this is text', 0);
insert into  RQG_SELECT_DIS_TBL  values(8, 8, 8.1, 8.2 ,'2', 'd', to_timestamp('2018-01-27','yyyy-mm-dd'), 'this is text', 0);
SELECT c_char, c_double, c_integer, SUM( c_char ) FROM RQG_SELECT_DIS_TBL GROUP BY c_char , c_double , c_integer ORDER BY c_char DESC, c_integer DESC, c_double DESC  LIMIT 4 OFFSET 0;
SELECT c_char, c_double, c_integer, SUM( c_char ) FROM RQG_SELECT_DIS_TBL GROUP BY c_char , c_double , c_integer ORDER BY c_char DESC, c_integer DESC, c_double DESC OFFSET 0 LIMIT 4;
COMMIT;

DROP TABLE IF EXISTS negative;
create table negative(a int,b int ,c int,d int);
insert into negative values(2,45,65,4);
insert into negative values(3,46,66,5);
insert into negative values(1,47,67,6);
((select a from negative order by 1) union (select b from negative order by 1 desc limit 1)) union select c from negative;
select * from (select a from negative union select b from negative limit 1) union select b from negative limit 2;
select * from (select a from negative union select b from negative  order by 1 limit 1) union select b from negative limit 2;
insert into negative(a)(select * from (select a from negative union select b from negative limit 1) as a1);
insert into negative(a)(select * from (select a from negative minus select b from negative limit 1) as a1 );
(select a from negative union select b from negative order by a);
(select a from negative union select b from negative limit 2)          ;
COMMIT;
