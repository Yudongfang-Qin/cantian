DROP TABLE IF EXISTS t_fpl;
CREATE TABLE t_fpl
(
  id int NOT NULL PRIMARY KEY,
  k int NOT NULL DEFAULT '0',
  c char(120) NOT NULL DEFAULT '',
  pad varchar(256) DEFAULT '62417582574-50874440671-97234363934-59239380153-23906758964'
);

CREATE INDEX t_fpl_idx on t_fpl(k);
COMMIT;

-- insert two pages
INSERT INTO t_fpl(id, k, c) VALUES (1,  1,  '40416252612-40838624650-51415733495-83704916648-10059399856-95202655648-43856449968-98616564866-65137208833-32404858366');
INSERT INTO t_fpl(id, k, c) VALUES (2,  2,  '72943889804-21938979032-54456074048-08015542671-17782404015-11513355875-65997948848-93358914088-16106888595-44597834789');
INSERT INTO t_fpl(id, k, c) VALUES (3,  3,  '41712827006-37660273339-70954482092-70369362635-56692087829-61664186554-86230464647-78988356786-04260259185-81627455672');
INSERT INTO t_fpl(id, k, c) VALUES (4,  4,  '05604104123-55743229363-34152229673-84411443329-57850634247-62514515689-37831680599-35785704386-46263398451-66593527207');
INSERT INTO t_fpl(id, k, c) VALUES (5,  5,  '05604104123-55743229363-34152229673-84411443329-57850634247-62514515689-37831680599-35785704386-46263398451-66593527207');
INSERT INTO t_fpl(id, k, c) VALUES (6,  6,  '47793948289-74331391130-90864682867-13918485480-69426640101-07547034255-84091589395-94661932273-06899859561-65104104226');
INSERT INTO t_fpl(id, k, c) VALUES (7,  7,  '03973902788-67979027186-41058637382-94293298231-65078976239-09188820772-93063601712-81439670682-08363335032-61779796092');
INSERT INTO t_fpl(id, k, c) VALUES (8,  8,  '44463109040-57020194441-26683720999-52364735394-92682844059-36429241471-89859005479-15826765289-56908527937-55709179929');
INSERT INTO t_fpl(id, k, c) VALUES (9,  9,  '44959090353-77029441172-92592267344-40356432451-17842210287-26835973736-37739083432-89602372765-31622924933-22912585460');
INSERT INTO t_fpl(id, k, c) VALUES (10, 10, '69820251802-45585578892-03019543456-94839299096-44154486172-33284955320-61758535527-95917203336-76974483807-16717184410');
INSERT INTO t_fpl(id, k, c) VALUES (11, 11, '02373566361-13114456527-89712369949-20886098165-82680610781-94897970259-34212856545-18782296967-27349831938-20808880893');
INSERT INTO t_fpl(id, k, c) VALUES (12, 12, '78852011992-67469700641-08969849740-11382379093-02098072436-18661747847-87722584482-91147887339-09772417735-90536963810');
INSERT INTO t_fpl(id, k, c) VALUES (13, 13, '64908855956-81485816978-54124066878-54180250155-85573132830-88177599688-68041328196-16527450029-61448374459-06817184299');
INSERT INTO t_fpl(id, k, c) VALUES (14, 14, '93210359774-54949106202-39608468285-78003839675-68848258442-57754797676-01328361334-40253938711-54590430920-44425637351');
INSERT INTO t_fpl(id, k, c) VALUES (15, 15, '13216895509-35576018687-50525391960-56006707967-40131548305-06485559713-70253707272-65754878059-42521182589-78431713179');
INSERT INTO t_fpl(id, k, c) VALUES (16, 16, '04756529858-42285096532-80074087945-20051384079-45072210482-43453572898-60563021696-76807211088-63644425995-33181381628');
INSERT INTO t_fpl(id, k, c) VALUES (17, 17, '39658067440-42971105125-43613522994-41771042940-33314426714-21817268630-84566130497-96205656030-48594958738-77302789660');
INSERT INTO t_fpl(id, k, c) VALUES (18, 18, '18083035886-03077186856-21146821690-26993792909-82191252834-88186662015-36838063116-66743912501-66018834762-74078010980');
INSERT INTO t_fpl(id, k, c) VALUES (19, 19, '65666303379-59860790881-54764559671-68497471892-73448492853-89406790748-77283484153-13813703221-67683823471-77362710708');
INSERT INTO t_fpl(id, k, c) VALUES (20, 20, '35615301846-24286108696-57726934362-32765455960-37433390300-26751181135-38487003719-61612952618-79295887212-43442741364');
INSERT INTO t_fpl(id, k, c) VALUES (21, 21, '45034257508-83663793831-62316637749-73451219194-72495191020-40864802078-12376533927-20235800518-15673377799-03385258661');
INSERT INTO t_fpl(id, k, c) VALUES (22, 22, '45034257508-83663793831-62316637749-73451219194-72495191020-40864802078-12376533927-20235800518-15673377799-03385258661');
INSERT INTO t_fpl(id, k, c) VALUES (23, 23, '45574485507-34519489974-38145710518-66048433705-75669956334-13233219992-61685087106-95900483997-40761727555-84738501363');
INSERT INTO t_fpl(id, k, c) VALUES (24, 24, '15518847233-29817910524-81970382632-48797977712-26828940979-05825500421-66064911817-23168376177-26602317604-06144119784');
INSERT INTO t_fpl(id, k, c) VALUES (25, 25, '16340198334-00836586946-91201351473-91329663308-91917550683-64396581455-61481928141-71922321013-08099666097-52878526002');
INSERT INTO t_fpl(id, k, c) VALUES (26, 26, '16694313077-78800831939-51223269113-60731334354-52121246843-22520201380-26766775963-93860029054-76400352425-73940972481');
INSERT INTO t_fpl(id, k, c) VALUES (27, 27, '32070597462-28642890716-19956548620-90772855729-56457750962-57483104063-21016838795-56246081602-92907949044-50550481949');
INSERT INTO t_fpl(id, k, c) VALUES (28, 28, '59855032680-22204338057-87108091921-41995997903-25286386603-81875073689-38833570952-60631268545-31299768587-37103566114');
INSERT INTO t_fpl(id, k, c) VALUES (29, 29, '59855032680-22204338057-87108091921-41995997903-25286386603-81875073689-38833570952-60631268545-31299768587-37103566114');
INSERT INTO t_fpl(id, k, c) VALUES (30, 30, '67508884120-16024842086-59245732549-41570686352-27802850096-79496588544-91675185259-62327424407-43948247872-32922885646');
INSERT INTO t_fpl(id, k, c) VALUES (31, 31, '08348396857-43902170265-52401995618-19644533307-13147575523-98407801115-89917643021-95265034054-86560739997-22388573487');
INSERT INTO t_fpl(id, k, c) VALUES (32, 32, '15555612973-66801547009-04342297283-56205171531-28107268658-09534496819-90190802716-84219139994-83147890471-21667254669');
INSERT INTO t_fpl(id, k, c) VALUES (33, 33, '66768874240-29873091074-86561584352-48865192760-13926001295-91951748240-90857772738-35728535576-81861940091-22911629083');
INSERT INTO t_fpl(id, k, c) VALUES (34, 34, '79636882632-59110181738-07040345603-74495885464-45351814175-13915486065-23594982377-55139075943-70965117521-10783486790');
INSERT INTO t_fpl(id, k, c) VALUES (35, 35, '32236091181-49600099269-81508801998-89823434798-76862338554-59469066074-16502147932-81262966203-22201017698-85635526125');
INSERT INTO t_fpl(id, k, c) VALUES (36, 36, '43798348331-03914856295-07693409423-39232921972-23253340114-99176709565-83763979884-26350294783-61840512698-82692465788');
INSERT INTO t_fpl(id, k, c) VALUES (37, 37, '38823155447-49078483844-41271107567-95714866389-43104529159-11011107372-20409121998-94824534863-75634308944-24539828831');
INSERT INTO t_fpl(id, k, c) VALUES (38, 38, '32603367213-64137533944-32293721181-69039851672-36344758477-78663166433-34717722565-12921603822-50077306964-34792322863');
INSERT INTO t_fpl(id, k, c) VALUES (39, 39, '13456283505-36826085043-46249339915-37962730601-47624545696-23217271743-96452668881-36740681783-10120221412-06467019868');
INSERT INTO t_fpl(id, k, c) VALUES (40, 40, '13456283505-36826085043-46249339915-37962730601-47624545696-23217271743-96452668881-36740681783-10120221412-06467019868');
INSERT INTO t_fpl(id, k, c) VALUES (41, 41, '13456283505-36826085043-46249339915-37962730601-47624545696-23217271743-96452668881-36740681783-10120221412-06467019868');
INSERT INTO t_fpl(id, k, c) VALUES (42, 42, '91623890881-73701508724-28720316373-56842969457-48311319609-62368129360-68244466709-63651146177-81116285818-78317964712');
INSERT INTO t_fpl(id, k, c) VALUES (43, 43, '84066406551-01170127182-35813317160-68918316612-37058657285-08582260893-67516909817-34616777822-83421768979-28404340060');
INSERT INTO t_fpl(id, k, c) VALUES (44, 44, '28730760548-85742885090-27574939612-00618506645-53187699530-16848916630-25040237317-61532572859-29496154669-29998498716');
INSERT INTO t_fpl(id, k, c) VALUES (45, 45, '66603411212-47143795418-22242612765-75429304529-02657453223-76908640722-47768034537-55394428241-34648918389-01553506776');
INSERT INTO t_fpl(id, k, c) VALUES (46, 46, '46784637973-48222166990-77435987209-37878754907-95869900828-90799069701-97579107921-21275985417-48926129446-08708261343');
INSERT INTO t_fpl(id, k, c) VALUES (47, 47, '33458930895-93358890536-36617789272-59647441161-59159363731-99831830937-06522976489-61844805393-80595071294-94103520492');
INSERT INTO t_fpl(id, k, c) VALUES (48, 48, '55740930393-47762935775-74668347660-33221080492-23670127253-73409133344-24479859229-74676266996-90636892229-38456109514');
INSERT INTO t_fpl(id, k, c) VALUES (49, 49, '07615599533-89759737804-90052114439-99521243375-46645080105-20666598300-66155841040-26006925392-47796970387-84925467677');
INSERT INTO t_fpl(id, k, c) VALUES (50, 50, '09039668804-28223637148-72489828538-55068813627-70162605455-81027511802-72690160539-23405038561-64068311629-31699834613');
INSERT INTO t_fpl(id, k, c) VALUES (51, 51, '72113882428-11659952049-20092885539-48565178437-47869038788-76039263361-59061863659-72093817419-54479666258-81916502092');
INSERT INTO t_fpl(id, k, c) VALUES (52, 52, '39685971293-69582428357-02333713363-66551837906-56384212077-51236638407-79796689899-21280225106-13050711328-10106175852');
INSERT INTO t_fpl(id, k, c) VALUES (53, 53, '21756936940-25952202483-63201012672-26665133718-18525687965-33806075593-67183250833-13333819287-72279388268-14673797275');
INSERT INTO t_fpl(id, k, c) VALUES (54, 54, '27860659386-28676352791-83735169555-77572735838-36271494474-04009719221-84356025298-61844898257-45527747361-28980798010');
INSERT INTO t_fpl(id, k, c) VALUES (55, 55, '51956787521-38789191862-39840181489-47828748471-92510776331-23342062450-37891432629-43975178084-62984371351-29451675733');
INSERT INTO t_fpl(id, k, c) VALUES (56, 56, '63617360863-20177562666-19353577127-44445200775-03142482604-25895671365-89708985399-47958182629-14412471224-09508976254');
INSERT INTO t_fpl(id, k, c) VALUES (57, 57, '22226470995-53606639077-01042014393-76805080146-96795143237-99510907414-39613718559-63491884015-41863559548-74284590773');
INSERT INTO t_fpl(id, k, c) VALUES (58, 58, '21107082716-24209363459-10545825651-25024974946-42546163716-57434850542-78333689115-25612347186-88315391189-73820855681');
INSERT INTO t_fpl(id, k, c) VALUES (59, 59, '09307924062-77667906807-17479174692-87876009409-22799558749-02935621723-04545913709-65460196205-74370866723-31560360988');
INSERT INTO t_fpl(id, k, c) VALUES (60, 60, '72083561171-63153932757-47629089332-77865685983-41064129019-84491585934-11920133778-77413864939-99788201502-94122114384');
INSERT INTO t_fpl(id, k, c) VALUES (61, 61, '18851695382-89642382893-24735404161-97254769789-71888715654-49185304196-82101736488-52670042303-00264556978-57022595297');
INSERT INTO t_fpl(id, k, c) VALUES (62, 62, '13725383967-72393436781-86143498237-76547995511-81962951301-88572952568-82351184804-23102082264-06223575756-93937701641');
INSERT INTO t_fpl(id, k, c) VALUES (63, 63, '13725383967-72393436781-86143498237-76547995511-81962951301-88572952568-82351184804-23102082264-06223575756-93937701641');
INSERT INTO t_fpl(id, k, c) VALUES (64, 64, '10439502052-72533090061-85367267146-40079076695-54648009711-60815544465-58405653542-45457028107-61922570369-50810214434');
INSERT INTO t_fpl(id, k, c) VALUES (65, 65, '10439502052-72533090061-85367267146-40079076695-54648009711-60815544465-58405653542-45457028107-61922570369-50810214434');
INSERT INTO t_fpl(id, k, c) VALUES (66, 66, '50580355079-94206263677-06263388456-13358606633-63827532520-86818274901-38983912541-88233016670-87428687912-21258167786');
INSERT INTO t_fpl(id, k, c) VALUES (67, 67, '05589675357-82517250728-45069214256-70451863595-26532343845-16665012091-07802350582-05222848837-42663133647-11913058441');
INSERT INTO t_fpl(id, k, c) VALUES (68, 68, '05589675357-82517250728-45069214256-70451863595-26532343845-16665012091-07802350582-05222848837-42663133647-11913058441');
INSERT INTO t_fpl(id, k, c) VALUES (69, 69, '71331334021-52612457771-82155994991-80785872279-02090900471-70846245337-06086023006-78391582503-42495036962-89275402809');
INSERT INTO t_fpl(id, k, c) VALUES (70, 70, '12153136094-67140601262-86089961281-76233795134-07320710798-58168257840-33061420919-45787647486-46665486579-59327289438');
COMMIT;

-- testcase: delete insert commit
SELECT COUNT(DISTINCT SUBSTR(ROWID,5,10)) FROM t_fpl;
DELETE FROM t_fpl WHERE id = 1;
INSERT INTO t_fpl(id, k, c) VALUES (1,  1,  '40416252612-40838624650-51415733495-83704916648-10059399856-95202655648-43856449968-98616564866-65137208833-32404858366');
COMMIT;
SELECT COUNT(DISTINCT SUBSTR(ROWID,5,10)) FROM t_fpl;
SELECT * FROM t_fpl order by id;

-- testcase: delete insert rollback
DELETE FROM t_fpl WHERE id = 1;
INSERT INTO t_fpl(id, k, c) VALUES (1,  1,  '40416252612-40838624650-51415733495-83704916648-10059399856-95202655648-43856449968-98616564866-65137208833-32404858366');
ROLLBACK;
SELECT COUNT(DISTINCT SUBSTR(ROWID,5,10)) FROM t_fpl;
SELECT * FROM t_fpl order by id;

-- testcase: delete 2 rows(same page)
DELETE FROM t_fpl WHERE id = 1;
DELETE FROM t_fpl WHERE id = 2;
INSERT INTO t_fpl(id, k, c) VALUES (2,  2,  '40416252612-40838624650-51415733495-83704916648-10059399856-95202655648-43856449968-98616564866-65137208833-32404858366');
INSERT INTO t_fpl(id, k, c) VALUES (1,  1,  '40416252612-40838624650-51415733495-83704916648-10059399856-95202655648-43856449968-98616564866-65137208833-32404858366');
COMMIT;
SELECT COUNT(DISTINCT SUBSTR(ROWID,5,10)) FROM t_fpl;

-- testcase: delete 2 rows(different pages)
DELETE FROM t_fpl WHERE id = 1;
DELETE FROM t_fpl WHERE id = 40;
INSERT INTO t_fpl(id, k, c) VALUES (40,  40,  '40416252612-40838624650-51415733495-83704916648-10059399856-95202655648-43856449968-98616564866-65137208833-32404858366');
INSERT INTO t_fpl(id, k, c) VALUES (1,  1,  '40416252612-40838624650-51415733495-83704916648-10059399856-95202655648-43856449968-98616564866-65137208833-32404858366');
COMMIT;
SELECT COUNT(DISTINCT SUBSTR(ROWID,5,10)) FROM t_fpl;

-- testcase: delete 1 row, insert small rows
DELETE FROM t_fpl WHERE id = 1;
INSERT INTO t_fpl(id, k, c, pad) VALUES (90,  90,  'a', 'c');
INSERT INTO t_fpl(id, k, c, pad) VALUES (91,  91,  'a', 'c');
INSERT INTO t_fpl(id, k, c, pad) VALUES (92,  92,  'a', 'c');
INSERT INTO t_fpl(id, k, c, pad) VALUES (93,  93,  'a', 'c');
INSERT INTO t_fpl(id, k, c, pad) VALUES (94,  94,  'a', 'c');
INSERT INTO t_fpl(id, k, c) VALUES (1,  1,  '40416252612-40838624650-51415733495-83704916648-10059399856-95202655648-43856449968-98616564866-65137208833-32404858366');
COMMIT;
SELECT COUNT(DISTINCT SUBSTR(ROWID,5,10)) FROM t_fpl;

-- testcase: delete insert(bigger)
DELETE FROM t_fpl WHERE id = 1;
INSERT INTO t_fpl(id, k, c, pad) VALUES (1,  1,  '40416252612-40838624650-51415733495-83704916648-10059399856-95202655648-43856449968-98616564866-65137208833-32404858366', '40416252612-40838624650-51415733495-83704916648-10059399856-95202655648-43856449968-98616564866-65137208833-32404858366');
COMMIT;
SELECT COUNT(DISTINCT SUBSTR(ROWID,5,10)) FROM t_fpl;
INSERT INTO t_fpl(id, k, c) VALUES (80,  80,  '40416252612-40838624650-51415733495-83704916648-10059399856-95202655648-43856449968-98616564866-65137208833-32404858366');
COMMIT;
SELECT COUNT(DISTINCT SUBSTR(ROWID,5,10)) FROM t_fpl;

DROP TABLE IF EXISTS t_fpl;