conn sys/Huawei@123@127.0.0.1:1611
DROP TABLE IF EXISTS RENAME_IND_CON_13;
CREATE TABLE RENAME_IND_CON_13(c1 int, c2 varchar(32), c3 bigint);
INSERT INTO RENAME_IND_CON_13 VALUES(50, 'P1', 5000);
INSERT INTO RENAME_IND_CON_13 VALUES(150, 'P2', 15000);
INSERT INTO RENAME_IND_CON_13 VALUES(250, 'P3', 25000);
INSERT INTO RENAME_IND_CON_13 VALUES(350, 'P4', 35000);
COMMIT;
ALTER TABLE RENAME_IND_CON_13 ADD CONSTRAINT pk_RENAME_IND_CON_13_1 unique(c1);
ALTER TABLE RENAME_IND_CON_13 ADD CONSTRAINT pk_RENAME_IND_CON_13_2 check(c3>2500);
ALTER TABLE RENAME_IND_CON_13 rename constraint pk_RENAME_IND_CON_13_4 to pk_RENAME_IND_CON_13_3;
DROP TABLE IF EXISTS RENAME_IND_CON_13;
create table caot3(id1 int ,id2 int);
create index ittt1 on caot3(id1);
create index ittt2 on caot3(id2);
alter index ittt2 on caot3 rename to cao1.ittt1;
select index_name  from all_indexes where index_name like '%ITTT%';
alter index ittt2 on caot3 rename to sys.ittt1;
select index_name  from all_indexes where index_name like '%ITTT%';
alter index ittt2 on caot3 rename to sys.ittt3;
select index_name  from all_indexes where index_name like '%ITTT%';
drop table caot3;
drop table if exists base_008;
create table base_008 (id int,name char);
create index oldidx on base_008(name);
select  t.name TB , i.name IDX  from SYS_TABLES t ,SYS_INDEXES i  where i.table#=t.id and t.name = 'BASE_008';
alter index sys.oldidx on base_008 rename to newidx;
select  t.name TB , i.name IDX  from SYS_TABLES t ,SYS_INDEXES i  where i.table#=t.id and t.name = 'BASE_008';
alter index sys.newidx on base_008 rename to oldidx;
select  t.name TB , i.name IDX  from SYS_TABLES t ,SYS_INDEXES i  where i.table#=t.id and t.name = 'BASE_008';
drop table base_008;
--SELECT * FROM DBA_IND_COLUMNS;
--SELECT * FROM USER_IND_COLUMNS;
DROP TABLE IF EXISTS T_INDEX_1;
CREATE TABLE T_INDEX_1
(
	F_INT1 INT,
	F_INT2 INT,
	F_CHAR1 CHAR(20)
);

CREATE INDEX INDEX_INT_T_INDEX_1 ON T_INDEX_1(F_INT1);
CREATE INDEX INDEX_CHAR_INDEX_1 ON T_INDEX_1(F_CHAR1);

INSERT INTO T_INDEX_1 VALUES(1,2,'0001Z01000ACCOUNT028');
INSERT INTO T_INDEX_1 VALUES(2,3,'0001Z01000ACCOUNT073');
INSERT INTO T_INDEX_1 VALUES(3,4,'10111110000000001ZX5');
INSERT INTO T_INDEX_1 VALUES(4,5,'101511100000000006NZ');
INSERT INTO T_INDEX_1 VALUES(null,6,'101511100000000006NX');
COMMIT;

SELECT * FROM T_INDEX_1 WHERE F_CHAR1 = '0001Z01000ACCOUNT028' or F_CHAR1 = '0001Z01000ACCOUNT073';
SELECT * FROM T_INDEX_1 WHERE F_CHAR1 = '10111110000000001ZX5' or F_CHAR1 = '101511100000000006NZ';

SELECT * FROM T_INDEX_1 WHERE F_INT1 = 3 AND EXISTS (SELECT 1 FROM DUAL);
SELECT * FROM T_INDEX_1 WHERE F_INT1 = 1 AND NOT EXISTS (SELECT 1 FROM DUAL);
SELECT * FROM T_INDEX_1 WHERE F_INT1 = 1 AND NOT EXISTS (SELECT 1 FROM DUAL WHERE 1 = 0);

SELECT * FROM T_INDEX_1 WHERE F_INT1 IS NULL AND F_INT1 IS NULL;

CREATE USER NEBULA IDENTIFIED BY Cantian_234;
DROP TABLE IF EXISTS NEBULA.STORAGE_LIST_TBL_001;
CREATE TABLE NEBULA.STORAGE_LIST_TBL_001(C_ID INT,C_D_ID INT NOT NULL,C_W_ID INT NOT NULL,C_FIRST VARCHAR(64) NOT NULL,C_MIDDLE CHAR(2),C_LAST VARCHAR(64) NOT NULL,C_STREET_1 VARCHAR(20) NOT NULL,C_STREET_2 VARCHAR(20),C_CITY VARCHAR(64) NOT NULL,C_STATE CHAR(2) NOT NULL,C_ZIP CHAR(9) NOT NULL,C_PHONE CHAR(16) NOT NULL,C_SINCE TIMESTAMP,C_CREDIT CHAR(2) NOT NULL,C_CREDIT_LIM NUMERIC(12,2),C_DISCOUNT NUMERIC(4,4),C_BALANCE NUMERIC(12,2),C_YTD_PAYMENT REAL NOT NULL,C_PAYMENT_CNT NUMBER NOT NULL,C_DELIVERY_CNT BOOLEAN NOT NULL,C_END DATE NOT NULL,C_VCHAR VARCHAR(1000),C_DATA varchar(2000),C_TEXT varchar(2000)) PARTITION BY LIST(C_D_ID,C_FIRST,C_LAST,C_CITY) (PARTITION PART_1 VALUES ((1,'A','A','A'),(10,'AA','AA','AA'),(10,'AAAA','AAAA','AAAA'),(10,'aaaa','aaaa','aaaa'),(100,'AAAA','AAAA','AAAA'),(1,'a','a','a'),(10,'aa','aa','aa'),(100,'aaaa','aaaa','aaaa')),PARTITION PART_2 VALUES ((2,'B','B','B'),(20,'BB','BB','BB'),(20,'BBBB','BBBB','BBBB'),(20,'bbbb','bbbb','bbbb'),(200,'BBBB','BBBB','BBBB'),(2,'b','b','b'),(20,'bb','bb','bb'),(200,'bbbb','bbbb','bbbb')),PARTITION PART_3 VALUES ((3,'C','C','C'),(30,'CC','CC','CC'),(30,'CCCC','CCCC','CCCC'),(30,'cccc','cccc','cccc'),(300,'CCCC','CCCC','CCCC'),(3,'c','c','c'),(30,'cc','cc','cc'),(300,'cccc','cccc','cccc')),PARTITION PART_4 VALUES ((4,'D','D','D'),(40,'DD','DD','DD'),(40,'DDDD','DDDD','DDDD'),(40,'dddd','dddd','dddd'),(400,'DDDD','DDDD','DDDD'),(4,'d','d','d'),(40,'dd','dd','dd'),(400,'dddd','dddd','dddd')),PARTITION PART_5 VALUES ((5,'E','E','E'),(50,'EE','EE','EE'),(50,'EEEE','EEEE','EEEE'),(50,'eeee','eeee','eeee'),(500,'EEEE','EEEE','EEEE'),(5,'e','e','e'),(50,'ee','ee','ee'),(500,'eeee','eeee','eeee')),PARTITION PART_6 VALUES ((6,'F','F','F'),(60,'FF','FF','FF'),(60,'FFFF','FFFF','FFFF'),(60,'ffff','ffff','ffff'),(600,'FFFF','FFFF','FFFF'),(6,'f','f','f'),(60,'ff','ff','ff'),(600,'ffff','ffff','ffff')),PARTITION PART_7 VALUES ((7,'G','G','G'),(70,'GG','GG','GG'),(70,'GGGG','GGGG','GGGG'),(70,'gggg','gggg','gggg'),(700,'GGGG','GGGG','GGGG'),(7,'g','g','g'),(70,'gg','gg','gg'),(700,'gggg','gggg','gggg')),PARTITION PART_8 VALUES ((8,'H','H','H'),(80,'HH','HH','HH'),(80,'HHHH','HHHH','HHHH'),(80,'hhhh','hhhh','hhhh'),(800,'HHHH','HHHH','HHHH'),(8,'h','h','h'),(80,'hh','hh','hh'),(800,'hhhh','hhhh','hhhh')),PARTITION PART_9 VALUES ((9,'I','I','I'),(90,'II','II','II'),(90,'IIII','IIII','IIII'),(90,'iiii','iiii','iiii'),(900,'IIII','IIII','IIII'),(9,'i','i','i'),(90,'ii','ii','ii'),(900,'iiii','iiii','iiii')),PARTITION PART_10 VALUES (DEFAULT));
CREATE UNIQUE INDEX  NEBULA.STORAGE_LIST_INDEX_001_1 ON NEBULA.STORAGE_LIST_TBL_001(C_D_ID,C_FIRST,C_LAST,C_CITY,C_ID)  LOCAL ;
CREATE UNIQUE INDEX NEBULA.STORAGE_LIST_INDEX_001_2 ON NEBULA.STORAGE_LIST_TBL_001(C_ID,C_CITY,C_LAST,C_STREET_2)  ;
CREATE UNIQUE INDEX NEBULA.STORAGE_LIST_INDEX_001_3 ON NEBULA.STORAGE_LIST_TBL_001(C_STREET_2,C_ID)  ;
CREATE INDEX NEBULA.STORAGE_LIST_INDEX_001_5 ON NEBULA.STORAGE_LIST_TBL_001(C_STREET_1,C_W_ID)   ;
INSERT INTO NEBULA.STORAGE_LIST_TBL_001 VALUES(1,90,1,'II'||'9'||'Cabdg','OE','II'||'9'||'Bdbed','bki'||'9'||'fdger','pwo'||'9'||'vedef','II'||'9'||'Yed3f','uq',4801||'9',940||'9',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'9','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'9','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542329');
CREATE INDEX NEBULA.STORAGE_LIST_INDEX_001_4 ON NEBULA.STORAGE_LIST_TBL_001(C_ID,C_CITY,C_FIRST) parallel 5 LOCAL ;
SELECT C_ID,C_D_ID,C_FIRST,C_LAST,C_CITY  FROM NEBULA.STORAGE_LIST_TBL_001 where C_ID<1500 and C_D_ID<1500 and (C_FIRST like 'I%' ) and  (C_LAST like 'I%' )and  (C_CITY like 'I%' );
SELECT C_ID,C_D_ID,C_FIRST,C_LAST,C_CITY  FROM NEBULA.STORAGE_LIST_TBL_001 where C_ID<1500 and C_D_ID<1500 ;
SELECT C_ID,C_D_ID,C_FIRST,C_LAST,C_CITY  FROM NEBULA.STORAGE_LIST_TBL_001 where  (C_FIRST like 'I%' ) and  (C_LAST like 'I%' )and  (C_CITY like 'I%' );
SELECT C_ID,C_D_ID,C_FIRST,C_LAST,C_CITY  FROM NEBULA.STORAGE_LIST_TBL_001 ;
delete from NEBULA.STORAGE_LIST_TBL_001;
DROP TABLE IF EXISTS NEBULA.STORAGE_LIST_TBL_001;
DROP TABLE IF EXISTS NEBULA.STRG_PARTRANGE_TBL_001;
CREATE TABLE NEBULA.STRG_PARTRANGE_TBL_001(c_id int,c_d_id int not null,c_w_id int not null,c_first varchar(32) not null,c_middle char(2),c_last varchar(32) not null,c_street_1 varchar(20) not null,c_street_2 varchar(20),c_city varchar(20) not null,c_state char(2) not null,c_zip char(9) not null,c_phone char(16) not null,c_since timestamp,c_credit char(2) not null,c_credit_lim numeric(12,2),c_discount numeric(4,4),c_balance numeric(12,2),c_ytd_payment real not null,c_payment_cnt number not null,c_delivery_cnt bool not null,c_end date not null,c_vchar varchar(1000),c_data varchar(2000),c_text varchar(2000)) partition by range(c_id) (partition part_1 values less than (201),partition part_2 values less than (401),partition part_3 values less than (601),partition part_4 values less than (801),partition part_5 values less than (1001),partition part_6 values less than (1201),partition part_7 values less than (1401),partition part_8 values less than (1601),partition part_9 values less than (1801),partition part_10 values less than (2001),partition part_11 values less than (maxvalue));
CREATE UNIQUE INDEX NEBULA.STRG_RANGE_INDEX_001_1 ON NEBULA.STRG_PARTRANGE_TBL_001(C_ID) LOCAL;
CREATE UNIQUE INDEX NEBULA.STRG_RANGE_INDEX_001_2 ON NEBULA.STRG_PARTRANGE_TBL_001(C_W_ID) ;
CREATE INDEX NEBULA.STRG_RANGE_INDEX_001_3 ON NEBULA.STRG_PARTRANGE_TBL_001(C_FIRST) LOCAL;
INSERT INTO  NEBULA.STRG_PARTRANGE_TBL_001 SELECT 1,1,1,'AA'||'is1cmvls','OE','AA'||'BAR1BARBAR','bkili'||'1'||'fcxcle'||'1','pmbwo'||'1'||'vhvpaj'||'1','dyf'||'1'||'rya'||'1','uq',4801||'1',940||'1'||215||'1',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSF'||'1','QVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSF'||'1','\x1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323';
SELECT COUNT(*) FROM  nebula.STRG_PARTRANGE_TBL_001;
SELECT COUNT(*) FROM nebula.STRG_PARTRANGE_TBL_001 WHERE c_first LIKE 'AA%';
SELECT c_first FROM nebula.STRG_PARTRANGE_TBL_001 WHERE c_first < 'BB';
SELECT * FROM nebula.STRG_PARTRANGE_TBL_001 WHERE C_ID like 1234;
SELECT * FROM nebula.STRG_PARTRANGE_TBL_001 WHERE C_ID like '1234';
SELECT * FROM nebula.STRG_PARTRANGE_TBL_001 WHERE C_FIRST like 1234;
SELECT * FROM nebula.STRG_PARTRANGE_TBL_001 WHERE C_FIRST like '1234' OR C_ID like '1234';
DROP TABLE IF EXISTS NEBULA.STRG_PARTRANGE_TBL_001;
DROP USER NEBULA CASCADE;
DROP TABLE IF EXISTS T_INDEX_2;
CREATE TABLE T_INDEX_2(F1 REAL, F2 DATE, F3 TIMESTAMP, F4 NUMBER(6), F5 DECIMAL(20,5), F6 RAW(6), F7 VARBINARY(6));
CREATE INDEX IDX_T_INDEX_2_1 ON T_INDEX_2(F1);
CREATE INDEX IDX_T_INDEX_2_2 ON T_INDEX_2(F2);
CREATE INDEX IDX_T_INDEX_2_3 ON T_INDEX_2(F3);
CREATE INDEX IDX_T_INDEX_2_4 ON T_INDEX_2(F4);
CREATE INDEX IDX_T_INDEX_2_5 ON T_INDEX_2(F5);
CREATE INDEX IDX_T_INDEX_2_6 ON T_INDEX_2(F6);
CREATE INDEX IDX_T_INDEX_2_7 ON T_INDEX_2(F7);
INSERT INTO T_INDEX_2 VALUES(12.5, '2018-02-13', '2018-02-13 09:30:00', 1, 123456, '1111', '11111');
SELECT * FROM T_INDEX_2 WHERE F1=12.5;
SELECT * FROM T_INDEX_2 WHERE F2='2018-02-13';
SELECT * FROM T_INDEX_2 WHERE F3='2018-02-13 09:30:00';
SELECT * FROM T_INDEX_2 WHERE F4=1;
SELECT * FROM T_INDEX_2 WHERE F5=123456;
SELECT * FROM T_INDEX_2 WHERE F6='1111';
SELECT * FROM T_INDEX_2 WHERE F7='11111';

DROP TABLE IF EXISTS T_INDEX_3;
DROP TABLE IF EXISTS T_INDEX_4;
CREATE TABLE T_INDEX_3(CAR_ID NUMBER(6),CAR_CUST NUMBER(3),ADDR_3 NUMBER(5),CAR_CODE VARCHAR2(32),CAR_STATUS CHAR(1),CAR_REGION NUMBER(6),CAR_DOUBLE NUMBER(6,4),PRIMARY KEY(CAR_ID)); 
CREATE TABLE T_INDEX_4(PHONE_ID NUMBER(6),CUST NUMBER(3),ADDR_2 NUMBER(5),PHONE_CODE VARCHAR2(32),PHONE_STATUS CHAR(1),PHONE_REGION NUMBER(10),PHONE_DOUBLE NUMBER(20,4),PRIMARY KEY (PHONE_ID));
INSERT INTO T_INDEX_3(CAR_ID,CAR_CODE) VALUES(1000,'XYZ');
INSERT INTO T_INDEX_4(PHONE_ID, PHONE_CODE) VALUES(1000,'ASD');

SELECT CAR_CODE FROM T_INDEX_3 WHERE CAR_ID IN(SELECT PHONE_ID FROM T_INDEX_4 WHERE PHONE_CODE = 'ASD');
SELECT * FROM T_INDEX_3,T_INDEX_4;

DROP TABLE IF EXISTS PURCHASES;
CREATE TABLE PURCHASES (
	CUSTOMER_ID INTEGER  NOT NULL,
	PRODUCT_ID INTEGER  NOT NULL,
	QUANTITY INTEGER ,
	TEST VARCHAR2(10) ,
	PHONE VARCHAR2(12) NOT NULL,
	CONSTRAINT PURCHASES_PK PRIMARY KEY(PRODUCT_ID, CUSTOMER_ID)
);

DROP TABLE IF EXISTS CUSTOMERS;
CREATE TABLE CUSTOMERS (
	CUSTOMER_ID INTEGER ,
	FIRST_NAME VARCHAR2(10) NOT NULL,
	LAST_NAME VARCHAR2(10) NOT NULL,
	BIRTH DATE NOT NULL,
	PHONE VARCHAR2(12),
	TEST VARCHAR2(10),
	CONSTRAINT CUSTOMERS_PK PRIMARY KEY (CUSTOMER_ID) parallel 4
);

INSERT INTO CUSTOMERS (CUSTOMER_ID,FIRST_NAME,LAST_NAME,BIRTH,PHONE,TEST) VALUES(1,'JOHN','BROWN','1890-01-01 00:00:00','800-555-1211','123');
INSERT INTO PURCHASES (CUSTOMER_ID,PRODUCT_ID,QUANTITY,TEST,PHONE) VALUES (1,1,1,'TEST1','13776144901');
SELECT PRODUCT_ID,QUANTITY,TEST,PHONE FROM PURCHASES P WHERE P.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM CUSTOMERS WHERE FIRST_NAME LIKE 'JOHN' AND BIRTH < '2014-10-10');

DROP TABLE IF EXISTS TEST_MULTI_KEY;
CREATE TABLE TEST_MULTI_KEY(F1 INT, F2 INT);
INSERT INTO TEST_MULTI_KEY VALUES(1,1);
INSERT INTO TEST_MULTI_KEY VALUES(2,2);
INSERT INTO TEST_MULTI_KEY VALUES(3,3);
INSERT INTO TEST_MULTI_KEY VALUES(4,4);
INSERT INTO TEST_MULTI_KEY VALUES(5,5);
INSERT INTO TEST_MULTI_KEY VALUES(6,6);
INSERT INTO TEST_MULTI_KEY VALUES(7,7);
INSERT INTO TEST_MULTI_KEY VALUES(8,8);
CREATE INDEX IDX_TEST_MULTI_KEY_1 ON TEST_MULTI_KEY(F1) parallel 4;
SELECT * FROM TEST_MULTI_KEY WHERE (F1 >=1 AND F1 <4) OR (F1 >=5 AND F1 <8) ORDER BY F1;
SELECT * FROM TEST_MULTI_KEY WHERE (F1 >=1 AND F1 <4) OR (F1 >=5 AND F1 <8) ORDER BY F1 DESC;  
DROP TABLE IF EXISTS TEST_MULTI_KEY;

DROP TABLE IF EXISTS T_INDEX_2;
DROP TABLE IF EXISTS T_INDEX_3;
DROP TABLE IF EXISTS T_INDEX_4;
DROP TABLE IF EXISTS PURCHASES;
DROP TABLE IF EXISTS CUSTOMERS;

DROP TABLE IF EXISTS T_INDEX_5;
CREATE TABLE T_INDEX_5
(
	F_INT51 INT,
	F_INT52 INT,
	F_CHAR51 CHAR(20)
);

INSERT INTO T_INDEX_5 VALUES(1,2,'abc');
INSERT INTO T_INDEX_5 VALUES(2,3,'dec');
INSERT INTO T_INDEX_5 VALUES(3,4,'hij');
INSERT INTO T_INDEX_5 VALUES(4,5,'qwe');
INSERT INTO T_INDEX_5 VALUES(null,6,'asd');

CREATE INDEX INDEX_INT_T_INDEX_5 ON T_INDEX_5(F_INT51) ONLINE;
CREATE INDEX INDEX_CHAR_INDEX_5 ON T_INDEX_5(F_CHAR51) ONLINE;
SELECT * FROM T_INDEX_5 WHERE F_CHAR51 = 'abc' or F_CHAR51 = 'qwe';

ALTER INDEX INDEX_INT_T_INDEX_5 ON T_INDEX_5 REBUILD;
ALTER INDEX INDEX_CHAR_INDEX_5 ON T_INDEX_5 REBUILD ONLINE;
DROP TABLE IF EXISTS T_INDEX_5;

DROP TABLE IF EXISTS T_INDEX_55;
CREATE TABLE T_INDEX_55(A INT, B BOOLEAN);
CREATE INDEX IDX_T_INDEX_55_1 ON T_INDEX_55(B);
INSERT INTO T_INDEX_55 VALUES(1,0);
INSERT INTO T_INDEX_55 VALUES(2,1);
SELECT * FROM T_INDEX_55 WHERE B=0;
SELECT * FROM T_INDEX_55 WHERE B IS NULL OR B IS NULL;
DROP TABLE IF EXISTS T_INDEX_55;

DROP TABLE IF EXISTS T_INDEX_56;
create table T_INDEX_56(a int, b int);
create index idx_T_INDEX_56_1 on T_INDEX_56(a);
SELECT * FROM T_INDEX_56 WHERE (A>20 AND A <30) OR (A >40 AND A <50) OR (A >60 AND A <70) OR (A >25 AND A <35);
DROP TABLE IF EXISTS T_INDEX_56;

DROP TABLE IF EXISTS STRG_RANGE_DML_MUL_TBL_001;
CREATE TABLE STRG_RANGE_DML_MUL_TBL_001(C_ID INT,C_D_ID INT NOT NULL,C_W_ID INT NOT NULL,C_FIRST VARCHAR(64) NOT NULL,C_MIDDLE CHAR(2),C_LAST VARCHAR(64) NOT NULL,C_STREET_1 VARCHAR(20) NOT NULL,C_STREET_2 VARCHAR(20),C_CITY VARCHAR(20) NOT NULL,C_STATE CHAR(2) NOT NULL,C_ZIP CHAR(9) NOT NULL,C_PHONE CHAR(16) NOT NULL,C_SINCE TIMESTAMP,C_CREDIT CHAR(2) NOT NULL,C_CREDIT_LIM NUMERIC(12,2),C_DISCOUNT NUMERIC(4,4),C_BALANCE NUMERIC(12,2),C_YTD_PAYMENT REAL NOT NULL,C_PAYMENT_CNT NUMBER NOT NULL,C_DELIVERY_CNT BOOL NOT NULL,C_END DATE NOT NULL,C_VCHAR VARCHAR(1000),C_DATA CLOB,C_TEXT BLOB) PARTITION BY RANGE(C_ID,C_FIRST,C_LAST) (PARTITION PART_1 VALUES LESS THAN (201,'B','B'),PARTITION PART_2 VALUES LESS THAN (401,'C','C'),PARTITION PART_3 VALUES LESS THAN (601,'D','D'),PARTITION PART_4 VALUES LESS THAN (801,'E','E'),PARTITION PART_5 VALUES LESS THAN (1001,'F','F'),PARTITION PART_6 VALUES LESS THAN (5001,'G','G'),PARTITION PART_7 VALUES LESS THAN (6001,'H','H'),PARTITION PART_8 VALUES LESS THAN (7001,'I','I'),PARTITION PART_9 VALUES LESS THAN (8001,'J','J'),PARTITION PART_10 VALUES LESS THAN (MAXVALUE,MAXVALUE,MAXVALUE));
insert into STRG_RANGE_DML_MUL_TBL_001 values(1,1,1,'A'||'1'||'Cabdg','OE','A'||'1'||'Bdbed','bki'||'1'||'fdger','pwo'||'1'||'vedef','A'||'1'||'Yed3f','uq',4801||'1',940||'1',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'1','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'1','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STRG_RANGE_DML_MUL_TBL_001 values(201,201,201,'B'||'201'||'Cabdg','OE','B'||'201'||'Bdbed','bki'||'201'||'fdger','pwo'||'201'||'vedef','B'||'201'||'Yed3f','uq',4801||'201',940||'201',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'201','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'201','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STRG_RANGE_DML_MUL_TBL_001 values(401,401,401,'C'||'401'||'Cabdg','OE','C'||'401'||'Bdbed','bki'||'401'||'fdger','pwo'||'401'||'vedef','C'||'401'||'Yed3f','uq',4801||'401',940||'401',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'401','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'401','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STRG_RANGE_DML_MUL_TBL_001 values(601,601,601,'D'||'601'||'Cabdg','OE','D'||'601'||'Bdbed','bki'||'601'||'fdger','pwo'||'601'||'vedef','D'||'601'||'Yed3f','uq',4801||'601',940||'601',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'601','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'601','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STRG_RANGE_DML_MUL_TBL_001 values(801,801,801,'E'||'801'||'Cabdg','OE','E'||'801'||'Bdbed','bki'||'801'||'fdger','pwo'||'801'||'vedef','E'||'801'||'Yed3f','uq',4801||'801',940||'801',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'801','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'801','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STRG_RANGE_DML_MUL_TBL_001 values(1001,1001,1001,'F'||'1001'||'Cabdg','OE','F'||'1001'||'Bdbed','bki'||'1001'||'fdger','pwo'||'1001'||'vedef','F'||'1001'||'Yed3f','uq',4801||'1001',940||'1001',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'1001','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'1001','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STRG_RANGE_DML_MUL_TBL_001 values(5001,5001,5001,'G'||'5001'||'Cabdg','OE','G'||'5001'||'Bdbed','bki'||'5001'||'fdger','pwo'||'5001'||'vedef','G'||'5001'||'Yed3f','uq',4801||'5001',940||'5001',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'5001','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'5001','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STRG_RANGE_DML_MUL_TBL_001 values(6001,6001,6001,'H'||'6001'||'Cabdg','OE','H'||'6001'||'Bdbed','bki'||'6001'||'fdger','pwo'||'6001'||'vedef','H'||'6001'||'Yed3f','uq',4801||'6001',940||'6001',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'6001','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'6001','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STRG_RANGE_DML_MUL_TBL_001 values(7001,7001,7001,'I'||'7001'||'Cabdg','OE','I'||'7001'||'Bdbed','bki'||'7001'||'fdger','pwo'||'7001'||'vedef','I'||'7001'||'Yed3f','uq',4801||'7001',940||'7001',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'7001','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'7001','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STRG_RANGE_DML_MUL_TBL_001 values(8001,8001,8001,'J'||'8001'||'Cabdg','OE','J'||'8001'||'Bdbed','bki'||'8001'||'fdger','pwo'||'8001'||'vedef','J'||'8001'||'Yed3f','uq',4801||'8001',940||'8001',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'8001','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'8001','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
SELECT c_id,C_STREET_2 FROM STRG_RANGE_DML_MUL_TBL_001  where C_STREET_2 like '%vedef' order by c_id;
CREATE UNIQUE INDEX STRG_RANGE_DML_MUL_IDX_001_3 ON STRG_RANGE_DML_MUL_TBL_001(C_STREET_2,C_D_ID);
SELECT c_id,C_STREET_2 FROM STRG_RANGE_DML_MUL_TBL_001  where C_STREET_2 like '%vedef' order by c_id;
DROP TABLE IF EXISTS STRG_RANGE_DML_MUL_TBL_001;
DROP TABLE IF EXISTS t1;
DROP TABLE IF EXISTS t2;
DROP TABLE IF EXISTS t3;
CREATE TABLE T1 (F_INT1 INTEGER DEFAULT 0 NOT NULL, F_INT2 INTEGER, F_INT3 INTEGER, F_FLOAT FLOAT,F_DOUBLE DOUBLE, F_VARCHAR1 VARCHAR(512), F_VARCHAR2 VARCHAR2(512));
CREATE TABLE T2 (F_INT1 INTEGER DEFAULT 0 NOT NULL, F_INT2 INTEGER, F_INT3 INTEGER, F_FLOAT FLOAT,F_DOUBLE DOUBLE, F_VARCHAR1 VARCHAR(512), F_VARCHAR2 VARCHAR2(512));
CREATE TABLE T3 (F_INT1 INTEGER DEFAULT 0 NOT NULL, F_INT2 INTEGER, F_INT3 INTEGER, F_FLOAT FLOAT,F_DOUBLE DOUBLE, F_VARCHAR1 VARCHAR(512), F_VARCHAR2 VARCHAR2(512));
CREATE INDEX IDX_T2_1 ON T2(F_INT2);
INSERT INTO t1 (f_int1, f_int2, f_float, f_varchar1, f_int3, f_double, f_varchar2) VALUES(0,69,63.27,'xdajd',60,95.79,'dhftn');
INSERT INTO t1 (f_int1, f_int2, f_float, f_varchar1, f_int3, f_double, f_varchar2) VALUES(1,99,92.15,'csbgd',24,70.0,'naxqw');
INSERT INTO t1 (f_int1, f_int2, f_float, f_varchar1, f_int3, f_double, f_varchar2) VALUES(2,67,80.50,'tsxbw',76,30.75,'mvmjx');
INSERT INTO t1 (f_int1, f_int2, f_float, f_varchar1, f_int3, f_double, f_varchar2) VALUES(3,58,68.31,'czlxp',30,22.91,'pmufg');
INSERT INTO t1 (f_int1, f_int2, f_float, f_varchar1, f_int3, f_double, f_varchar2) VALUES(4,84,11.23,'hnyud',62,10.85,'ylafp');
INSERT INTO t1 (f_int1, f_int2, f_float, f_varchar1, f_int3, f_double, f_varchar2) VALUES(5,48,86.25,'pgfdt',70,87.6,'dfcps');
INSERT INTO t1 (f_int1, f_int2, f_float, f_varchar1, f_int3, f_double, f_varchar2) VALUES(6,11,4.29,'inpln',40,88.79,'pcmps');
INSERT INTO t1 (f_int1, f_int2, f_float, f_varchar1, f_int3, f_double, f_varchar2) VALUES(7,49,27.82,'hrizk',6,99.67,'rtnyc');
INSERT INTO t1 (f_int1, f_int2, f_float, f_varchar1, f_int3, f_double, f_varchar2) VALUES(8,19,73.52,'owmje',13,78.32,'oxpmw');
INSERT INTO t1 (f_int1, f_int2, f_float, f_varchar1, f_int3, f_double, f_varchar2) VALUES(9,20,36.88,'vnbdv',81,58.0,'rwzxr');
INSERT INTO t2 (f_int1, f_int2, f_float, f_varchar1, f_int3, f_double, f_varchar2) VALUES(0,69,63.27,'xdajd',60,95.79,'dhftn');
INSERT INTO t2 (f_int1, f_int2, f_float, f_varchar1, f_int3, f_double, f_varchar2) VALUES(1,99,92.15,'csbgd',24,70.0,'naxqw');
INSERT INTO t2 (f_int1, f_int2, f_float, f_varchar1, f_int3, f_double, f_varchar2) VALUES(2,67,80.50,'tsxbw',76,30.75,'mvmjx');
INSERT INTO t3 (f_int1, f_int2, f_float, f_varchar1, f_int3, f_double, f_varchar2) VALUES(0,69,63.27,'xdajd',60,95.79,'dhftn');
INSERT INTO t3 (f_int1, f_int2, f_float, f_varchar1, f_int3, f_double, f_varchar2) VALUES(1,99,92.15,'csbgd',24,70.0,'naxqw');
INSERT INTO t3 (f_int1, f_int2, f_float, f_varchar1, f_int3, f_double, f_varchar2) VALUES(2,67,80.50,'tsxbw',76,30.75,'mvmjx');
SELECT * FROM T1 WHERE F_INT1 IN (SELECT F_INT1 FROM T2 WHERE T1.F_INT2=T2.F_INT2);
SELECT * FROM T1 WHERE F_INT1 IN (SELECT F_INT1 FROM T2 WHERE T2.F_INT2=T1.F_INT2);
SELECT * FROM T1 JOIN T3 ON T1.F_INT1=T3.F_INT1 WHERE T1.F_INT2 IN (SELECT T2.F_INT3 FROM T2 WHERE T2.F_INT3 = T3.F_INT3);
DROP TABLE IF EXISTS t1;
DROP TABLE IF EXISTS t2;
DROP TABLE IF EXISTS t3;
DROP TABLE IF EXISTS T_INDEX_101;
CREATE TABLE T_INDEX_101(F_INT INT, F_CHAR CHAR(128), F_REAL REAL);
CREATE INDEX IDX_T_INDEX_101_1 ON T_INDEX_101(F_INT, F_CHAR);
INSERT INTO T_INDEX_101 VALUES(1,'AA', 1.1);
INSERT INTO T_INDEX_101 VALUES(1,'BB', 1.2);
INSERT INTO T_INDEX_101 VALUES(1,'CC', 1.3);
INSERT INTO T_INDEX_101 VALUES(2,'HELLO', 2.1);
INSERT INTO T_INDEX_101 VALUES(2,'WORLD', 2.2);
INSERT INTO T_INDEX_101 VALUES(3,'XDAJD', 3.1);
INSERT INTO T_INDEX_101 VALUES(3,'HNYUD', 3.2);
SELECT * FROM T_INDEX_101 WHERE F_INT IN (1,2,3);
SELECT * FROM T_INDEX_101 WHERE F_INT = 1 AND F_CHAR IN ('AA','CC');
SELECT * FROM T_INDEX_101 WHERE F_INT = 3 AND F_CHAR IN ('XDAJD','HNYUD');
DROP TABLE IF EXISTS T_INDEX_101;

-----index create --》 truncate --》flashback --》rebuild index
DROP USER IF EXISTS hzy;
create user hzy identified by Cantian_234;
GRANT CREATE SESSION TO hzy;
grant create table to hzy;

DROP USER IF EXISTS HZY CASCADE;
CREATE USER HZY IDENTIFIED BY CANTIAN_234;

CREATE TABLE HZY.STATS_INTERVAL_NEW(
C_ID INT,
C_D_ID INT NOT NULL,
C_W_ID INT NOT NULL,
C_FIRST VARCHAR(50) NOT NULL,
C_MIDDLE CHAR(2),
C_LAST VARCHAR(16) NOT NULL,
C_STREET_1 VARCHAR(20) NOT NULL,
C_STREET_2 VARCHAR(20),
C_CITY VARCHAR(20) NOT NULL,
C_STATE CHAR(2) NOT NULL,
C_ZIP CHAR(9) NOT NULL,
C_PHONE CHAR(16) NOT NULL,
C_SINCE TIMESTAMP,
C_CREDIT CHAR(2) NOT NULL,
C_CREDIT_LIM NUMERIC(12,2),
C_DISCOUNT NUMERIC(4,4),
C_BALANCE NUMERIC(12,2),
C_YTD_PAYMENT REAL NOT NULL,
C_PAYMENT_CNT NUMBER NOT NULL,
C_DELIVERY_CNT BOOL NOT NULL,
C_END DATE NOT NULL,
C_DATA VARCHAR(1000),
C_CLOB CLOB,
C_TEXT BLOB) 
PARTITION BY RANGE(C_ID)
INTERVAL(100) 
(
   PARTITION PART_H1 VALUES LESS THAN (10),
   PARTITION PART_H2 VALUES LESS THAN (20),
   PARTITION PART_H3 VALUES LESS THAN (30)
);

CREATE OR REPLACE PROCEDURE HZY.LOB_HZY_PROC_1115(STARTNUM INT,ENDALL INT) IS
I INT :=1;
J VARCHAR(10);
BEGIN
  FOR I IN STARTNUM..ENDALL LOOP
    SELECT CAST(I AS VARCHAR(10)) INTO J FROM DUAL;
    INSERT INTO  HZY.STATS_INTERVAL_NEW SELECT I,I,I,'IS'||J||'CMRDS'||J,'OE','BAR'||J||'BAR'||J,'BKILI'||J||'FCRRGF'||J,'PMBWO'||J||'VHSDGJ'||J,'DYF'||J||'RDA'||J,'UQ',4801||J,940||J||215||J,'2011-12-11 00:00:00','GC',50000.0,0.4361328,-10.0,10.0,1,TRUE,'2011-12-11 00:00:00','DASD'||J,'DASDSD'||J,'\X1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323';
  END LOOP;
END;
/

CALL HZY.LOB_HZY_PROC_1115(1001,1120);
COMMIT; 

SELECT COUNT(*) FROM HZY.STATS_INTERVAL_NEW;

CREATE INDEX HZY.HZY_DML_RANGE_INDX_086 ON HZY.STATS_INTERVAL_NEW(C_ID);
CREATE INDEX HZY.HZY_DML_RANGE_INDX_087 ON HZY.STATS_INTERVAL_NEW(C_ID, C_D_ID) parallel 5 LOCAL;
ALTER INDEX HZY.HZY_DML_RANGE_INDX_086 ON HZY.STATS_INTERVAL_NEW UNUSABLE;
SELECT FLAGS FROM SYS.SYS_INDEXES WHERE NAME = 'HZY_DML_RANGE_INDX_086';
CALL HZY.LOB_HZY_PROC_1115(1,20);
CALL HZY.LOB_HZY_PROC_1115(1,15);
COMMIT;
ALTER INDEX HZY.HZY_DML_RANGE_INDX_086 ON HZY.STATS_INTERVAL_NEW REBUILD;
SELECT FLAGS FROM SYS.SYS_INDEXES WHERE NAME = 'HZY_DML_RANGE_INDX_086';
CALL HZY.LOB_HZY_PROC_1115(25,45);
CALL HZY.LOB_HZY_PROC_1115(10,30);
COMMIT;
ALTER INDEX HZY.HZY_DML_RANGE_INDX_087 ON HZY.STATS_INTERVAL_NEW UNUSABLE;
SELECT FLAGS FROM SYS.SYS_INDEXES WHERE NAME = 'HZY_DML_RANGE_INDX_087';
CALL HZY.LOB_HZY_PROC_1115(50,100);
DROP INDEX HZY.HZY_DML_RANGE_INDX_087 ON HZY.STATS_INTERVAL_NEW;
CREATE INDEX HZY.HZY_DML_RANGE_INDX_087 ON HZY.STATS_INTERVAL_NEW(C_ID, C_D_ID) LOCAL;
SELECT FLAGS FROM SYS.SYS_INDEXES WHERE NAME = 'HZY_DML_RANGE_INDX_087';
DROP TABLE HZY.STATS_INTERVAL_NEW;
drop PROCEDURE HZY.LOB_HZY_PROC_1115;
DROP TABLE  IF EXISTS HZY_UNUSABLE;
CREATE TABLE HZY_UNUSABLE(A INT, B INT, C INT);
INSERT INTO HZY_UNUSABLE VALUES(1,1,1);
INSERT INTO HZY_UNUSABLE VALUES(2,1,1);
INSERT INTO HZY_UNUSABLE VALUES(3,1,1);
INSERT INTO HZY_UNUSABLE VALUES(4,1,1);
INSERT INTO HZY_UNUSABLE VALUES(5,1,1);
INSERT INTO HZY_UNUSABLE VALUES(6,1,1);
COMMIT;
CREATE UNIQUE INDEX HZY_UNUSABLE_IDX ON HZY_UNUSABLE(A);
INSERT INTO HZY_UNUSABLE VALUES(1,1,1);
ALTER INDEX HZY_UNUSABLE_IDX ON HZY_UNUSABLE UNUSABLE;
SELECT FLAGS FROM SYS.SYS_INDEXES WHERE NAME = 'HZY_UNUSABLE_IDX';

INSERT INTO HZY_UNUSABLE VALUES(9,1,1);
INSERT INTO HZY_UNUSABLE VALUES(10,1,1);
ALTER INDEX HZY_UNUSABLE_IDX ON HZY_UNUSABLE REBUILD;
SELECT FLAGS FROM SYS.SYS_INDEXES WHERE NAME = 'HZY_UNUSABLE_IDX';
INSERT INTO HZY_UNUSABLE VALUES(9,1,1);
INSERT INTO HZY_UNUSABLE VALUES(10,1,1);
INSERT INTO HZY_UNUSABLE VALUES(11,1,1);
DROP TABLE  IF EXISTS HZY_UNUSABLE;

create table hzy.active_standby_range_tbl_000(c_id int,
c_d_id int NOT NULL,
c_w_id int NOT NULL,
c_first varchar(32) NOT NULL,
c_middle char(2),
c_last varchar(32) NOT NULL,
c_street_1 varchar(20) NOT NULL,
c_street_2 varchar(20),
c_city varchar(20) NOT NULL,
c_state char(2) NOT NULL,
c_zip char(9) NOT NULL,
c_phone char(16) NOT NULL,
c_since timestamp,
c_credit char(2) NOT NULL,
c_credit_lim numeric(12,2),
c_discount numeric(4,4),
c_balance numeric(12,2),
c_ytd_payment real NOT NULL,
c_payment_cnt number NOT NULL,
c_delivery_cnt bool NOT NULL,
c_end date NOT NULL,
c_vchar varchar(1000),
c_data clob,
c_text blob,
primary key (c_id,c_d_id,c_w_id));

insert into  hzy.active_standby_range_tbl_000 select 1,1,1,'AA'||'is1cmvls','OE','AA'||'BAR1BARBAR','bkili'||'1'||'fcxcle'||'1','pmbwo'||'1'||'vhvpaj'||'1','dyf'||'1'||'rya'||'1','uq',4801||'1',940||'1'||215||'1',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECC348493214893542NPFZCSYKXXYSCDSF'||'1','QVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSFQVLDETANRBRBURBMZQUJSHOQNGGSMNTECCIPRIIRDHIRWIYNPFZCSYKXXYSCDSF1','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323';

insert into hzy.active_standby_range_tbl_000 select	c_id+1,c_d_id+1,c_w_id+1,'AA'||'is2cmvls',c_middle,'AA'||'BAR2BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+2,c_d_id+2,c_w_id+2,'AA'||'is3cmvls',c_middle,'AA'||'BAR3BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+3,c_d_id+3,c_w_id+3,'AA'||'is4cmvls',c_middle,'AA'||'BAR4BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+4,c_d_id+4,c_w_id+4,'AA'||'is5cmvls',c_middle,'AA'||'BAR5BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+5,c_d_id+5,c_w_id+5,'AA'||'is6cmvls',c_middle,'AA'||'BAR6BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+6,c_d_id+6,c_w_id+6,'AA'||'is7cmvls',c_middle,'AA'||'BAR7BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+7,c_d_id+7,c_w_id+7,'AA'||'is8cmvls',c_middle,'AA'||'BAR8BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+8,c_d_id+8,c_w_id+8,'AA'||'is9cmvls',c_middle,'AA'||'BAR9BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+9,c_d_id+9,c_w_id+9,'AA'||'is10cmvls',c_middle,'AA'||'BAR10BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+10,c_d_id+10,c_w_id+10,'AA'||'is11cmvls',c_middle,'AA'||'BAR11BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+11,c_d_id+11,c_w_id+11,'AA'||'is12cmvls',c_middle,'AA'||'BAR12BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+12,c_d_id+12,c_w_id+12,'AA'||'is13cmvls',c_middle,'AA'||'BAR13BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+13,c_d_id+13,c_w_id+13,'AA'||'is14cmvls',c_middle,'AA'||'BAR14BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+14,c_d_id+14,c_w_id+14,'AA'||'is15cmvls',c_middle,'AA'||'BAR15BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+15,c_d_id+15,c_w_id+15,'AA'||'is16cmvls',c_middle,'AA'||'BAR16BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+16,c_d_id+16,c_w_id+16,'AA'||'is17cmvls',c_middle,'AA'||'BAR17BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+17,c_d_id+17,c_w_id+17,'AA'||'is18cmvls',c_middle,'AA'||'BAR18BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+18,c_d_id+18,c_w_id+18,'AA'||'is19cmvls',c_middle,'AA'||'BAR19BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+19,c_d_id+19,c_w_id+19,'AA'||'is20cmvls',c_middle,'AA'||'BAR20BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+20,c_d_id+20,c_w_id+20,'AA'||'is21cmvls',c_middle,'AA'||'BAR21BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+21,c_d_id+21,c_w_id+21,'AA'||'is22cmvls',c_middle,'AA'||'BAR22BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+22,c_d_id+22,c_w_id+22,'AA'||'is23cmvls',c_middle,'AA'||'BAR23BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+23,c_d_id+23,c_w_id+23,'AA'||'is24cmvls',c_middle,'AA'||'BAR24BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+24,c_d_id+24,c_w_id+24,'AA'||'is25cmvls',c_middle,'AA'||'BAR25BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+25,c_d_id+25,c_w_id+25,'AA'||'is26cmvls',c_middle,'AA'||'BAR26BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+26,c_d_id+26,c_w_id+26,'AA'||'is27cmvls',c_middle,'AA'||'BAR27BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+27,c_d_id+27,c_w_id+27,'AA'||'is28cmvls',c_middle,'AA'||'BAR28BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+28,c_d_id+28,c_w_id+28,'AA'||'is29cmvls',c_middle,'AA'||'BAR29BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+29,c_d_id+29,c_w_id+29,'AA'||'is30cmvls',c_middle,'AA'||'BAR30BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+30,c_d_id+30,c_w_id+30,'AA'||'is31cmvls',c_middle,'AA'||'BAR31BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+31,c_d_id+31,c_w_id+31,'AA'||'is32cmvls',c_middle,'AA'||'BAR32BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+32,c_d_id+32,c_w_id+32,'AA'||'is33cmvls',c_middle,'AA'||'BAR33BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+33,c_d_id+33,c_w_id+33,'AA'||'is34cmvls',c_middle,'AA'||'BAR34BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+34,c_d_id+34,c_w_id+34,'AA'||'is35cmvls',c_middle,'AA'||'BAR35BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+35,c_d_id+35,c_w_id+35,'AA'||'is36cmvls',c_middle,'AA'||'BAR36BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+36,c_d_id+36,c_w_id+36,'AA'||'is37cmvls',c_middle,'AA'||'BAR37BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+37,c_d_id+37,c_w_id+37,'AA'||'is38cmvls',c_middle,'AA'||'BAR38BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+38,c_d_id+38,c_w_id+38,'AA'||'is39cmvls',c_middle,'AA'||'BAR39BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+39,c_d_id+39,c_w_id+39,'AA'||'is40cmvls',c_middle,'AA'||'BAR40BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+40,c_d_id+40,c_w_id+40,'AA'||'is41cmvls',c_middle,'AA'||'BAR41BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+41,c_d_id+41,c_w_id+41,'AA'||'is42cmvls',c_middle,'AA'||'BAR42BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+42,c_d_id+42,c_w_id+42,'AA'||'is43cmvls',c_middle,'AA'||'BAR43BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+43,c_d_id+43,c_w_id+43,'AA'||'is44cmvls',c_middle,'AA'||'BAR44BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+44,c_d_id+44,c_w_id+44,'AA'||'is45cmvls',c_middle,'AA'||'BAR45BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+45,c_d_id+45,c_w_id+45,'AA'||'is46cmvls',c_middle,'AA'||'BAR46BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+46,c_d_id+46,c_w_id+46,'AA'||'is47cmvls',c_middle,'AA'||'BAR47BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+47,c_d_id+47,c_w_id+47,'AA'||'is48cmvls',c_middle,'AA'||'BAR48BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+48,c_d_id+48,c_w_id+48,'AA'||'is49cmvls',c_middle,'AA'||'BAR49BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+49,c_d_id+49,c_w_id+49,'AA'||'is50cmvls',c_middle,'AA'||'BAR50BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+50,c_d_id+50,c_w_id+50,'AA'||'is51cmvls',c_middle,'AA'||'BAR51BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+51,c_d_id+51,c_w_id+51,'AA'||'is52cmvls',c_middle,'AA'||'BAR52BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+52,c_d_id+52,c_w_id+52,'AA'||'is53cmvls',c_middle,'AA'||'BAR53BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+53,c_d_id+53,c_w_id+53,'AA'||'is54cmvls',c_middle,'AA'||'BAR54BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+54,c_d_id+54,c_w_id+54,'AA'||'is55cmvls',c_middle,'AA'||'BAR55BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+55,c_d_id+55,c_w_id+55,'AA'||'is56cmvls',c_middle,'AA'||'BAR56BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+56,c_d_id+56,c_w_id+56,'AA'||'is57cmvls',c_middle,'AA'||'BAR57BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+57,c_d_id+57,c_w_id+57,'AA'||'is58cmvls',c_middle,'AA'||'BAR58BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+58,c_d_id+58,c_w_id+58,'AA'||'is59cmvls',c_middle,'AA'||'BAR59BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+59,c_d_id+59,c_w_id+59,'AA'||'is60cmvls',c_middle,'AA'||'BAR60BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+60,c_d_id+60,c_w_id+60,'AA'||'is61cmvls',c_middle,'AA'||'BAR61BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+61,c_d_id+61,c_w_id+61,'AA'||'is62cmvls',c_middle,'AA'||'BAR62BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+62,c_d_id+62,c_w_id+62,'AA'||'is63cmvls',c_middle,'AA'||'BAR63BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+63,c_d_id+63,c_w_id+63,'AA'||'is64cmvls',c_middle,'AA'||'BAR64BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+64,c_d_id+64,c_w_id+64,'AA'||'is65cmvls',c_middle,'AA'||'BAR65BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+65,c_d_id+65,c_w_id+65,'AA'||'is66cmvls',c_middle,'AA'||'BAR66BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+66,c_d_id+66,c_w_id+66,'AA'||'is67cmvls',c_middle,'AA'||'BAR67BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+67,c_d_id+67,c_w_id+67,'AA'||'is68cmvls',c_middle,'AA'||'BAR68BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+68,c_d_id+68,c_w_id+68,'AA'||'is69cmvls',c_middle,'AA'||'BAR69BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+69,c_d_id+69,c_w_id+69,'AA'||'is70cmvls',c_middle,'AA'||'BAR70BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+70,c_d_id+70,c_w_id+70,'AA'||'is71cmvls',c_middle,'AA'||'BAR71BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+71,c_d_id+71,c_w_id+71,'AA'||'is72cmvls',c_middle,'AA'||'BAR72BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+72,c_d_id+72,c_w_id+72,'AA'||'is73cmvls',c_middle,'AA'||'BAR73BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+73,c_d_id+73,c_w_id+73,'AA'||'is74cmvls',c_middle,'AA'||'BAR74BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+74,c_d_id+74,c_w_id+74,'AA'||'is75cmvls',c_middle,'AA'||'BAR75BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+75,c_d_id+75,c_w_id+75,'AA'||'is76cmvls',c_middle,'AA'||'BAR76BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+76,c_d_id+76,c_w_id+76,'AA'||'is77cmvls',c_middle,'AA'||'BAR77BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+77,c_d_id+77,c_w_id+77,'AA'||'is78cmvls',c_middle,'AA'||'BAR78BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+78,c_d_id+78,c_w_id+78,'AA'||'is79cmvls',c_middle,'AA'||'BAR79BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+79,c_d_id+79,c_w_id+79,'AA'||'is80cmvls',c_middle,'AA'||'BAR80BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+80,c_d_id+80,c_w_id+80,'AA'||'is81cmvls',c_middle,'AA'||'BAR81BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+81,c_d_id+81,c_w_id+81,'AA'||'is82cmvls',c_middle,'AA'||'BAR82BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+82,c_d_id+82,c_w_id+82,'AA'||'is83cmvls',c_middle,'AA'||'BAR83BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+83,c_d_id+83,c_w_id+83,'AA'||'is84cmvls',c_middle,'AA'||'BAR84BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+84,c_d_id+84,c_w_id+84,'AA'||'is85cmvls',c_middle,'AA'||'BAR85BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+85,c_d_id+85,c_w_id+85,'AA'||'is86cmvls',c_middle,'AA'||'BAR86BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+86,c_d_id+86,c_w_id+86,'AA'||'is87cmvls',c_middle,'AA'||'BAR87BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+87,c_d_id+87,c_w_id+87,'AA'||'is88cmvls',c_middle,'AA'||'BAR88BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+88,c_d_id+88,c_w_id+88,'AA'||'is89cmvls',c_middle,'AA'||'BAR89BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+89,c_d_id+89,c_w_id+89,'AA'||'is90cmvls',c_middle,'AA'||'BAR90BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+90,c_d_id+90,c_w_id+90,'AA'||'is91cmvls',c_middle,'AA'||'BAR91BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+91,c_d_id+91,c_w_id+91,'AA'||'is92cmvls',c_middle,'AA'||'BAR92BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+92,c_d_id+92,c_w_id+92,'AA'||'is93cmvls',c_middle,'AA'||'BAR93BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+93,c_d_id+93,c_w_id+93,'AA'||'is94cmvls',c_middle,'AA'||'BAR94BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+94,c_d_id+94,c_w_id+94,'AA'||'is95cmvls',c_middle,'AA'||'BAR95BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+95,c_d_id+95,c_w_id+95,'AA'||'is96cmvls',c_middle,'AA'||'BAR96BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+96,c_d_id+96,c_w_id+96,'AA'||'is97cmvls',c_middle,'AA'||'BAR97BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+97,c_d_id+97,c_w_id+97,'AA'||'is98cmvls',c_middle,'AA'||'BAR98BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+98,c_d_id+98,c_w_id+98,'AA'||'is99cmvls',c_middle,'AA'||'BAR99BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+99,c_d_id+99,c_w_id+99,'AA'||'is100cmvls',c_middle,'AA'||'BAR100BARBAR',c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+100,	c_d_id+100,	c_w_id+100,	'BB'||'is101cmvls',	c_middle,'BB'||'BAR101BARBAR',	c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+101,	c_d_id+101,	c_w_id+101,	'BB'||'is102cmvls',	c_middle,'BB'||'BAR102BARBAR',	c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+102,	c_d_id+102,	c_w_id+102,	'BB'||'is103cmvls',	c_middle,'BB'||'BAR103BARBAR',	c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+103,	c_d_id+103,	c_w_id+103,	'BB'||'is104cmvls',	c_middle,'BB'||'BAR104BARBAR',	c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+104,	c_d_id+104,	c_w_id+104,	'BB'||'is105cmvls',	c_middle,'BB'||'BAR105BARBAR',	c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+105,	c_d_id+105,	c_w_id+105,	'BB'||'is106cmvls',	c_middle,'BB'||'BAR106BARBAR',	c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+106,	c_d_id+106,	c_w_id+106,	'BB'||'is107cmvls',	c_middle,'BB'||'BAR107BARBAR',	c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+107,	c_d_id+107,	c_w_id+107,	'BB'||'is108cmvls',	c_middle,'BB'||'BAR108BARBAR',	c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+108,	c_d_id+108,	c_w_id+108,	'BB'||'is109cmvls',	c_middle,'BB'||'BAR109BARBAR',	c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+109,	c_d_id+109,	c_w_id+109,	'BB'||'is110cmvls',	c_middle,'BB'||'BAR110BARBAR',	c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+110,	c_d_id+110,	c_w_id+110,	'BB'||'is111cmvls',	c_middle,'BB'||'BAR111BARBAR',	c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+111,	c_d_id+111,	c_w_id+111,	'BB'||'is112cmvls',	c_middle,'BB'||'BAR112BARBAR',	c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+112,	c_d_id+112,	c_w_id+112,	'BB'||'is113cmvls',	c_middle,'BB'||'BAR113BARBAR',	c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;
insert into hzy.active_standby_range_tbl_000 select	c_id+113,	c_d_id+113,	c_w_id+113,	'BB'||'is114cmvls',	c_middle,'BB'||'BAR114BARBAR',	c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_vchar,c_data,c_text from hzy.active_standby_range_tbl_000 where c_id=1;

create table hzy.flashback_tbl_range_001(c_id int,
c_d_id int NOT NULL,
c_w_id int NOT NULL,
c_first varchar(32) NOT NULL,
c_middle char(2),
c_last varchar(32) NOT NULL,
c_street_1 varchar(20) NOT NULL,
c_street_2 varchar(20),
c_city varchar(20) NOT NULL,
c_state char(2) NOT NULL,
c_zip char(9) NOT NULL,
c_phone char(16) NOT NULL,
c_since timestamp,
c_credit char(2) NOT NULL,
c_credit_lim numeric(12,2),
c_discount numeric(4,4),
c_balance numeric(12,2),
c_ytd_payment real NOT NULL,
c_payment_cnt number NOT NULL,
c_delivery_cnt bool NOT NULL,
c_end date NOT NULL,
c_vchar varchar(1000),
c_data clob,
c_text blob,
primary key (c_id,c_d_id,c_w_id))partition by range(c_d_id,c_last) (partition PART_1 values less than (101,'BBis101'),partition PART_2 values less than (501,'FFis501'),partition PART_3 values less than (801,'IIis801'),partition PART_4 values less than (maxvalue,maxvalue));
CREATE UNIQUE INDEX hzy.flashback_tbl_range_001 ON hzy.flashback_tbl_range_001(C_ID);
CREATE UNIQUE INDEX hzy.flashback_tbl_range_001_1 ON hzy.flashback_tbl_range_001(C_W_ID,c_first);
--create global index
CREATE INDEX hzy.flashback_tbl_range_001_2 ON hzy.flashback_tbl_range_001(C_FIRST);
--I2.插入数据
insert into hzy.flashback_tbl_range_001 select * from hzy.active_standby_range_tbl_000;
update hzy.flashback_tbl_range_001 set c_id=c_id+1000,c_first='bbbbbbbb',c_data='bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb',c_text='1111111111111111',c_vchar='bbbbbbbbbbbbbbbbbbbbbbb';
select distinct c_first,sum(c_id) from hzy.flashback_tbl_range_001 group by 1 order by 1,2;
--I3.truncate表
truncate table hzy.flashback_tbl_range_001;
select distinct c_first,sum(c_id) from hzy.flashback_tbl_range_001 group by 1 order by 1,2;
--I4.修改索引
ALTER INDEX hzy.flashback_tbl_range_001_2 ON hzy.flashback_tbl_range_001 REBUILD ONLINE;
--I5.闪回
flashback table hzy.flashback_tbl_range_001 to before truncate ;
select distinct c_first,sum(c_id) from hzy.flashback_tbl_range_001 group by 1 order by 1,2;
select sum(c_id) from hzy.flashback_tbl_range_001;
drop table hzy.flashback_tbl_range_001 purge;

create table hzy.flashback_tbl_range_001(c_id int,
c_d_id int NOT NULL,
c_w_id int NOT NULL,
c_first varchar(32) NOT NULL,
c_middle char(2),
c_last varchar(32) NOT NULL,
c_street_1 varchar(20) NOT NULL,
c_street_2 varchar(20),
c_city varchar(20) NOT NULL,
c_state char(2) NOT NULL,
c_zip char(9) NOT NULL,
c_phone char(16) NOT NULL,
c_since timestamp,
c_credit char(2) NOT NULL,
c_credit_lim numeric(12,2),
c_discount numeric(4,4),
c_balance numeric(12,2),
c_ytd_payment real NOT NULL,
c_payment_cnt number NOT NULL,
c_delivery_cnt bool NOT NULL,
c_end date NOT NULL,
c_vchar varchar(1000),
c_data clob,
c_text blob,
primary key (c_id,c_d_id,c_w_id))partition by range(c_d_id,c_last) (partition PART_1 values less than (101,'BBis101'),partition PART_2 values less than (501,'FFis501'),partition PART_3 values less than (801,'IIis801'),partition PART_4 values less than (maxvalue,maxvalue));
CREATE UNIQUE INDEX hzy.flashback_tbl_range_001 ON hzy.flashback_tbl_range_001(C_ID);
CREATE UNIQUE INDEX hzy.flashback_tbl_range_001_1 ON hzy.flashback_tbl_range_001(C_W_ID,c_first);
--create local index
CREATE INDEX hzy.flashback_tbl_range_001_2 ON hzy.flashback_tbl_range_001(C_FIRST) local;
--I2.插入数据
insert into hzy.flashback_tbl_range_001 select * from hzy.active_standby_range_tbl_000;
update hzy.flashback_tbl_range_001 set c_id=c_id+1000,c_first='bbbbbbbb',c_data='bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb',c_text='1111111111111111',c_vchar='bbbbbbbbbbbbbbbbbbbbbbb';
select distinct c_first,sum(c_id) from hzy.flashback_tbl_range_001 group by 1 order by 1,2;
--I3.truncate表
truncate table hzy.flashback_tbl_range_001;
select distinct c_first,sum(c_id) from hzy.flashback_tbl_range_001 group by 1 order by 1,2;
--I4.修改索引
ALTER INDEX hzy.flashback_tbl_range_001_2 ON hzy.flashback_tbl_range_001 REBUILD ONLINE;
--I5.闪回
flashback table hzy.flashback_tbl_range_001 to before truncate ;
select distinct c_first,sum(c_id) from hzy.flashback_tbl_range_001 group by 1 order by 1,2;
select sum(c_id) from hzy.flashback_tbl_range_001;
drop table hzy.flashback_tbl_range_001 purge;

drop table hzy.active_standby_range_tbl_000 purge;
DROP USER IF EXISTS hzy cascade;
DROP TABLE IF EXISTS META_VIEW_SOURCE;
DROP TABLE IF EXISTS META_VIEW_SOURCE_1;
CREATE TABLE META_VIEW_SOURCE
(
  LEFT_CLASS_ID BIGINT NOT NULL,
  LEFT_CLASS_ALIAS VARCHAR(128) NOT NULL,
  IS_LEFT_SOURCE BOOLEAN NOT NULL,
  RIGHT_CLASS_ALIAS VARCHAR(128) NOT NULL,
  RELATION_ALIAS VARCHAR(128) NOT NULL,
  RIGHT_CLASS_ID BIGINT NOT NULL,
  RELATION_ID BIGINT NOT NULL,
  VIEW_ID BIGINT NOT NULL,
  PRIMARY KEY (VIEW_ID, LEFT_CLASS_ALIAS, RELATION_ALIAS, RIGHT_CLASS_ALIAS)
);
create table META_VIEW_SOURCE_1(a varchar(300), b varchar(300), c varchar(300), d int);
create index META_VIEW_SOURCE_1 on META_VIEW_SOURCE_1(a,b,c);
insert into META_VIEW_SOURCE_1 values(
'11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111',
'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa',
'bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb',
10);
select a from META_VIEW_SOURCE_1 where a like '1111111%';
update META_VIEW_SOURCE_1 set a='222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222';
select a from META_VIEW_SOURCE_1 where a like '22222222%';
delete from META_VIEW_SOURCE_1;
select * from META_VIEW_SOURCE_1;
DROP TABLE IF EXISTS META_VIEW_SOURCE;
DROP TABLE IF EXISTS META_VIEW_SOURCE_1;

--SELECT * FROM DBA_IND_COLUMNS;
--SELECT * FROM USER_IND_COLUMNS;

-----rebuild index  
drop user if exists user11 cascade;
create user user11 identified by 'cantian_123';
grant create session to user11;
grant create table to user11;
create table user11.all_datatype_table(id int not null,c_intger integer,c_bigint bigint,c_real real, c_decimal decimal,c_number number,c_char char(100),c_varchar varchar(100),c_varchar400 varchar(400),c_datetime datetime,c_timestamp timestamp,c_boolean boolean,c1 int,c2 int,c3 int,c4 bigint,c5 varchar(10),c6 char(10),c7 int,c8 real,c9 real, c10 int,c11 int,c12 bigint,c13 real,c14 decimal,c15 number,c16 datetime,c17 char)
PARTITION BY RANGE (c_datetime,c_intger)
(
partition P_20180121 values less than ('2018-01-21 00:00:00',2018),
partition P_20190122 values less than ('2019-01-22 00:00:00',2019),
partition P_20200123 values less than ('2020-01-23 00:00:00',2020),
partition P_max values less than ('2050-01-24 00:00:00',2050)
);

create tablespace  ts_dump_sp datafile 'ts_dump_sp' size 40M;
create tablespace  ts_dump_sp2 datafile 'ts_dump_sp2' size 40M;

create index user11.idx5 on user11.all_datatype_table(id,c_datetime ASC,c_intger desc) tablespace ts_dump_sp initrans 1
local
(PARTITION Puser_20180121 pctfree 8 initrans 100,
PARTITION Puser_20190122 pctfree 80 tablespace ts_dump_sp2 initrans 255,
PARTITION Puser_20200123 tablespace ts_dump_sp2 initrans 1 pctfree 80,
PARTITION Puser_max);

select Name, HIBOUNDVAL,INITRANS, (select name from v$tablespace where id = space#)  from SYS_INDEX_PARTS where name like 'PUSER%' order by NAME;
ALTER INDEX user11.idx5 on user11.all_datatype_table REBUILD;
select Name, HIBOUNDVAL,INITRANS, (select name from v$tablespace where id = space#)  from SYS_INDEX_PARTS where name like 'PUSER%' order by NAME;
ALTER INDEX user11.idx5 on user11.all_datatype_table REBUILD tablespace ts_dump_sp2;
select Name, (select name from v$tablespace where id = space#)  from SYS_INDEX_PARTS where name like 'PUSER%' order by NAME;
ALTER INDEX user11.idx5 on user11.all_datatype_table REBUILD tablespace ts_dump_sp;
select Name, (select name from v$tablespace where id = space#)  from SYS_INDEX_PARTS where name like 'PUSER%' order by NAME;
ALTER INDEX user11.idx5 on user11.all_datatype_table REBUILD PARTITION Puser_20180121 tablespace ts_dump_sp2;
select Name, (select name from v$tablespace where id = space#)  from SYS_INDEX_PARTS where name like 'PUSER%' order by NAME;
drop table user11.all_datatype_table purge;
drop user user11;
drop TABLESPACE ts_dump_sp including contents cascade constraints;
drop TABLESPACE ts_dump_sp2 including contents cascade constraints;
drop table if exists test_pcr_dsc;
create table test_pcr_dsc(id int primary key) crmode page;
declare
  i integer;
begin
  for i in 0..600 loop
    execute immediate 'insert into test_pcr_dsc values('||i||')';
  end loop;
  commit;
end;
/
select * from test_pcr_dsc where id>440 and id<445 order by id desc;
drop table test_pcr_dsc purge;
drop table if exists test_rcr_dsc;
create table test_rcr_dsc(id int primary key) crmode row;
declare
  i integer;
begin
  for i in 0..400 loop
    execute immediate 'insert into test_rcr_dsc values('||i||')';
  end loop;
  commit;
end;
/
select * from test_rcr_dsc where id>245 and id<249 order by id desc;
drop table test_rcr_dsc purge;
--DTS2018061909186 
DROP TABLE IF EXISTS STORAGE_LIST_TBL_000;
DROP TABLE IF EXISTS STORAGE_LIST_TBL_001;
CREATE TABLE STORAGE_LIST_TBL_000(C_ID INT,
C_D_ID INT NOT NULL,
C_W_ID INT NOT NULL,
C_FIRST VARCHAR(16) NOT NULL,
C_MIDDLE CHAR(2),
C_LAST VARCHAR(16) NOT NULL,
C_STREET_1 VARCHAR(20) NOT NULL,
C_STREET_2 VARCHAR(20),
C_CITY VARCHAR(20) NOT NULL,
C_STATE CHAR(2) NOT NULL,
C_ZIP CHAR(9) NOT NULL,
C_PHONE CHAR(16) NOT NULL,
C_SINCE TIMESTAMP,
C_CREDIT CHAR(2) NOT NULL,
C_CREDIT_LIM NUMERIC(12,2),
C_DISCOUNT NUMERIC(4,4),
C_BALANCE NUMERIC(12,2),
C_YTD_PAYMENT REAL NOT NULL,
C_PAYMENT_CNT NUMBER NOT NULL,
C_DELIVERY_CNT BOOL NOT NULL,
C_END DATE NOT NULL,
C_VCHAR VARCHAR(1000),
C_DATA CLOB,
C_TEXT BLOB);

insert into STORAGE_LIST_TBL_000 values(1,10,1,'AA'||'1'||'Cabdg','OE','AA'||'1'||'Bdbed','bki'||'1'||'fdger','pwo'||'1'||'vedef','AA'||'1'||'Yed3f','uq',4801||'1',940||'1',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'1','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'1','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STORAGE_LIST_TBL_000 values(11,10,11,'AA'||'11'||'Cabdg','OE','AA'||'11'||'Bdbed','bki'||'11'||'fdger','pwo'||'11'||'vedef','AA'||'11'||'Yed3f','uq',4801||'11',940||'11',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'11','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'11','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STORAGE_LIST_TBL_000 values(21,10,21,'AA'||'21'||'Cabdg','OE','AA'||'21'||'Bdbed','bki'||'21'||'fdger','pwo'||'21'||'vedef','AA'||'21'||'Yed3f','uq',4801||'21',940||'21',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'21','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'21','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STORAGE_LIST_TBL_000 values(31,10,31,'AA'||'31'||'Cabdg','OE','AA'||'31'||'Bdbed','bki'||'31'||'fdger','pwo'||'31'||'vedef','AA'||'31'||'Yed3f','uq',4801||'31',940||'31',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'31','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'31','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STORAGE_LIST_TBL_000 values(41,10,41,'AA'||'41'||'Cabdg','OE','AA'||'41'||'Bdbed','bki'||'41'||'fdger','pwo'||'41'||'vedef','AA'||'41'||'Yed3f','uq',4801||'41',940||'41',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'41','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'41','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STORAGE_LIST_TBL_000 values(51,10,51,'AA'||'51'||'Cabdg','OE','AA'||'51'||'Bdbed','bki'||'51'||'fdger','pwo'||'51'||'vedef','AA'||'51'||'Yed3f','uq',4801||'51',940||'51',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'51','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'51','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STORAGE_LIST_TBL_000 values(61,10,61,'AA'||'61'||'Cabdg','OE','AA'||'61'||'Bdbed','bki'||'61'||'fdger','pwo'||'61'||'vedef','AA'||'61'||'Yed3f','uq',4801||'61',940||'61',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'61','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'61','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STORAGE_LIST_TBL_000 values(71,10,71,'AA'||'71'||'Cabdg','OE','AA'||'71'||'Bdbed','bki'||'71'||'fdger','pwo'||'71'||'vedef','AA'||'71'||'Yed3f','uq',4801||'71',940||'71',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'71','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'71','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STORAGE_LIST_TBL_000 values(81,10,81,'AA'||'81'||'Cabdg','OE','AA'||'81'||'Bdbed','bki'||'81'||'fdger','pwo'||'81'||'vedef','AA'||'81'||'Yed3f','uq',4801||'81',940||'81',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'81','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'81','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');
insert into STORAGE_LIST_TBL_000 values(91,10,91,'AA'||'91'||'Cabdg','OE','AA'||'91'||'Bdbed','bki'||'91'||'fdger','pwo'||'91'||'vedef','AA'||'91'||'Yed3f','uq',4801||'91',940||'91',to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'GC',50000.0,0.4361328,-10.0,10.0,1,true,to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'),'QVLDETANdfdffdfRB'||'91','QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF'||'91','1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323');

update  STORAGE_LIST_TBL_000 set C_FIRST=substr(C_FIRST,1,2),C_LAST=substr(C_FIRST,1,2),C_CITY=substr(C_FIRST,1,2);
update  STORAGE_LIST_TBL_000 set C_DATA='QVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSFQVLDETANRBRBUflnfufscHOQNGGSMjjjjgfvmgfvdfcmkgvNPFZCSYKXXYSCDSF',C_TEXT='1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542328';

CREATE TABLE STORAGE_LIST_TBL_001(C_ID INT,C_D_ID INT NOT NULL,C_W_ID INT NOT NULL,C_FIRST VARCHAR(64) NOT NULL,C_MIDDLE CHAR(2),C_LAST VARCHAR(64) NOT NULL,C_STREET_1 VARCHAR(20) NOT NULL,C_STREET_2 VARCHAR(20),C_CITY VARCHAR(64) NOT NULL,C_STATE CHAR(2) NOT NULL,C_ZIP CHAR(9) NOT NULL,C_PHONE CHAR(16) NOT NULL,C_SINCE TIMESTAMP,C_CREDIT CHAR(2) NOT NULL,C_CREDIT_LIM NUMERIC(12,2),C_DISCOUNT NUMERIC(4,4),C_BALANCE NUMERIC(12,2),C_YTD_PAYMENT REAL NOT NULL,C_PAYMENT_CNT NUMBER NOT NULL,C_DELIVERY_CNT BOOLEAN NOT NULL,C_END DATE NOT NULL,C_VCHAR VARCHAR(1000),C_DATA CLOB,C_TEXT BLOB) 
PARTITION BY LIST(C_D_ID,C_FIRST,C_LAST,C_CITY)
(
PARTITION PART_1 VALUES ((1,'A','A','A'),(10,'AA','AA','AA'),(10,'AAAA','AAAA','AAAA'),(10,'aaaa','aaaa','aaaa'),(100,'AAAA','AAAA','AAAA'),(1,'a','a','a'),(10,'aa','aa','aa'),(100,'aaaa','aaaa','aaaa')),
PARTITION PART_2 VALUES ((2,'B','B','B'),(20,'BB','BB','BB'),(20,'BBBB','BBBB','BBBB'),(20,'bbbb','bbbb','bbbb'),(200,'BBBB','BBBB','BBBB'),(2,'b','b','b'),(20,'bb','bb','bb'),(200,'bbbb','bbbb','bbbb')),
PARTITION PART_3 VALUES ((3,'C','C','C'),(30,'CC','CC','CC'),(30,'CCCC','CCCC','CCCC'),(30,'cccc','cccc','cccc'),(300,'CCCC','CCCC','CCCC'),(3,'c','c','c'),(30,'cc','cc','cc'),(300,'cccc','cccc','cccc')),
PARTITION PART_4 VALUES ((4,'D','D','D'),(40,'DD','DD','DD'),(40,'DDDD','DDDD','DDDD'),(40,'dddd','dddd','dddd'),(400,'DDDD','DDDD','DDDD'),(4,'d','d','d'),(40,'dd','dd','dd'),(400,'dddd','dddd','dddd')),
PARTITION PART_5 VALUES ((5,'E','E','E'),(50,'EE','EE','EE'),(50,'EEEE','EEEE','EEEE'),(50,'eeee','eeee','eeee'),(500,'EEEE','EEEE','EEEE'),(5,'e','e','e'),(50,'ee','ee','ee'),(500,'eeee','eeee','eeee')),
PARTITION PART_6 VALUES ((6,'F','F','F'),(60,'FF','FF','FF'),(60,'FFFF','FFFF','FFFF'),(60,'ffff','ffff','ffff'),(600,'FFFF','FFFF','FFFF'),(6,'f','f','f'),(60,'ff','ff','ff'),(600,'ffff','ffff','ffff')),
PARTITION PART_7 VALUES ((7,'G','G','G'),(70,'GG','GG','GG'),(70,'GGGG','GGGG','GGGG'),(70,'gggg','gggg','gggg'),(700,'GGGG','GGGG','GGGG'),(7,'g','g','g'),(70,'gg','gg','gg'),(700,'gggg','gggg','gggg')),
PARTITION PART_8 VALUES ((8,'H','H','H'),(80,'HH','HH','HH'),(80,'HHHH','HHHH','HHHH'),(80,'hhhh','hhhh','hhhh'),(800,'HHHH','HHHH','HHHH'),(8,'h','h','h'),(80,'hh','hh','hh'),(800,'hhhh','hhhh','hhhh')),
PARTITION PART_9 VALUES ((9,'I','I','I'),(90,'II','II','II'),(90,'IIII','IIII','IIII'),(90,'iiii','iiii','iiii'),(900,'IIII','IIII','IIII'),(9,'i','i','i'),(90,'ii','ii','ii'),(900,'iiii','iiii','iiii')),
PARTITION PART_10 VALUES (DEFAULT)
);

SELECT DISTINCT FLOOR(C_ID/100),C_D_ID,substr(C_FIRST,1,10),substr(C_LAST,1,10),substr(C_CITY,1,10),COUNT(*) FROM STORAGE_LIST_TBL_001 where C_ID<15000 and C_D_ID<15000  and (C_FIRST='A' or C_FIRST='AA' or C_FIRST='AAAA'  ) and (C_LAST='A' or C_LAST='AA' or C_LAST='AAAA'  ) and  (C_CITY='A' or C_CITY='AA' or C_CITY='AAAA') GROUP BY FLOOR(C_ID/100),C_D_ID,substr(C_FIRST,1,10),substr(C_LAST,1,10),substr(C_CITY,1,10) ORDER BY 1,2,3,4,5,6 desc;

INSERT INTO STORAGE_LIST_TBL_001 SELECT * FROM STORAGE_LIST_TBL_000;

CREATE UNIQUE INDEX  STORAGE_LIST_INDEX_001_1 ON STORAGE_LIST_TBL_001(C_D_ID,C_FIRST,C_LAST,C_CITY,C_ID)  LOCAL ;
CREATE UNIQUE INDEX STORAGE_LIST_INDEX_001_2 ON STORAGE_LIST_TBL_001(C_ID,C_CITY,C_LAST,C_STREET_2)  ;
CREATE UNIQUE INDEX STORAGE_LIST_INDEX_001_3 ON STORAGE_LIST_TBL_001(C_STREET_2,C_ID)  ;
CREATE INDEX STORAGE_LIST_INDEX_001_4 ON STORAGE_LIST_TBL_001(C_ID,C_CITY,C_FIRST)   ;
CREATE INDEX STORAGE_LIST_INDEX_001_5 ON STORAGE_LIST_TBL_001(C_STREET_1,C_W_ID)   ;

SELECT DISTINCT FLOOR(C_ID/100),C_D_ID,substr(C_FIRST,1,10),substr(C_LAST,1,10),substr(C_CITY,1,10),COUNT(*) FROM STORAGE_LIST_TBL_001 where C_ID<15000 and C_D_ID<15000  and (C_FIRST='A' or C_FIRST='AA' or C_FIRST='AAAA'  ) and (C_LAST='A' or C_LAST='AA' or C_LAST='AAAA'  ) and  (C_CITY='A' or C_CITY='AA' or C_CITY='AAAA') GROUP BY FLOOR(C_ID/100),C_D_ID,substr(C_FIRST,1,10),substr(C_LAST,1,10),substr(C_CITY,1,10) ORDER BY 1,2,3,4,5,6 desc;

--test index key with length limit 3900
DROP TABLE IF EXISTS large_key;
CREATE TABLE large_key(c1 INTEGER, c2 VARCHAR(4000), c3 INTEGER, c4 char(100));
CREATE INDEX ix_large_key ON large_key(c1, c2, c4) parallel 5 initrans 100;
CREATE INDEX ix_large_key_1 ON large_key(c2) parallel 5 initrans 255;
CREATE OR REPLACE PROCEDURE insert_large_key(v_start int, v_end int)
AS
     i int;
BEGIN
    FOR i IN v_start .. v_end LOOP
        EXECUTE IMMEDIATE 'INSERT INTO large_key VALUES(1, ''a123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789'','||i||', null)';
    END LOOP;
END;
/

EXEC insert_large_key(1, 17);
CREATE UNIQUE INDEX ix_large_key_2 ON large_key(c3, c2) initrans 100 pctfree 20 parallel 5;
EXEC insert_large_key(18, 33);
DROP INDEX ix_large_key_2 ON large_key;
EXEC insert_large_key(13, 65);
CREATE INDEX ix_large_key ON large_key(c1, c2) initrans 100;
EXEC insert_large_key(65, 100);

DROP TABLE large_key PURGE;
CREATE TABLE large_key(a INTEGER, b VARCHAR(4000), c VARCHAR(20), d char(100));
INSERT INTO large_key VALUES(101, lpad('b', 4000, 'b'), lpad('c', 20, 'c'), 'd');
INSERT INTO large_key VALUES(1, lpad('b', 4000, 'b'), lpad('c', 20, 'c'), 'd');
INSERT INTO large_key VALUES(11, lpad('b', 4000, 'b'), lpad('c', 20, 'c'), 'd');
INSERT INTO large_key VALUES(21, lpad('b', 4000, 'b'), lpad('c', 20, 'c'), 'd');
COMMIT;
CREATE INDEX ix_large_key ON large_key(a, b, c) initrans 100 parallel 5;
DELETE FROM large_key WHERE a=11;
COMMIT;
EXEC SLEEP(1);
INSERT INTO large_key VALUES(20, lpad('b', 40, 'b'), lpad('c', 20, 'c'), 'd');
INSERT INTO large_key VALUES(18, lpad('b', 4000, 'b'), lpad('c', 20, 'c'), 'd');
INSERT INTO large_key VALUES(19, lpad('b', 4000, 'b'), lpad('c', 20, 'c'), 'd');
COMMIT;
INSERT INTO large_key VALUES(17, lpad('b', 4000, 'b'), lpad('c', 20, 'c'), 'd');
TRUNCATE TABLE large_key PURGE;
INSERT INTO large_key VALUES(1,  lpad('b', 4000, 'b'), lpad('c', 20, 'c'), 'd');
INSERT INTO large_key VALUES(11, lpad('b', 4000, 'b'), lpad('c', 20, 'c'), 'd');
INSERT INTO large_key VALUES(21, lpad('b', 4000, 'b'), lpad('c', 20, 'c'), 'd');
INSERT INTO large_key VALUES(18, lpad('b', 4000, 'b'), lpad('c', 20, 'c'), 'd');
INSERT INTO large_key VALUES(19, lpad('b', 4000, 'b'), lpad('c', 20, 'c'), 'd');
DROP TABLE large_key PURGE;
CREATE TABLE large_key(a INTEGER, b VARCHAR(4000), c VARCHAR(20), d char(100));
CREATE INDEX ix_large_key ON large_key(a, b, c) initrans 100;
INSERT INTO large_key VALUES(1,  lpad('b', 4000, 'b'), lpad('c', 20, 'c'), 'd');
INSERT INTO large_key VALUES(2,  lpad('b', 4000, 'b'), lpad('c', 20, 'c'), 'd');
INSERT INTO large_key VALUES(3,  lpad('b', 4000, 'b'), lpad('c', 20, 'c'), 'd');
INSERT INTO large_key VALUES(11, lpad('b', 2000, 'b'), lpad('c', 20, 'c'), 'd');
INSERT INTO large_key VALUES(21, lpad('b', 2000, 'b'), lpad('c', 20, 'c'), 'd');
INSERT INTO large_key VALUES(12, lpad('b', 4000, 'b'), lpad('c', 10, 'c'), 'd');
DROP TABLE large_key PURGE;

DROP TABLE IF EXISTS IF_NOT_EXIST;
CREATE TABLE IF_NOT_EXIST(c1 INTEGER, c2 VARCHAR(1000), c3 INTEGER);
CREATE INDEX ix_if_not_exist ON IF_NOT_EXIST(c1, c2);
CREATE INDEX ix_if_not_exist ON IF_NOT_EXIST(c1, c2);
CREATE INDEX IF NOT EXISTS ix_if_not_exist ON IF_NOT_EXIST(c1, c2);
DROP INDEX ix_if_not_exist ON IF_NOT_EXIST;
DROP TABLE IF_NOT_EXIST;
--pctfree
DROP TABLE IF EXISTS PCT_TB0;
CREATE TABLE PCT_TB0 (f1 int, f2 int, f3 int);
INSERT INTO PCT_TB0 VALUES (1,2,3);INSERT INTO PCT_TB0 VALUES (2,2,19);
INSERT INTO PCT_TB0 VALUES (3,2,29);INSERT INTO PCT_TB0 VALUES (4,2,39);
INSERT INTO PCT_TB0 SELECT * FROM PCT_TB0;INSERT INTO PCT_TB0 SELECT * FROM PCT_TB0;
INSERT INTO PCT_TB0 SELECT * FROM PCT_TB0;INSERT INTO PCT_TB0 SELECT * FROM PCT_TB0;
INSERT INTO PCT_TB0 SELECT * FROM PCT_TB0;INSERT INTO PCT_TB0 SELECT * FROM PCT_TB0;
INSERT INTO PCT_TB0 SELECT * FROM PCT_TB0;INSERT INTO PCT_TB0 SELECT * FROM PCT_TB0;
COMMIT;

DROP TABLE IF EXISTS PCT_TB1;
CREATE TABLE PCT_TB1 (f1 int, f2 int, f3 int);
INSERT INTO PCT_TB1 VALUES (1,2,3);INSERT INTO PCT_TB1 VALUES (2,2,19);
INSERT INTO PCT_TB1 VALUES (3,2,29);INSERT INTO PCT_TB1 VALUES (4,2,39);
INSERT INTO PCT_TB1 SELECT * FROM PCT_TB1;INSERT INTO PCT_TB1 SELECT * FROM PCT_TB1;
INSERT INTO PCT_TB1 SELECT * FROM PCT_TB1;INSERT INTO PCT_TB1 SELECT * FROM PCT_TB1;
INSERT INTO PCT_TB1 SELECT * FROM PCT_TB1;INSERT INTO PCT_TB1 SELECT * FROM PCT_TB1;
INSERT INTO PCT_TB1 SELECT * FROM PCT_TB1;INSERT INTO PCT_TB1 SELECT * FROM PCT_TB1;
COMMIT;
CREATE INDEX idx_tb1 ON PCT_TB1 (f1) ONLINE crmode row;
CREATE INDEX idx_tb2 ON PCT_TB1 (f2) PCTFREE 10 crmode page;
CREATE INDEX idx_tb3 ON PCT_TB1 (f3) PCTFREE 80 ONLINE crmode row;
SELECT SEGMENT_NAME, PAGES FROM USER_SEGMENTS where SEGMENT_NAME = 'IDX_TB1' OR SEGMENT_NAME = 'IDX_TB2'  OR SEGMENT_NAME = 'IDX_TB3'  ORDER BY SEGMENT_NAME;
ALTER INDEX idx_tb1 ON PCT_TB1 REBUILD PCTFREE 80;
DELETE FROM PCT_TB1;COMMIT;
INSERT INTO PCT_TB1 SELECT * FROM PCT_TB0; COMMIT;
ALTER INDEX idx_tb2 ON PCT_TB1 REBUILD ONLINE;
ALTER INDEX idx_tb3 ON PCT_TB1 REBUILD PCTFREE 50;

DROP TABLE IF EXISTS PCT_P_TB1;
CREATE TABLE PCT_P_TB1 (f1 int, f2 int, f3 int)
PARTITION BY RANGE(f3)
(
 PARTITION p1 values less than(10),
 PARTITION p2 values less than(20),
 PARTITION p3 values less than(30),
 PARTITION p4 values less than(40)
);
INSERT INTO PCT_P_TB1 VALUES (1,2,3);INSERT INTO PCT_P_TB1 VALUES (2,2,19);
INSERT INTO PCT_P_TB1 VALUES (3,2,29);INSERT INTO PCT_P_TB1 VALUES (4,2,39);
INSERT INTO PCT_P_TB1 SELECT * FROM PCT_P_TB1;INSERT INTO PCT_P_TB1 SELECT * FROM PCT_P_TB1;
INSERT INTO PCT_P_TB1 SELECT * FROM PCT_P_TB1;INSERT INTO PCT_P_TB1 SELECT * FROM PCT_P_TB1;
INSERT INTO PCT_P_TB1 SELECT * FROM PCT_P_TB1;INSERT INTO PCT_P_TB1 SELECT * FROM PCT_P_TB1;
INSERT INTO PCT_P_TB1 SELECT * FROM PCT_P_TB1;INSERT INTO PCT_P_TB1 SELECT * FROM PCT_P_TB1;
INSERT INTO PCT_P_TB1 SELECT * FROM PCT_P_TB1;INSERT INTO PCT_P_TB1 SELECT * FROM PCT_P_TB1;
COMMIT;
create index idx_p1_3 on PCT_P_TB1(f3) local
(
partition p1 pctfree 10,
partition p2 pctfree 50,
partition p3 pctfree 80,
partition p4
) crmode row;
SELECT SEGMENT_NAME, PARTITION_NAME, PAGES FROM USER_SEGMENTS where SEGMENT_NAME = 'IDX_P1_3' ORDER BY PARTITION_NAME;
DELETE FROM PCT_P_TB1; COMMIT;
ALTER INDEX idx_p1_3 on PCT_P_TB1 REBUILD PCTFREE 10;
SELECT  SEGMENT_NAME, PARTITION_NAME, PAGES  FROM USER_SEGMENTS where SEGMENT_NAME = 'IDX_P1_3' ORDER BY PARTITION_NAME;
DROP TABLE IF EXISTS PCT_TB1;
DROP TABLE IF EXISTS PCT_P_TB1;
DROP TABLE IF EXISTS PCT_TB0;
DROP TABLE IF EXISTS I_FIXEDNETWORKLTP;
create table I_FIXEDNETWORKLTP
(
id                                  VARBINARY(16),
class_Name                          VARCHAR(60 BYTE),
class_Id                            BINARY_BIGINT,
last_Modified                       BINARY_BIGINT,
collectorId                                  VARCHAR(36 BYTE),
reportSn                                     BINARY_BIGINT,
regionId                                     BINARY(16),
createTime                                   BINARY_BIGINT,
name                                VARCHAR(255 BYTE),
remark                                       VARCHAR(1024 BYTE),
nativeId                                     VARCHAR(255 BYTE),
ownerId                                      BINARY_BIGINT,
bandwidth                                    BINARY_DOUBLE,
frameId                                      VARCHAR(32 BYTE),
portId                                       VARCHAR(32 BYTE),
cardNativeId                                 VARCHAR(255 BYTE),
portIndex                                    VARCHAR(255 BYTE),
ltpTypeName                         VARCHAR(128 BYTE),
adminState                                   VARCHAR(32 BYTE),
layerRate                                    VARCHAR(64 BYTE),
alias                                        VARCHAR(255 BYTE),
slotId                                       VARCHAR(32 BYTE),
daughterSlotId                               VARCHAR(32 BYTE),
neNativeId                                   VARCHAR(255 BYTE),
direction                                    VARCHAR(32 BYTE),
Trunk__trunkId                               VARCHAR(32 BYTE),
userLabel                                    VARCHAR(256 BYTE),
FanVoipAG__mgId                              BINARY_INTEGER,
workMode                                     VARCHAR(64 BYTE),
OTN__flexFreq                                VARCHAR(32 BYTE),
MPLSTE__availableBandwidth                   BINARY_DOUBLE,
Eth__vlanType                                VARCHAR(32 BYTE),
MPLSTE__maxReservedBandwidth                 BINARY_DOUBLE,
OTN__workBand                                VARCHAR(32 BYTE),
Eth__mtu                                     BINARY_INTEGER,
Optical__opticalModule                       VARCHAR(32 BYTE),
ltpRole                                      VARCHAR(32 BYTE),
isSubLTP                                     BOOLEAN,
owner                                        VARCHAR(32 BYTE),
IP__addrv4Mask                               BINARY_INTEGER,
VNI__vniId                                   BINARY_INTEGER,
isPhysical                                   BOOLEAN,
IP__unnumberedNativeId                       VARCHAR(255 BYTE),
NVE__sourceIP                                VARCHAR(64 BYTE),
OTN__workBandParity                          VARCHAR(32 BYTE),
capabilityURI                                VARCHAR(128 BYTE),
OTN__waveNo                                  VARCHAR(32 BYTE),
Physical__mediumType                         VARCHAR(32 BYTE),
Eth__vlan                                    CLOB,
FanVoipUser__telNumber                       VARCHAR(32 BYTE),
Eth__tunnelId                                BINARY_INTEGER,
tags                                         VARCHAR(2048 BYTE),
SDH__highPath                                BINARY_INTEGER,
SDH__lowPath                                 BINARY_INTEGER,
portType                                     BINARY_INTEGER,
C64K__timeslot                               VARCHAR(100 BYTE),
IP__addrv6                                   CLOB,
Eth__mac                                     VARCHAR(64 BYTE),
FanVLAN__vlanId                              BINARY_INTEGER,
OTN__pathId                                  VARCHAR(32 BYTE),
OTN__freqWidth                               VARCHAR(32 BYTE),
IP__addrv4                                   VARCHAR(32 BYTE)
);
create index CMDBCORESVRDB  on I_FIXEDNETWORKLTP(id);
select * from I_FIXEDNETWORKLTP where (((id IN (UNHEX('429a7277017c87d69edaffea03e66f75'),UNHEX('44c82f61cb2b89b0857af549290c5909'),UNHEX('488d8167b62790f1b17a2b7778367e51'),UNHEX('4867690b6d30632199214a4fb7328f7a'),UNHEX('41bd48b2a3f1787d9d61f82a85e83cce'),UNHEX('4d488bd5c957e86daa35a6fdc7707dd6'),UNHEX('42ddaffe428d3ab39ac6dd9b43df1777'),UNHEX('424808d9c5ce88bf9bbcbe3a109c372f'),UNHEX('4c04bb8d4c3ed1a78bfca833a9ef6a6e'),UNHEX('437b8e16cde7e2579ed93fa566257a55'),UNHEX('49880c661bfb0e468f8d1c7fde8cd5c7'),UNHEX('4fabab86d71d3f1fbb83d294aaffebc4'),UNHEX('42b228ebc5fe92db8a14920a787ecd48'),UNHEX('4154cf901314479fb55fc697efd6f37c'),UNHEX('450578032141d947bcc6aa5849e101e6'),UNHEX('4984ed0b89c4414b869be8d2203a3704'),UNHEX('41983fc03addf60dbd11402b087821c4'),UNHEX('40d0c297408d369ba6ae1b9f2bec3dd3'),UNHEX('43e74c146ab15dfbaf586f3c78b2c08d'),UNHEX('4c5a9963a5d14c6195c3ad7abb619b20'),UNHEX('410819ca18aa29ecbf8b750808218377'),UNHEX('4b195d2c0730f8228f476a260e7d71cc'),UNHEX('4d17774828ab54a6a5b92e06146b031b'),UNHEX('4e191c2fd2391a4eaac6875938010136'),UNHEX('4187824b89f513e888831c9204871cbc'),UNHEX('400bd58c3362f2d2b2594b5818018214'),UNHEX('4115ba2c6c021dd3b96c144ed6aa74d8'),UNHEX('44330866b068fbbfaf521c15221f9c41'),UNHEX('4d67e7c4f6974dd2bb83484decbd8325'),UNHEX('4f33e89ec9a2c31f9a08cd4e65b82260'),UNHEX('4fd956c7ecb42dae81cc68acf64ac294'),UNHEX('430782b1cd30fd298c916203382e52b4'),UNHEX('454d87166e075238bba0fd3247a39921'),UNHEX('4e4b14e17c1a1b7da67f7ae893cf15b4'),UNHEX('44d2341e3b12865b9a7b97cf0994d721'),UNHEX('404482fd3d5b81c28839edf797fabced'),UNHEX('468e63d1dcdb035792b68cfff2bd660c'),UNHEX('451825fc616777be8507d7e89d803774'),UNHEX('42bb5727d5db44f185e0844ad37715d7'),UNHEX('4ba4b0b79f867e459a5c1956641f8185'),UNHEX('481959483c811557bf83531d769f11a4'),UNHEX('46a125ef4bb92b8eae7c48f4aab14442'),UNHEX('4e3f1990b0552c22a876f2651709a142'),UNHEX('436a3821b3be2bbea0c6fd7127f94354'),UNHEX('451d7b755f9f659a9909c5fe8139be90'),UNHEX('4f11e1cd0b00cc449d3ae2fc5c8aafd1'),UNHEX('4b13e73a21f5fa2390e56599768dfc89'),UNHEX('40f6e862be7fd0f49b9b68d8842430f1'),UNHEX('4e60de304af3fbf48820c3b27dcb7c82'),UNHEX('46f3dbc86321cbab81eefc7b0b666ba8'),UNHEX('45e4e822ba02322fbf772f0f79772c47'),UNHEX('46ab68ad318f74b48ce01711b8737911'),UNHEX('48ddf790b15d1f0abc70139fce949bea'),UNHEX('4b8c7303f804f87386dea8fb4e47a578'),UNHEX('4357b27070e02d6ebda14c89898c6b05'),UNHEX('4c05dbcd07d88606a91fe2707655b6da'),UNHEX('4e6673e9f8a898978a0cdab9eccbb81a'),UNHEX('4ae888e7051fdb92bc39a1715a4a80a3'),UNHEX('466e9c1df6656d6cb5b57b7d5b9a871d'),UNHEX('489c3d20e5e1e16bacb25f2e6c6fc8a6'),
UNHEX('44159e8fc1098328811fec8a2185b875'),UNHEX('4868a28ca9542c6694ade875bd02041a'),UNHEX('4c42ec4bb101065281b925ac0354641d'),UNHEX('4379e1df0fe3178e9871aa013f92df48'),UNHEX('4d3b8940d221f9a48d196e1688914d80'),UNHEX('48547ec4ee501037968dec4944cd12d1'),UNHEX('47573a453e32bf09b1f85f3d58f3fe12'),UNHEX('4dccde5424153d4bab53a8f3b4a336b3'),UNHEX('4e781ac2546f2c32b16cc767f6b3b643'),UNHEX('41bb09b94fcfbe8fb577326222463268'),UNHEX('442de081cbccc66d8eb7a00069200222'),UNHEX('4c1ff819c43d4c99b9c50e39aecbedf6'),UNHEX('4e2fd85f6792190b9fc75940101fb67b'),UNHEX('43fb17aef5396eb7905eac6286112b40'),UNHEX('41e6aa84230cd252a01b588a194fb75f'),UNHEX('449c36d9e9cfcc97984bd9c088e81394'),UNHEX('4464f3e0a99ef21eacc65425103e5fc0'),UNHEX('4fd105da93978b39a8f877f847069c23'),UNHEX('45e13fe656ab916db10558d939be8e09'),UNHEX('448cd90a4b421276be6451557ac9b3bd'),UNHEX('47f33a094a51af87862c313b1664b80d'),UNHEX('4a0f6d04a449114eae7e8a311e5819de'),UNHEX('4acc639d342e25c98c906e158a93a1d6'),UNHEX('43560ed7f6c5742bad106f5d99ba651e'),UNHEX('45e74538d46aec24b5c0413a0901fb9d'),UNHEX('4af1485a9a84b3f7beefdaf2ed609bea'),UNHEX('4c59c8872efd3d3d8487b1edd9b615d8'),UNHEX('4003fd1d1dfd9be6ad283176d9e2b4ef'),UNHEX('4344aa10432d765a95ad499b1a36f00c'),UNHEX('4bf686e5db71f18a8fca22098bb77296'),UNHEX('4d13ac53766ca16da46f23cdc297375a'),UNHEX('4c9f8890625206f3a3e3db9cececfafd'),UNHEX('41090298d80006ff99b2761848d58cf2'),UNHEX('42ed8d64c4b4a2d9bd0d0bcaac9e42d2'),UNHEX('4fc962dcc7cd28c7ac096e8ca77c058f'),UNHEX('497a424942b60da48bb79479d41423d5'),UNHEX('43da9fbab2d130a5b6b0ca373f5c2cd8'),UNHEX('48b32bd8da1285beafe987a4729ea081'),UNHEX('42c363ab0dbc907f917dd1e85728f6cf'),UNHEX('48e0dd71f0c9805f84d37524b48628d7')) ))) LIMIT 20 OFFSET 0;

drop user if exists userv cascade;
create user userv identified by GS_12345677;
drop table if exists userv.nebula_ddl_com_012;                                                      
create table userv.nebula_ddl_com_012(c_id int,c_d_id int NOT NULL,c_w_id int NOT NULL,c_first varchar(50) NOT NULL,c_middle char(2),c_last varchar(16) NOT NULL,c_street_1 varchar(20) NOT NULL,c_street_2 varchar(20),c_city varchar(20) NOT NULL,c_state char(2) NOT NULL,c_zip char(9) NOT NULL,c_phone char(16) NOT NULL,c_since timestamp,c_credit char(2) NOT NULL,c_credit_lim numeric(12,2),c_discount numeric(4,4),c_balance numeric(12,2),c_ytd_payment real NOT NULL,c_payment_cnt number NOT NULL,c_delivery_cnt bool NOT NULL,c_end date NOT NULL,c_data varchar(1000),c_clob clob,c_text blob) appendonly on;  
   
create sequence userv.oracle_wide_table_list_seq_012 start with 1 increment by 1 order;
create sequence userv.oracle_wide_table_list_seq_012_1 start with 1 increment by 1 order;
create sequence userv.oracle_wide_table_list_seq_012_2 start with 1 increment by 1 order;
   
CREATE or replace procedure userv.oracle_ddl_com_tbl_012_proc(startnum int,endall int) is
i INT :=1;
j varchar(10);
BEGIN
  FOR i IN startnum..endall LOOP
    select cast(mod(i,10) as varchar(10)) into j from dual;
    insert into userv.nebula_ddl_com_012(c_id,c_d_id,c_w_id,c_first,c_middle,c_last,c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_data,c_clob,c_text) select userv.oracle_wide_table_list_seq_012.nextval,userv.oracle_wide_table_list_seq_012_1.nextval,userv.oracle_wide_table_list_seq_012_2.nextval,'is'||j||'cmRDs','OE','BARBar'||j,'bkilifcrRGF'||j,'pmbwovhSDGj'||j,'dyfrDa'||j,'uq','4801'||j,'940215'||j,sysdate,'GC',50000.0,0.4361328,-10.0,10.0,1,true,sysdate,lpad('aaa',800,'bbb'),lpad('aaa',3000,'bbb'),lpad('111',3000,'222') from dual;
  END LOOP;
END;
/
                                                                                                         
CREATE INDEX userv.nebula_ddl_com_indx_012_2 ON userv.nebula_ddl_com_012(c_first);                            
alter index userv.nebula_ddl_com_indx_012_2 ON userv.nebula_ddl_com_012 unusable;                                                                                                                                                                        
call userv.oracle_ddl_com_tbl_012_proc(1,100);
commit;                                        
truncate table userv.nebula_ddl_com_012;                                                       
alter index userv.nebula_ddl_com_indx_012_2 ON userv.nebula_ddl_com_012 rebuild;                                                                                                                                                                     
flashback table userv.nebula_ddl_com_012 to before truncate force;                                                                                                                                   
update userv.nebula_ddl_com_012 set c_first=substr(c_first,1,16),c_city='bbbbbb',c_data=substr(c_data,1,100),c_text='1111122222222333334445555',c_last=substr(c_last,1,16);
 
drop table if exists userv.oracle_wide_table_list_tbl_012;
create table userv.oracle_wide_table_list_tbl_012(c_id int,c_d_id bigint NOT NULL,c_w_id tinyint unsigned NOT NULL,c_first varchar(16) NOT NULL,c_middle char(2),c_last varchar(16) NOT NULL,c_street_1 varchar(20) NOT NULL,c_street_2 varchar(20),c_city varchar(20) NOT NULL,c_state char(2) NOT NULL,c_zip char(9) NOT NULL,c_phone char(16) NOT NULL,c_since timestamp,c_credit char(2) NOT NULL,c_credit_lim numeric(12,2),c_discount numeric(4,4),c_balance numeric(12,2),c_ytd_payment real NOT NULL,c_payment_cnt number NOT NULL,c_delivery_cnt bool NOT NULL,c_end date NOT NULL,c_data1 varchar(8000),c_data2 varchar(8000),c_data3 varchar(8000),c_data4 varchar(8000),c_data5 varchar(8000),c_data6 varchar(8000),c_data7 varchar(8000),c_data8 varchar(8000),c_clob clob,c_blob blob) partition by list(c_id,c_first) (partition PART_1 values ((0,'is0cmRDs'),(1,'is1cmRDs'),(0,'is0cmRDsaa'),(1,'is1cmRDsaa'),(0,'is0cmRDsbb'),(1,'is1cmRDsbb'),(0,'is0cmRDsaabb'),(1,'is1cmRDsaabb'),(0,'is0cmRDsbbaa'),(1,'is1cmRDsbbaa')),partition PART_2 values((2,'is2cmRDs'),(3,'is3cmRDs'),(2,'is2cmRDsaa'),(3,'is3cmRDsaa'),(2,'is2cmRDsbb'),(3,'is3cmRDsbb'),(2,'is2cmRDsaabb'),(3,'is3cmRDsaabb'),(2,'is2cmRDsbbaa'),(3,'is3cmRDsbbaa')),partition PART_3 values((4,'is4cmRDs'),(5,'is5cmRDs'),(4,'is4cmRDsaa'),(5,'is5cmRDsaa'),(4,'is4cmRDsbb'),(5,'is5cmRDsbb'),(4,'is4cmRDsaabb'),(5,'is5cmRDsaabb'),(4,'is4cmRDsbbaa'),(5,'is5cmRDsbbaa')),partition PART_4 values((6,'is6cmRDs'),(7,'is7cmRDs'),(6,'is6cmRDsaa'),(7,'is7cmRDsaa'),(6,'is6cmRDsbb'),(7,'is7cmRDsbb'),(6,'is6cmRDsaabb'),(7,'is7cmRDsaabb'),(6,'is6cmRDsbbaa'),(7,'is7cmRDsbbaa')),partition PART_5 values(default));
CREATE INDEX userv.oracle_wide_table_list_tbl_012_indx_5 ON userv.oracle_wide_table_list_tbl_012(c_id,c_d_id,c_since) local;

CREATE or replace procedure userv.oracle_wide_table_list_tbl_012_proc(startnum int,endall int) is
i INT :=1;
j varchar(10);
BEGIN
  FOR i IN startnum..endall LOOP
    select cast(mod(i,10) as varchar(10)) into j from dual;
    insert into userv.oracle_wide_table_list_tbl_012(c_id,c_d_id,c_w_id,c_first,c_middle,c_last,c_street_1,c_street_2,c_city,c_state,c_zip,c_phone,c_since,c_credit,c_credit_lim,c_discount,c_balance,c_ytd_payment,c_payment_cnt,c_delivery_cnt,c_end,c_data1,c_data2,c_data3,c_data4,c_data5,c_data6,c_data7,c_data8,c_clob,c_blob) select userv.oracle_wide_table_list_seq_012.nextval,userv.oracle_wide_table_list_seq_012_1.nextval,userv.oracle_wide_table_list_seq_012_2.nextval,'is'||j||'cmRDs','OE','BARBar'||j,'bkilifcrRGF'||j,'pmbwovhSDGj'||j,'dyfrDa'||j,'uq','4801'||j,'940215'||j,sysdate,'GC',50000.0,0.4361328,-10.0,10.0,1,true,sysdate,lpad('aaa',4000,'bbb'),lpad('aaa',4000,'bbb'),lpad('aaa',4000,'bbb'),lpad('aaa',4000,'bbb'),lpad('aaa',4000,'bbb'),lpad('aaa',4000,'bbb'),lpad('aaa',4000,'bbb'),lpad('aaa',4000,'bbb'),lpad('aaa',3000,'bbb'),lpad('111',3000,'222') from dual;
  END LOOP;
END;
/
call userv.oracle_wide_table_list_tbl_012_proc(1,100);
commit;
call userv.oracle_wide_table_list_tbl_012_proc(1,100);commit;
alter index userv.oracle_wide_table_list_tbl_012_indx_5 ON userv.oracle_wide_table_list_tbl_012 unusable;
alter table userv.oracle_wide_table_list_tbl_012 truncate partition PART_5;
alter index userv.oracle_wide_table_list_tbl_012_indx_5 ON userv.oracle_wide_table_list_tbl_012 rebuild;
flashback table userv.oracle_wide_table_list_tbl_012 partition PART_5 to before truncate;
update userv.oracle_wide_table_list_tbl_012 set c_d_id=c_d_id+300,c_since=sysdate,c_first=c_first||'aa',c_delivery_cnt=false,c_data1=lpad('2390ajklKG',200,'ftiun95'),c_data2=lpad('2390ajklKG',200,'ftiun95'),c_data3=lpad('2390ajklKG',200,'ftiun95'),c_data4=lpad('2390ajklKG',200,'ftiun95'),c_data5=lpad('2390ajklKG',200,'ftiun95'),c_data6=lpad('2390ajklKG',200,'ftiun95'),c_data7=lpad('2390ajklKG',200,'ftiun95'),c_data8=lpad('2390ajklKG',200,'ftiun95'),c_clob=lpad('2390ajklKG',2000,'ftiun95'),c_blob=lpad('1112222',4000,'333');commit;
drop user userv cascade;

--DTS2018091501597
CREATE USER idxtester IDENTIFIED BY asdf_1234;
GRANT CREATE ANY TABLE TO idxtester;
GRANT CREATE ANY INDEX TO idxtester;

DROP TABLE IF EXISTS idx_tab001;
DROP TABLE IF EXISTS idxtester.idx_tab001;
CREATE TABLE idxtester.idx_tab001 (col1 INTEGER NOT NULL, col2 VARCHAR(64));
CREATE TABLE idx_tab001 (col1 INTEGER NOT NULL, col2 REAL);
CREATE INDEX sys.ix_idx_tab001 ON idxtester.idx_tab001(col1);    -- error. schema name not same
CREATE INDEX ix_idx_tab001 ON idxtester.idx_tab001(col1);        -- OK. index's schema equals with "idxtester"
CREATE INDEX idxtester.ix_idx_tab002 ON idx_tab001(col2);        -- error. schema name not same
CREATE INDEX ix_idx_tab002 ON idx_tab001(col2);                  -- OK. index's schema equals with "sys"

SELECT U.NAME AS OWNER, T.NAME AS TABLE_NAME, I.NAME AS INDEX_NAME FROM SYS_USERS U JOIN SYS_INDEXES I ON U.ID=I.USER# AND U.NAME='IDXTESTER' JOIN SYS_TABLES T ON I.USER#=T.USER# AND I.TABLE#=T.ID WHERE T.NAME='IDX_TAB001';  --1 row expected
SELECT M.USER_NAME AS OWNER, T.NAME AS TABLE_NAME, I.NAME AS INDEX_NAME FROM V$ME M JOIN SYS_INDEXES I ON M.USER_ID=I.USER# JOIN SYS_TABLES T ON I.USER#=T.USER# AND I.TABLE#=T.ID WHERE T.NAME='IDX_TAB001';  --1 row expected

DROP INDEX ix_idx_tab002 ON idx_tab001;
DROP TABLE idx_tab001;
DROP INDEX idxtester.ix_idx_tab001 ON idxtester.idx_tab001;
DROP TABLE idxtester.idx_tab001;
DROP USER idxtester CASCADE;

DROP TABLE IF EXISTS TEST_IN_INDEX;
CREATE TABLE TEST_IN_INDEX (ID VARBINARY(36) UNIQUE);
SELECT * FROM TEST_IN_INDEX I WHERE (((((((I.ID IN (UNHEX('11E8C9FF31C8B27489990242E088AEF7'),UNHEX('11E8C9FF31C8D98589990242E088AEF7'),UNHEX('11E8C9FF31C8D98789990242E088AEF7'),UNHEX('11E8C9FF31C8D98689990242E088AEF7'),UNHEX('11E8C9FF31C9009889990242E088AEF7'),UNHEX('11E8C9FF31C9009989990242E088AEF7')) ))
AND (I.ID IN (UNHEX('11E8C9FF31C8B27489990242E088AEF7'),UNHEX('11E8C9FF31C8D98589990242E088AEF7'),UNHEX('11E8C9FF31C8D98789990242E088AEF7'),UNHEX('11E8C9FF31C8D98689990242E088AEF7'),UNHEX('11E8C9FF31C9009889990242E088AEF7'),UNHEX('11E8C9FF31C9009989990242E088AEF7')) ))
AND (I.ID IN (UNHEX('11E8C9FF31C8B27489990242E088AEF7'),UNHEX('11E8C9FF31C8D98589990242E088AEF7'),UNHEX('11E8C9FF31C8D98789990242E088AEF7'),UNHEX('11E8C9FF31C8D98689990242E088AEF7'),UNHEX('11E8C9FF31C9009889990242E088AEF7'),UNHEX('11E8C9FF31C9009989990242E088AEF7')) ))
AND (I.ID IN (UNHEX('11E8C9FF31C8B27489990242E088AEF7'),UNHEX('11E8C9FF31C8D98589990242E088AEF7'),UNHEX('11E8C9FF31C8D98789990242E088AEF7'),UNHEX('11E8C9FF31C8D98689990242E088AEF7'),UNHEX('11E8C9FF31C9009889990242E088AEF7'),UNHEX('11E8C9FF31C9009989990242E088AEF7')) ))
AND (I.ID IN (UNHEX('11E8C9FF31C8B27489990242E088AEF7'),UNHEX('11E8C9FF31C8D98589990242E088AEF7'),UNHEX('11E8C9FF31C8D98789990242E088AEF7'),UNHEX('11E8C9FF31C8D98689990242E088AEF7'),UNHEX('11E8C9FF31C9009889990242E088AEF7'),UNHEX('11E8C9FF31C9009989990242E088AEF7')) )));
DROP TABLE IF EXISTS TEST_IN_INDEX;

CREATE TABLE TEST_IN_INDEX (ID INT, PID INT, NAME VARCHAR(8));
CREATE INDEX IDX_IDS ON TEST_IN_INDEX(ID,PID);
INSERT INTO TEST_IN_INDEX VALUES (1,1,'zzz');
SELECT DISTINCT ID,PID FROM TEST_IN_INDEX;
DROP TABLE TEST_IN_INDEX;

--test truncate btree reuse storage
DROP TABLE IF EXISTS bt_truncate;
CREATE TABLE bt_truncate(c1 int, c2 varchar(1000), c3 int);
CREATE INDEX ix_bt_truncate ON bt_truncate(c1, c2);
CREATE OR REPLACE PROCEDURE proc_bt_truncate(v_count integer) AS
  v_c1 INTEGER;
BEGIN
  FOR v_c1 IN 1 .. v_count LOOP
      EXECUTE IMMEDIATE 'INSERT INTO bt_truncate VALUES(100000-'||v_c1||', LPAD(''ABCDEFGHIJ'', 100, ''ABCDEFGHIJ''), 1)';
  END LOOP;
  COMMIT;
END;
/
EXEC proc_bt_truncate(2000);
DROP TABLE IF EXISTS bt_truncate2;
CREATE TABLE bt_truncate2(c1 int, c2 varchar(1000), c3 int);
CREATE INDEX ix_bt_truncate2 ON bt_truncate2(c1, c2);
CREATE OR REPLACE PROCEDURE proc_bt_truncate2(v_count integer) AS
  v_c1 INTEGER;
BEGIN
  FOR v_c1 IN 1 .. v_count LOOP
      EXECUTE IMMEDIATE 'INSERT INTO bt_truncate2 VALUES(100000-'||v_c1||', LPAD(''ABCDEFGHIJ'', 100, ''ABCDEFGHIJ''), 1)';
  END LOOP;
  COMMIT;
END;
/
EXEC proc_bt_truncate2(2000);

TRUNCATE TABLE bt_truncate REUSE STORAGE;
TRUNCATE TABLE bt_truncate2 REUSE STORAGE;
EXEC proc_bt_truncate2(3000);
EXEC proc_bt_truncate(3000);
DROP TABLE bt_truncate PURGE;
DROP TABLE bt_truncate2 PURGE;
--alter system index
ALTER INDEX IX_TABLE$001 ON SYS_TABLES REBUILD;
CREATE INDEX IDX_SYS_1 ON SYS_TABLES(ID);
CREATE INDEX IDX_SYS_2 ON SYS_TABLES(UPPER(ID));

--test batch update of primary key 
drop table if exists test_pk;
create table test_pk(id int primary key, val varchar(10));
insert into test_pk values(1, 'a'), (2, 'b'), (3, 'c'), (4, 'd'), (5, 'e');
commit;
update test_pk set id = id+1 where id<3;
select * from test_pk order by id;
update test_pk set id = id+1 where id<10;
select * from test_pk order by id;
update test_pk set id = id - 1 where id > 3;
select * from test_pk order by id;
update test_pk set id = id - 1;
select * from test_pk order by id;
update test_pk set id = id - 1;
select * from test_pk order by id;
rollback;
select * from test_pk order by id;
drop table test_pk;

drop table if exists test_pk;
create table test_pk(id int, val varchar(10)) crmode row;
create unique index idx_test_pk on test_pk(id) crmode row;
insert into test_pk values(1, 'a'), (2, 'b'), (3, 'c'), (4, 'd'), (5, 'e');
commit;
update test_pk set id = id+1 where id<3;
select * from test_pk order by id;
update test_pk set id = id+1 where id<10;
select * from test_pk order by id;
update test_pk set id = id - 1 where id > 3;
select * from test_pk order by id;
update test_pk set id = id - 1;
select * from test_pk order by id;
update test_pk set id = id - 1;
select * from test_pk order by id;
rollback;
select * from test_pk order by id;
drop table test_pk;

drop table if exists  trigger_tbl_032_1;
drop table if exists trigger_tbl_032;
create table trigger_tbl_032(c_id int,c_d_id int,c_w_id int,c_credit_lim numeric(12,2),c_first varchar(32),c_since timestamp);
alter table trigger_tbl_032 add constraint pk_trigger_032_001 primary key(c_id);
insert into trigger_tbl_032 values(1000,1,1,10,'c_firstaaaaaaaa',to_timestamp('2018-01-01 00:00:00.00','yyyy-mm-dd hh24:mi:ss.ff3'));
insert into trigger_tbl_032 values(2000,2,2,10,'c_firstbbbbbbbb',to_timestamp('2018-12-01 00:00:00.00','yyyy-mm-dd hh24:mi:ss.ff3'));
insert into trigger_tbl_032 values(3000,3,3,10,'c_firstcccccccc',to_timestamp('2018-12-30 00:00:00.00','yyyy-mm-dd hh24:mi:ss.ff3'));

create table trigger_tbl_032_1(c_id int,c_d_id int,c_w_id int);
alter table trigger_tbl_032_1 add constraint fk_trigger_032_001 foreign key(c_id) references trigger_tbl_032(c_id);
insert into trigger_tbl_032_1 values(1000,10,10);
insert into trigger_tbl_032_1 values(2000,20,20);
insert into trigger_tbl_032_1 values(3000,30,20);

commit;

--I2.创建表级before delete or update 行级触发器
create or replace trigger trg_aft_dml_032
after delete or update of c_id on trigger_tbl_032 for each row
begin
if :old.c_id != :new.c_id then
update trigger_tbl_032_1 set trigger_tbl_032_1.c_id=null
where trigger_tbl_032_1.c_id=:old.c_id;
end if;
end;
/

--I3.执行update和delete语句触发触发器()
update trigger_tbl_032 set c_id=c_id+1;
update trigger_tbl_032 set c_id=c_id-1;
update trigger_tbl_032 set c_id=1;
update trigger_tbl_032 set c_id=1 where c_first like 'c_firsta%';
delete from trigger_tbl_032;
select c_id from trigger_tbl_032 order by 1;
select c_id from trigger_tbl_032_1 order by 1;
drop table trigger_tbl_032_1 purge;
drop table trigger_tbl_032 purge;

--test insert on duplicate key
drop table if exists test_duplicate_026;
create table test_duplicate_026(id int primary key); 
insert into test_duplicate_026 values(1) on duplicate key update id =16+10;
insert into test_duplicate_026 values(2) on duplicate key update id =16-10;
insert into test_duplicate_026 values(3) on duplicate key update id =16+10; 
insert into test_duplicate_026 values(4) on duplicate key update id =16-10; 
insert into test_duplicate_026 values(1) on duplicate key update id =2;
select * from test_duplicate_026;
drop table test_duplicate_026 purge;

--test merge into
drop table if exists merge_org;
drop table if exists merge_dst;
create table merge_org(id int primary key, val int);
insert into merge_org values(1, 1), (2, 2), (3, 3);
commit;
create table merge_dst(id int, val int);
alter table merge_dst add constraint pk_merge_dst primary key(id);
insert into merge_dst values(1, 1),(2, 2);
commit;
merge into merge_dst d using merge_org o on (o.id = d.id) when matched then update set id = d.id+1 when not matched then insert (id, val) values(3, 3);
select * from merge_dst order by id;
insert into merge_dst values(3,3);
merge into merge_dst d using merge_org o on (o.id = d.id) when matched then update set id = d.id+1 when not matched then insert (id, val) values(3, 3);
select * from merge_dst order by id;
drop table merge_dst purge;
drop table merge_org purge;

DROP TABLE IF EXISTS T_TRIG_1;
DROP TABLE IF EXISTS T_TRIG_2;
DROP TABLE IF EXISTS T_TRIG_3;
CREATE TABLE T_TRIG_1 (F_INT1 INT, F_INT2 INT, F_CHAR1 CHAR(16), F_DATE DATE, primary key(F_INT1));
CREATE TABLE T_TRIG_2 (F_INT1 INT, F_INT2 INT, F_CHAR1 CHAR(16), F_DATE DATE);
CREATE TABLE T_TRIG_3 (F_INT1 INT, F_INT2 INT, F_CHAR1 CHAR(16), F_DATE DATE);

insert into  T_TRIG_1 values(1,2,'A','2017-12-11 14:08:00');
insert into  T_TRIG_1 values(2,2,'A','2017-12-11 14:08:00');
insert into  T_TRIG_1 values(3,2,'A','2017-12-11 14:08:00');
insert into  T_TRIG_1 values(4,2,'A','2017-12-11 14:08:00');
insert into  T_TRIG_1 values(5,2,'A','2017-12-11 14:08:00');

insert into  T_TRIG_2 values(3,2,'A','2017-12-11 14:08:00');
insert into  T_TRIG_2 values(4,2,'A','2017-12-11 14:08:00');
insert into  T_TRIG_2 values(5,2,'A','2017-12-11 14:08:00');
insert into  T_TRIG_2 values(6,2,'A','2017-12-11 14:08:00');
insert into  T_TRIG_2 values(7,2,'A','2017-12-11 14:08:00');

CREATE OR REPLACE TRIGGER TRIG_BEFORE_STMT BEFORE UPDATE ON T_TRIG_1
FOR EACH ROW
BEGIN
  INSERT INTO T_TRIG_3 VALUES(null,null,null,null);
END;
/

merge into T_TRIG_1 hzy1 using (select * from T_TRIG_2)hzy2 on (hzy1.F_INT1 = hzy2.F_INT1)
WHEN MATCHED THEN update set hzy1.F_INT1 = hzy1.F_INT1 + 1;
select * from T_TRIG_1 order by F_INT1;
select * from T_TRIG_1 where F_INT1 = 1;
select * from T_TRIG_1 where F_INT1 = 2;
select * from T_TRIG_1 where F_INT1 = 4;
select * from T_TRIG_1 where F_INT1 = 5;
select * from T_TRIG_1 where F_INT1 = 6;
DROP TABLE IF EXISTS T_TRIG_1;
DROP TABLE IF EXISTS T_TRIG_2;
DROP TABLE IF EXISTS T_TRIG_3;

--test split
drop table if exists test_split;
create table test_split(id int, name varchar(3890), score int);
create index ix_test_split on test_split(id, name);
create or replace procedure pro_init_split() as
    i integer;
begin
    for i in 1..10 loop
        execute immediate 'insert into test_split values(20 - 2 * '||i||', lpad(''a'', 1000, ''a''), 1)';
    end loop;
    insert into test_split values(13, lpad('a', 3890, 'a'), 1);
    commit;
end;
/

declare
    i integer;
begin
    for i in 1..10 loop
        delete from test_split;
        execute immediate 'truncate table test_split purge';
        execute immediate ' call pro_init_split()';
        execute immediate 'insert into test_split values(1 + 2 * '||i||', lpad(''a'', 3890, ''a''), 1)';
    end loop;
    commit;
end;
/

drop table test_split purge;

drop table if exists tablename1;
create table tablename1(id int auto_increment primary key,  b NVARCHAR(3900), text NVARCHAR(4080), c VARCHAR(660 char), d VARCHAR(260 char), e integer);
CREATE INDEX index_nv1 ON tablename1(text);
CREATE INDEX index_nv4 ON tablename1(id, e, b);
CREATE INDEX index_nv3 ON tablename1(d);
CREATE INDEX index_nv2 ON tablename1(c);
CREATE INDEX index_nv0 ON tablename1(upper(d));
insert into tablename1 values(1,  lpad('a', 3871, 'a'), lpad('a', 3900, 'a'),  lpad('a', 650, 'a'),  lpad('a', 30, 'a'), 1);
insert into tablename1(id, b, e) values(2, '测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符', 1);
insert into tablename1(id, b, e) values(2, '测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测试宽字符测', 1);
commit;
CREATE INDEX index_nv5 ON tablename1(upper(d), b);
drop table if exists tablename1;

drop table if exists initrans_a;
create table initrans_a (i char(10));
create index idx_trans_1 on initrans_a(i) initrans 167;
create or replace procedure pro_init_trans() as
i integer;
begin
   for i in 1..156 loop
       insert into initrans_a values('zzzzz');
  end loop;
end;
/
call pro_init_trans();
insert into initrans_a values('zaaaa');
commit;
drop table initrans_a;

drop table if exists initrans_row;
create table initrans_row (i char(10)) crmode row;
create index idx_trans_2 on initrans_row(i) initrans 165 crmode row;
create or replace procedure pro_init_trans_row() as
i integer;
begin
   for i in 1..119 loop
       insert into initrans_row values('zzzzz');
  end loop;
end;
/
call pro_init_trans_row();
insert into initrans_row values('zaaaa');
commit;
drop table initrans_row;
drop table if exists sys.tbl_duplicate;
create table sys.tbl_duplicate(col_int int,col_binary1 binary(100));
alter table sys.tbl_duplicate add constraint cons_pk_int1 primary key(col_binary1);   
insert into sys.tbl_duplicate values  (1, 'c0427c0dd8474651a29230d3fc898bc9');
insert into sys.tbl_duplicate values  (1, 'c0427c0dd8474651a29230d3fc898bc9');
drop table if exists sys.tbl_duplicate;
create table sys.tbl_duplicate(col_char varchar(10),col_varchar1 varchar(100));
create unique index idx_duplicate on sys.tbl_duplicate(col_char, col_varchar1);
insert into sys.tbl_duplicate values  (NULL, 'c0427c0dd8474651a29230d3fc898bc9');
insert into sys.tbl_duplicate values  (NULL, 'c0427c0dd8474651a29230d3fc898bc9');
drop table if exists sys.tbl_duplicate;
drop table if exists table_errno;
create table table_errno (i int);
create index index_errno on table_errno(i);
create index index_errno on table_errno(i) online;
create index index_errno on table_errno(i);
drop table if exists table_errno;
--duplicate primary key
drop table if exists hsf;
create table hsf(col1 int, col2 int,col3 int,col4 int);
create unique index test_hsf on hsf(col1,col2);
ALTER TABLE hsf ADD PRIMARY KEY(col1,col2);
ALTER TABLE hsf ADD PRIMARY KEY(col1,col3,col2);
drop table if exists hsf;

--loss extent when rebuild index
CREATE TABLESPACE IDX_SEG_TEST_SPC DATAFILE 'IDX_SEG_TEST_FILE' SIZE 16M;
CREATE TABLE IDX_SEG_TEST_TB (A INT, B INT) TABLESPACE IDX_SEG_TEST_SPC;
CREATE INDEX IDX_SEG_TEST_IDX ON IDX_SEG_TEST_TB(A, B);
INSERT INTO IDX_SEG_TEST_TB VALUES(1,2);
COMMIT;
ALTER TABLE IDX_SEG_TEST_TB MODIFY (A BINARY_INTEGER NOT NULL, B BINARY_INTEGER NOT NULL);

SET SERVEROUT ON;
DECLARE
    SIZE1 BIGINT;
    SIZE2 BIGINT;
BEGIN
	SELECT USED_SIZE INTO SIZE1 FROM DBA_TABLESPACES WHERE TABLESPACE_NAME='IDX_SEG_TEST_SPC';
	SELECT SUM(BYTES) INTO SIZE2 FROM DBA_SEGMENTS WHERE TABLESPACE_NAME = 'IDX_SEG_TEST_SPC';
	dbe_output.print_line(SIZE1-SIZE2);
END;
/
drop TABLESPACE IDX_SEG_TEST_SPC including contents cascade constraints;

--SR.TMP.0000000365  Index selection optimization
drop table if exists index_t1;
create table index_t1 (a int, b int, c int, d int);
create index index1 on index_t1(a,b);
create index index2 on index_t1(a,c,d);
explain select * from index_t1 where a > 10 and c > 10;

drop index index1 on index_t1;
drop index index2 on index_t1;
create index index1 on index_t1(a,b,d);
create index index2 on index_t1(a,b,c);  
explain select * from index_t1 where a > 10 and c > 10 and b < 10;

drop index index1 on index_t1;
drop index index2 on index_t1;
create index index1 on index_t1(a,b,c,d);
create index index2 on index_t1(a,c);  
explain select * from index_t1 where a > 10 and c > 10;

drop index index1 on index_t1;
drop index index2 on index_t1;
create index index1 on index_t1(b,a);
create index index2 on index_t1(a,b);  
explain select * from index_t1 where a > 10 and b < 10;

drop index index1 on index_t1;
drop index index2 on index_t1;
create index index1 on index_t1(a,c);
create index index2 on index_t1(a,c,d);  
explain select * from index_t1 where a > 10 and c > 10;
explain select * from index_t1 where a > 10 and c > 10 order by a, c;
explain select d from index_t1 where a > 10 and c > 10 order by a, c;
explain select * from index_t1 where a > 10 and c > 10 order by a, c, d;

drop index index1 on index_t1;
drop index index2 on index_t1;   
create index index1 on index_t1(a,c,d);
create index index2 on index_t1(a,c,b);
explain select d from index_t1 where a > 10 and c > 10 order by a, c, b;

drop table if exists index_t1;
drop table if exists index_t2;
create table index_t1 (a int, b int, c int, d int);
create table index_t2 (a int, b int, c int, d int);
create index index1 on index_t1(a,b);
create index index2 on index_t1(a,c,d);
create index index3 on index_t2(a,b);
create index index4 on index_t2(a,c,d);
explain select * from index_t1,index_t2 where index_t1.a > 10 and index_t1.c > 10 and index_t2.a > 10 and index_t2.c < 10; 
drop table if exists index_t1;
drop table if exists index_t2;

--DTS2019061707095
Drop table if exists t_test_index1;
Drop index if exists index11 on t_test_index1;
Drop index if exists index22 on t_test_index1;
create table t_test_index1(a int, b number, c bool, d varchar(10), e varchar(1000), f date);
Create index index11 on t_test_index1(a,f,b);
Create index index22 on t_test_index1(c,f,d,b);
Explain plan for Select * from t_test_index1 where a in (1,2) and c in (true,false) and d = 'abcergk' and b > 0  and f = '2011-10-10' order by a,f,b;
Drop table t_test_index1;

----DTS2019061208763
Drop table if exists index_t1;
create table index_t1(a int, b int, c int, d int, e int, f int);
ALTER TABLE index_t1 ADD CONSTRAINT PK_I_FIXEDNETWORKLTP PRIMARY KEY (a);
Create index index2 on index_t1(b,a);
Explain Select * from index_t1 where a >0 and b in (3,1,2) order by a limit 4;

Drop table if exists index_t1;
create table index_t1(a int, b int, c int, d int, e int, f int);
Create index index3 on index_t1( c );
Create index index4 on index_t1( b, a, c );
Explain Select * from index_t1 where a in (1,2) and b = 3 and c > 0  order by c limit 1 offset 0; 

Drop table if exists index_t1;
create table index_t1(a int, b int, c int, d int, e int, f int);
Create index index5 on index_t1(a,b);
Create index index6 on index_t1(c,d,b);
Explain Select * from index_t1 where a in (1,2) and c in (1,3,2) and d = 3 and b > 0  order by a,b limit 3 offset 0; 

Drop table if exists index_t1;
create table index_t1(a int, b int, c int, d int, e int, f int);
Create index index7 on index_t1(a,f,b);
Create index index8 on index_t1(c,f,d,b);
Explain Select * from index_t1 where a in (1,2) and c in (1,3,2) and d = 3 and b > 0  and f = 0 order by a,f,b ;
Drop table index_t1;

drop table if exists index_t2;
create table index_t2 (id int, name varchar(1024));
create unique index i1 on index_t2 (id);
create index i2 on index_t2 (name, id);
explain select * from index_t2 where (id > 1 or id is null) and name in ('a', 'b') order by id asc limit 1001 offset 0;
explain select * from index_t2 where (id > 1 or id is null) and name in ('a', 'b') order by id asc offset 0;
drop table index_t2;

DROP TABLE IF EXISTS I_FIXEDNETWORKLTP;
CREATE TABLE `I_FIXEDNETWORKLTP`
(
  `id` VARBINARY(16) NOT NULL,
  `class_Id` BINARY_BIGINT NOT NULL,
  `collectorId` VARCHAR(36 BYTE),
  `tenantId` VARCHAR(64 BYTE),
  `regionId` VARBINARY(16),
  `name` VARCHAR(765 BYTE) NOT NULL,
  `nativeId` VARCHAR(765 BYTE),
  `ownerId` BINARY_BIGINT,
  `FanVoipUser__telNumber` VARCHAR(384 BYTE),
  `alias` VARCHAR(765 BYTE),
  `IP__addrv4` VARCHAR(96 BYTE),
  `Plan__usageState` VARCHAR(96 BYTE)
);
ALTER TABLE I_FIXEDNETWORKLTP ADD CONSTRAINT PK_I_FIXEDNETWORKLTP PRIMARY KEY (`id`);
CREATE INDEX `IDXFIXEDNETWORKLTP_FANVOIPUSER_TELNUMBER_2130` ON `I_FIXEDNETWORKLTP`(`FanVoipUser__telNumber`, `id`);
CREATE INDEX `IDXFIXEDNETWORKLTP_IP_ADDRV4_2130` ON `I_FIXEDNETWORKLTP`(`IP__addrv4`, `id`);
CREATE INDEX `IDX_I_FIXEDNETWORKLTP_ALIAS_ID` ON `I_FIXEDNETWORKLTP`(`alias`, `id`);
CREATE INDEX `IDX_I_FIXEDNETWORKLTP_CLASS_ID` ON `I_FIXEDNETWORKLTP`(`class_Id`);
CREATE INDEX `IDX_I_FIXEDNETWORKLTP_COLLECTORID` ON `I_FIXEDNETWORKLTP`(`collectorId`);
CREATE INDEX `IDX_I_FIXEDNETWORKLTP_NAME_ID` ON `I_FIXEDNETWORKLTP`(`name`, `id`);
CREATE INDEX `IDX_I_FIXEDNETWORKLTP_NATIVEID_OWNERID_REGIONID` ON `I_FIXEDNETWORKLTP`(`nativeId`, `ownerId`, `regionId`);
CREATE INDEX `IDX_I_FIXEDNETWORKLTP_TENANTID_COLLECTORID` ON `I_FIXEDNETWORKLTP`(`tenantId`, `collectorId`);
explain
SELECT `id`,ROWNUM FROM I_FIXEDNETWORKLTP I WHERE ((
(((I.`id`  > UNHEX('11E84A9640970A1A82CC005056810409')) )) AND 
((I.`name` IN (
unhex('11E840A1517340FD9167005056810409'),
unhex('11E840A151867ADE9167005056810409'),
unhex('11E840A1573C6BE89167005056810409')
)))))   order by `id` limit 1000;
DROP TABLE IF EXISTS I_FIXEDNETWORKLTP;

DROP TABLE IF EXISTS I_FIXEDNETWORKLTP_PARTITION_LOCAL;
CREATE TABLE `I_FIXEDNETWORKLTP_PARTITION_LOCAL`
(
  `id` varchar(32) NOT NULL,
  `name` VARCHAR(765 BYTE) NOT NULL,
  `remark` VARCHAR(3072 BYTE),
  `nativeId` VARCHAR(765 BYTE),
  `ownerId` BINARY_BIGINT
)
partition by hash (`id`)
(
partition part_00 ,
partition part_01
);
ALTER TABLE I_FIXEDNETWORKLTP_PARTITION_LOCAL ADD CONSTRAINT PK_I_FIXEDNETWORKLTP_PARTITION_LOCAL PRIMARY KEY(`id`)  
USING INDEX (CREATE INDEX PK_I_FIXEDNETWORKLTP_PARTITION_LOCAL ON I_FIXEDNETWORKLTP_PARTITION_LOCAL(`id`) local);
CREATE INDEX `IDX_I_FIXEDNETWORKLTP_LOCALNAME_ID` ON `I_FIXEDNETWORKLTP_PARTITION_LOCAL`(`name`, `id`) local;
explain SELECT  `name`,`remark` FROM I_FIXEDNETWORKLTP_Partition_local I WHERE I.`name` like 'TestLTP2%' ORDER BY I.`name` ASC , I.`id` ASC LIMIT 1000;
explain SELECT  `name`,`remark`  FROM I_FIXEDNETWORKLTP_Partition_local I WHERE I.`name` like 'TestLTP2%'  and I.`id` > 'abc' ORDER BY I.`id` ASC LIMIT 1000;
DROP TABLE IF EXISTS I_FIXEDNETWORKLTP_PARTITION_LOCAL;

--DTS2019071012563
drop table if exists rbo_table1;
drop table if exists rbo_table2;
drop table if exists rbo_table3;
create table rbo_table1(a int, b int, c int, d int, e int);
create table rbo_table2(a int, b int, c int, d int, e int);
create table rbo_table3(a int, b int, c int, d int, e int);
create index rbo_index_2 on rbo_table3(a,b,c);
create index rbo_index_1 on rbo_table3(a);

explain select * from rbo_table3 where a > 1;
explain select * from rbo_table1, rbo_table2 where exists(select b from rbo_table3  where rbo_table3.a = rbo_table1.a );
explain select * from rbo_table1, rbo_table2 where exists(select b from rbo_table3  where rbo_table3.a = rbo_table1.a and rbo_table3.c > 0);
explain select * from rbo_table1, rbo_table2 where exists(select 1 from rbo_table3  where rbo_table3.c > 0 and rbo_table3.a = rbo_table1.a  order by a, b);
drop table rbo_table1;
drop table rbo_table2;
drop table rbo_table3;

--test index print duplicate key
DROP TABLE IF EXISTS test_dupkey_print;
CREATE TABLE test_dupkey_print(c1 varchar(1000), c2 int);
CREATE UNIQUE INDEX ix_test_dupkey_print ON test_dupkey_print(c1, c2);
INSERT INTO test_dupkey_print VALUES(LPAD('A',1000,'A'), 1);
INSERT INTO test_dupkey_print VALUES(LPAD('A',1000,'A'), 1);
DROP TABLE test_dupkey_print PURGE;

conn / as sysdba
drop user if exists liu_rename_index cascade;
create user liu_rename_index identified by Lh00420062;
grant dba to liu_rename_index;
conn liu_rename_index/Lh00420062@127.0.0.1:1611

drop table if exists rename_index_t1;
create table rename_index_t1(a int, c varchar(100));
insert into rename_index_t1 values(10,'liu');
create index idx1 on rename_index_t1(a);
select INDEX_NAME from sys.db_indexes where owner=upper('liu_rename_index');

drop table if exists tt1;
drop table if exists tt2;
create table tt1(a int,b int);
create index liu_idx1 on tt1(a);
drop index liu_idx1 on tt2;
drop index liu_idx2 on tt1;
drop index liu_idx1 on tt1;
drop table if exists tt1;
drop table if exists tt2;

conn / as sysdba
alter index liu_rename_index.idx1 on rename_index_t1 rename to idx_other1;
select INDEX_NAME  from sys.db_indexes where owner=upper('liu_rename_index');
drop user if exists liu_rename_index cascade;

drop user if exists test_index;
create user test_index identified by 'Cantian_234';
grant dba to test_index;
conn test_index/Cantian_234@127.0.0.1:1611
drop table if exists a;
create table a(id int);
create index ix_a on a(id);
insert into a values(10);
create tablespace new_space datafile 'new_space' size 128M;
truncate table a;
select index_name, tablespace_name from user_indexes where index_name='IX_A';
alter index ix_a on a rebuild tablespace new_space;
flashback table a to before truncate;
select index_name, tablespace_name from user_indexes where index_name='IX_A';
drop table a;
drop tablespace new_space INCLUDING CONTENTS AND DATAFILES;
conn / as sysdba
drop user test_index cascade;
drop user test_index;

drop table if exists match_cond;
create table match_cond(c1 int, c2 int, c3 int, c4 int, c5 int);
create index ix_match_cond on match_cond(c1, c2, c3, c4) crmode page;
create or replace procedure load_data() as
    a int;
    b int;
    c int;
    d int;
begin
    for a in 1..10 loop
        for b in 1..10 loop
            for c in 1..10 loop
                for d in 1..10 loop
                    execute immediate 'insert into match_cond values('||a||', '||b||', '||c||', '||d||', 1)';
                end loop;
            end loop;
        end loop;
    end loop;
    commit;
end;
/

call load_data();

drop index ix_match_cond on match_cond;
create index ix_match_cond on match_cond(c1, c2, c3, c4) crmode row;
select * from match_cond where c1>3 and c1<5 and c2>3 and c2<5 and c4>5 order by c1, c2, c3, c4;
select * from match_cond where c1=3 and c2=3 and c4>5 order by c1, c2, c3, c4;
select * from match_cond where c1>9 and c2 > 9 and c3>5 and c4 > 5;
select * from match_cond where c1<2 and c2 < 2 and c3<5 and c4 < 5;

select * from match_cond where c1>3 and c1<5 and c2>3 and c2<5 and c4>5 order by c1, c2, c3, c4 desc;
select * from match_cond where c1=3 and c2=3 and c4>5 order by c1, c2, c3, c4 desc;
drop table match_cond purge;

create user test_index identified by 'Cantian_234';
grant dba to test_index;
conn test_index/Cantian_234@127.0.0.1:1611
drop table if exists a;
create table a(id int);
create index ix_a on a(id);
insert into a values(10);
create tablespace new_space datafile 'new_space' size 128M;
truncate table a;
select index_name, tablespace_name from user_indexes where index_name='IX_A';
alter index ix_a on a rebuild tablespace new_space;
flashback table a to before truncate;
select index_name, tablespace_name from user_indexes where index_name='IX_A';
drop table a;
drop tablespace new_space INCLUDING CONTENTS AND DATAFILES;
conn / as sysdba
drop user if exists test_index cascade;

drop table if exists test_batch;
drop table if exists test_data;

create table test_data(id1 varchar(3000), id2 varchar(3000), val varchar(10));
declare
  i int;
begin
  for i in 1..1000 loop
    execute immediate 'insert into test_data values('||i||', '||i||', ''aaaaaaaaa'')';
  end loop;
end;
/

--test batch insert
create table test_batch(id1 varchar(3000), id2 varchar(3000), val varchar(10));
insert into test_batch select * from test_data;
create unique index ix_test_batch on test_batch(id2) crmode page;
--test unique index overwrite
savepoint svpt1;
delete from test_batch;
select sum(id2) from test_batch;
savepoint svpt2;
insert into test_batch select * from test_data;
select sum(id2) from test_batch;
savepoint svpt3;
delete from test_batch where id2 %2 = 0;
select sum(id2) from test_batch;
insert into test_batch select * from test_data;
select sum(id2) from test_batch;
rollback to savepoint svpt3;
select sum(id2) from test_batch;
rollback to savepoint svpt2;
select sum(id2) from test_batch;
rollback to savepoint svpt1;
select sum(id2) from test_batch;
truncate table test_batch purge;

--test non-unique index batch insert
drop index ix_test_batch on test_batch;
create index ix_test_batch on test_batch(id1) crmode page;
create index ix_test_batch2 on test_batch(id2) crmode row;
insert into test_batch select * from test_data;
savepoint svpt1;
delete from test_batch;
select sum(id1) from test_batch;
savepoint svpt2;
insert into test_batch select * from test_data;
select sum(id1) from test_batch;
savepoint svpt3;
delete from test_batch where id2 %2 = 0;
select sum(id1) from test_batch;
insert into test_batch select * from test_data;
select sum(id1) from test_batch;
rollback to savepoint svpt3;
select sum(id1) from test_batch;
rollback to savepoint svpt2;
select sum(id1) from test_batch;
rollback to savepoint svpt1;
select sum(id1) from test_batch;
select sum(id2) from test_batch;
drop index ix_test_batch2 on test_batch;
truncate table test_batch purge;

--DTS2020031601743
truncate table test_data purge;
insert into test_data values(lpad('a', 3000, 'a'), 'aaaaa', 'aaaaa');
insert into test_data values(lpad('a', 3000, 'a'), 'aaaaa', 'aaaaa');
insert into test_data values(lpad('a', 1000, 'a'), 'aaaaa', 'aaaaa');

declare
  i int;
begin
  for i in 1..128 loop
    execute immediate 'insert into test_data values(''a'', null, null)';
  end loop;
end;
/

declare
  i int;
  j int;
begin
    for j in 1..16 loop
        for i in 1..16 loop
            execute immediate 'insert into test_data values(lpad(''a'', 128 * '||i||' , ''a''), null, null)';
        end loop;
    end loop;
end;
/

insert into test_batch select * from test_data;

truncate table test_batch purge;
--test foreign key for batch insert
drop table if exists test_batch_parent;
drop index ix_test_batch on test_batch;
create table test_batch_parent(id varchar(3000), constraint pk_batch_parent primary key(id));
alter table test_batch add constraint fk_batch foreign key(id1) references test_batch_parent(id);
insert into test_batch select * from test_data;
alter table test_batch drop constraint fk_batch;
drop table test_batch_parent purge;
drop table test_data purge;
drop table test_batch purge;

drop table if exists test_key_len_check;
create table test_key_len_check(a int, b varchar(6500));
alter system set ENABLE_IDX_KEY_LEN_CHECK = true;
create index idx_test_key_len_check on test_key_len_check(json_value(b, '$.aa'), json_value(b, '$.cc')) parallel 5;
alter system set ENABLE_IDX_KEY_LEN_CHECK = false;
create index idx_test_key_len_check on test_key_len_check(json_value(b, '$.aa'), json_value(b, '$.cc'));
insert into test_key_len_check values(1, json_object('aa' is lpad('bvfdf', 3000, 'bvfdf'), 'cc' is lpad('bvfdf', 1094, 'bvfdf') returning clob));
insert into test_key_len_check values(1, json_object('aa' is lpad('bvfdf', 3900, 'bvfdf'), 'cc' is lpad('bvfdf', 157, 'bvfdf') returning clob));
insert into test_key_len_check values(1, json_object('aa' is lpad('bvfdf', 3900, 'bvfdf'), 'cc' is lpad('bvfdf', 139, 'bvfdf') returning clob));
insert into test_key_len_check values(1, json_object('aa' is lpad('bvfdf', 3900, 'bvfdf'), 'cc' is lpad('bvfdf', 138, 'bvfdf') returning clob));
insert into test_key_len_check values(1, json_object('aa' is lpad('bvfdf', 3900, 'bvfdf'), 'cc' is lpad('bvfdf', 137, 'bvfdf') returning clob));
insert into test_key_len_check values(1, json_object('aa' is lpad('bvfdf', 100, 'bvfdf'), 'cc' is lpad('bvfdf', 100, 'bvfdf') returning clob));
select length(b) len from test_key_len_check order by len desc;
alter table test_key_len_check modify b varchar(7000);
explain select * from test_key_len_check where json_value(b, '$.aa') = 'dsd';
explain select * from test_key_len_check where json_value(b, '$.aa') = 'dsd' and json_value(b, '$.cc') ='dsds';
drop table test_key_len_check;
alter system set ENABLE_IDX_KEY_LEN_CHECK = true;
--test alter index rebuild keep storage;
drop table if exists test_delay_rebuild;
create table test_delay_rebuild (id int, num int) partition by range (id) 
(
partition p1 values less than (10),
partition p2 values less than (20),
partition p3 values less than (MAXVALUE)
);
create index idx_delay_rebuild on test_delay_rebuild (num) parallel 5;
create index idx_delay_local on test_delay_rebuild (id) local;
alter index idx_delay_rebuild on test_delay_rebuild rebuild keep storage;
alter index idx_delay_local on test_delay_rebuild rebuild partition p1 keep storage;
insert into test_delay_rebuild values (5, 10);
insert into test_delay_rebuild values (15, 10);
insert into test_delay_rebuild values (25, 10);
commit;
alter index idx_delay_rebuild on test_delay_rebuild rebuild keep storage;
alter index idx_delay_local on test_delay_rebuild rebuild partition p1 keep storage;
insert into test_delay_rebuild values (5, 10);
insert into test_delay_rebuild values (15, 10);
insert into test_delay_rebuild values (25, 10);
commit;
alter index idx_delay_rebuild on test_delay_rebuild rebuild keep storage online;
alter index idx_delay_local on test_delay_rebuild rebuild partition p1 keep storage online;
drop table if exists test_delay_rebuild;

--support parameter CBO_INDEX_CACHING CBO_INDEX_COST_ADJ
drop table if exists tbl_cbo_param;
create table tbl_cbo_param
(
	empno int,
	ename varchar(100),
	sal int
);
alter table tbl_cbo_param add constraint pk_tbl_cbo_param primary key(empno);
create index employees_index_001 on  tbl_cbo_param (ename); 
create index employees_index_002 on  tbl_cbo_param (sal); 
declare
	v_sql VARCHAR2(2000);
	v_i int;
	v_name VARCHAR2(100);
BEGIN
	for i in 1..1000 loop
	v_i:=i;
	v_name:=to_char(i);
	v_sql := 'insert into tbl_cbo_param values (:v1,:v2,:v3)';
	EXECUTE IMMEDIATE v_sql USING v_i,'name_'||v_name,1500;
	end loop;
commit;
END;
/
exec dbe_stats.collect_table_stats('sys','tbl_cbo_param',null,100);
--set cbo on to show COST
alter system set cbo = on;
explain select * from tbl_cbo_param where empno =10;
alter system set cbo_index_caching = 50;
explain select * from tbl_cbo_param where empno =10 ;
alter system set cbo_index_caching = 100;
explain select * from tbl_cbo_param where empno =10  ;
alter system set cbo_index_caching = 0;
explain select * from tbl_cbo_param where ename = 'name_50';
alter system set cbo_index_caching = 50;
explain select * from tbl_cbo_param where ename = 'name_50' ;
alter system set cbo_index_caching = 100;
explain select * from tbl_cbo_param where ename = 'name_50'  ;
alter system set cbo_index_caching = 0;
explain select distinct empno from tbl_cbo_param where sal=1000 or empno >500 order by empno;
alter system set cbo_index_caching = 50;
explain select distinct empno from tbl_cbo_param where sal=1000 or empno >500 order by empno ;
alter system set cbo_index_caching = 100;
explain select distinct empno from tbl_cbo_param where sal=1000 or empno >500 order by empno  ;
alter system set cbo_index_caching = 0;

explain select * from tbl_cbo_param where  empno =10;
alter system set cbo_index_cost_adj = 50;
explain select * from tbl_cbo_param where  empno =10 ;
alter system set cbo_index_cost_adj = 200;
explain select * from tbl_cbo_param where  empno =10  ;
alter system set cbo_index_cost_adj = 100;
explain select * from tbl_cbo_param where  ename = 'name_50';
alter system set cbo_index_cost_adj = 50;
explain select * from tbl_cbo_param where  ename = 'name_50' ;
alter system set cbo_index_cost_adj = 200;
explain select * from tbl_cbo_param where  ename = 'name_50'  ;
alter system set cbo_index_cost_adj = 100;
explain select distinct empno from tbl_cbo_param where sal=1000 or empno >500  order by empno;
alter system set cbo_index_cost_adj = 50;
explain select distinct empno from tbl_cbo_param where sal=1000 or empno >500  order by empno ;
alter system set cbo_index_cost_adj = 200;
explain select distinct empno from tbl_cbo_param where sal=1000 or empno >500  order by empno  ;
alter system set cbo_index_cost_adj = 100;
alter system set cbo = off;

--base table
drop table if exists aa;
create table aa(C_ID INT, C_PAYMENT_CNT_3 NUMBER(12,8), PRIMARY KEY (C_ID)) format csf;
create OR REPLACE PROCEDURE STORAGE_UPDATE_PARTITION_KEY_SIN_IND_PROC_000_1_1(STARTNUM INT,ENDALL INT) IS
I int :=1;
begin
  for I in STARTNUM..ENDALL loop
    INSERT INTO aa SELECT I, (I+0.12345678) FROM SYS_DUMMY;
  end loop;
end;
/
call STORAGE_UPDATE_PARTITION_KEY_SIN_IND_PROC_000_1_1(1,1);

--csf table
DROP TABLE IF EXISTS aa_csf;
CREATE TABLE aa_csf(C_ID INT, C_PAYMENT_CNT_3 NUMBER(12,8)) 
PARTITION BY LIST(C_PAYMENT_CNT_3)(PARTITION PART_1 VALUES (0,1),PARTITION PART_2 VALUES (2,3),PARTITION PART_3 VALUES (4,5),PARTITION PART_4 VALUES (6,7),PARTITION PART_5 VALUES (DEFAULT)) FORMAT CSF;
CREATE INDEX aa_csf_index ON aa_csf(C_PAYMENT_CNT_3) parallel 5;
insert into aa_csf values(0,0);
rollback;
INSERT INTO aa_csf SELECT * FROM aa;
UPDATE aa_csf SET C_PAYMENT_CNT_3=MOD(C_ID,1);
commit;
SELECT C_PAYMENT_CNT_3 from aa_csf;
DROP TABLE IF EXISTS aa_csf;
drop table if exists aa;

drop table if exists tb1;
create table tb1 ( i int, name varchar(4000));
insert into tb1 values (1, LPAD('A',976,'A'));
insert into tb1 values (1, 'C');
insert into tb1 values (1, 'D');
insert into tb1 values (1, 'E');
insert into tb1 values (1, 'F');
insert into tb1 values (1, 'G');
insert into tb1 values (1, 'H');
insert into tb1 values (1, 'I');
insert into tb1 values (1, 'J');
insert into tb1 values (1, 'K');
insert into tb1 values (1, 'L');
insert into tb1 values (1, 'M');
insert into tb1 values (1, 'N');
insert into tb1 values (1, 'O');
insert into tb1 values (1, 'P');
insert into tb1 values (1, 'Q');
insert into tb1 values (1, 'R');
insert into tb1 values (1, 'S');
insert into tb1 values (1, LPAD('T',974,'T'));
insert into tb1 values (1, LPAD('U',974,'U'));
insert into tb1 values (1, 'V');
insert into tb1 values (1, LPAD('W',3874,'W'));
commit;
drop index if exists idx_1 on tb1;
create index idx_1 on tb1(name) initrans 10;
alter index idx_1 on tb1 rebuild online ; 
drop table if exists tb1;

--index_part_space
create tablespace index_part_space datafile 'part_space_file' size 100M ;
create tablespace test_nologging datafile 'nologging_file' size 100M nologging;
create tablespace index_part_encrypt_space datafile 'part_encrypt_space' size 100M encryption;

drop table if exists index_part_table;
create table index_part_table (
    id int not null,
    name varchar(8000) not null)
partition by range (id)
 ( partition p1 values less than(1000) tablespace index_part_space,
   partition p2 values less than(MAXVALUE) tablespace index_part_space)
   tablespace index_part_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace test_nologging, partition p2 tablespace test_nologging);
create index part_table_index on index_part_table(id) local (partition p1 tablespace temp, partition p2 tablespace temp);
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace test_nologging);
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace temp);
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace undo);
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace index_part_space) tablespace test_nologging;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace index_part_space) tablespace temp;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace index_part_space) tablespace undo;
create index part_table_index on index_part_table(id) local (partition p1 tablespace test_nologging, partition p2 tablespace test_nologging) tablespace index_part_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace temp, partition p2 tablespace temp) tablespace index_part_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace undo, partition p2 tablespace undo) tablespace index_part_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace test_nologging) tablespace index_part_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace temp) tablespace index_part_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace undo) tablespace index_part_space;

drop table if exists index_part_table;
create table index_part_table (
    id int not null,
    name varchar(8000) not null)
partition by range (id)
 ( partition p1 values less than(1000) tablespace index_part_space,
   partition p2 values less than(MAXVALUE) tablespace index_part_space)
   tablespace index_part_space;
create index part_table_index on index_part_table(id);

drop table if exists index_part_table;
create table index_part_table (
    id int not null,
    name varchar(8000) not null)
partition by range (id)
 ( partition p1 values less than(1000) tablespace index_part_space,
   partition p2 values less than(MAXVALUE) tablespace index_part_space)
   tablespace index_part_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace index_part_space);

drop table if exists index_part_table;
create table index_part_table (
    id int not null,
    name varchar(8000) not null)
partition by range (id)
 ( partition p1 values less than(1000) tablespace index_part_space,
   partition p2 values less than(MAXVALUE) tablespace index_part_space)
   tablespace index_part_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace index_part_space) tablespace index_part_space;

drop table if exists index_part_table;
create table index_part_table (
    id int not null,
    name varchar(8000) not null)
partition by range (id)
 ( partition p1 values less than(1000) tablespace test_nologging,
   partition p2 values less than(MAXVALUE) tablespace test_nologging)
   tablespace test_nologging;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace index_part_space);
create index part_table_index on index_part_table(id) local (partition p1 tablespace temp, partition p2 tablespace temp);
create index part_table_index on index_part_table(id) local (partition p1 tablespace test_nologging, partition p2 tablespace index_part_space);
create index part_table_index on index_part_table(id) local (partition p1 tablespace test_nologging, partition p2 tablespace temp);
create index part_table_index on index_part_table(id) local (partition p1 tablespace test_nologging, partition p2 tablespace undo);
create index part_table_index on index_part_table(id) local (partition p1 tablespace test_nologging, partition p2 tablespace test_nologging) tablespace index_part_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace test_nologging, partition p2 tablespace test_nologging) tablespace temp;
create index part_table_index on index_part_table(id) local (partition p1 tablespace test_nologging, partition p2 tablespace test_nologging) tablespace undo;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace index_part_space) tablespace test_nologging;
create index part_table_index on index_part_table(id) local (partition p1 tablespace temp, partition p2 tablespace temp) tablespace test_nologging;
create index part_table_index on index_part_table(id) local (partition p1 tablespace undo, partition p2 tablespace undo) tablespace test_nologging;
create index part_table_index on index_part_table(id) local (partition p1 tablespace test_nologging, partition p2 tablespace index_part_space) tablespace test_nologging;
create index part_table_index on index_part_table(id) local (partition p1 tablespace test_nologging, partition p2 tablespace temp) tablespace test_nologging;
create index part_table_index on index_part_table(id) local (partition p1 tablespace test_nologging, partition p2 tablespace undo) tablespace test_nologging;

drop table if exists index_part_table;
create table index_part_table (
    id int not null,
    name varchar(8000) not null)
partition by range (id)
 ( partition p1 values less than(1000) tablespace test_nologging,
   partition p2 values less than(MAXVALUE) tablespace test_nologging)
   tablespace test_nologging;
create index part_table_index on index_part_table(id);

drop table if exists index_part_table;
create table index_part_table (
    id int not null,
    name varchar(8000) not null)
partition by range (id)
 ( partition p1 values less than(1000) tablespace test_nologging,
   partition p2 values less than(MAXVALUE) tablespace test_nologging)
   tablespace test_nologging;  
create index part_table_index on index_part_table(id) local (partition p1 tablespace test_nologging, partition p2 tablespace test_nologging);

drop table if exists index_part_table;
create table index_part_table (
    id int not null,
    name varchar(8000) not null)
partition by range (id)
 ( partition p1 values less than(1000) tablespace test_nologging,
   partition p2 values less than(MAXVALUE) tablespace test_nologging)
   tablespace test_nologging;
create index part_table_index on index_part_table(id) local (partition p1 tablespace test_nologging, partition p2 tablespace test_nologging) tablespace test_nologging;

drop table if exists index_part_table;
create table index_part_table (
    id int not null,
    name varchar(8000) not null)
tablespace index_part_space;
create index part_table_index on index_part_table(id) tablespace index_part_encrypt_space;
create index part_table_index on index_part_table(id) tablespace index_part_space;

drop table if exists index_part_table;
create table index_part_table (
    id int not null,
    name varchar(8000) not null)
partition by range (id)
 ( partition p1 values less than(1000) tablespace index_part_space,
   partition p2 values less than(MAXVALUE) tablespace index_part_space)
   tablespace index_part_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace index_part_space) tablespace index_part_encrypt_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace index_part_encrypt_space) tablespace index_part_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace index_part_space) tablespace index_part_space;

drop table if exists index_part_table;
create table index_part_table (
    id int not null,
    name varchar(8000) not null)
partition by range (id)
 ( partition p1 values less than(1000) tablespace index_part_space,
   partition p2 values less than(MAXVALUE) tablespace index_part_encrypt_space)
   tablespace index_part_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace index_part_space) tablespace index_part_encrypt_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace index_part_space) tablespace index_part_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace index_part_encrypt_space) tablespace index_part_space;

drop table if exists index_part_table;
create table index_part_table (
    id int not null,
    name varchar(8000) not null)
partition by range (id)
 ( partition p1 values less than(1000) tablespace index_part_encrypt_space,
   partition p2 values less than(MAXVALUE) tablespace index_part_encrypt_space)
   tablespace index_part_encrypt_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace index_part_encrypt_space) tablespace index_part_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_space, partition p2 tablespace index_part_space) tablespace index_part_encrypt_space;
create index part_table_index on index_part_table(id) local (partition p1 tablespace index_part_encrypt_space, partition p2 tablespace index_part_encrypt_space) tablespace index_part_space;

drop table if exists index_part_table;
drop tablespace test_nologging including contents and datafiles;
drop tablespace index_part_space including contents and datafiles;
drop tablespace index_part_encrypt_space including contents and datafiles;

DROP TABLE IF EXISTS RQG_TABLE;
CREATE TABLE  RQG_TABLE
(
    UNIQUE BINARY_INTEGER DEFAULT -1000 NULL, 
    COMMENT NCHAR(4000), 
    C1 VARCHAR(2000),
    C2 VARCHAR(2000)
);
CREATE UNIQUE INDEX IDX_RQG_TABLE ON RQG_TABLE(COMMENT);
INSERT INTO RQG_TABLE VALUES(-1054212096,'kgytukmbxouhxgqg','kgytukmbxouhxgqgk','ymkgytukmbxouhx');
INSERT INTO RQG_TABLE(C1,C2) VALUES('dymkgytukmbxouhxgqgkbfipljifwtab','dymkgytukmbxouhx');
INSERT INTO RQG_TABLE SELECT * FROM RQG_TABLE;
DROP TABLE IF EXISTS RQG_TABLE;

---- SINGLE PARTTITON UNSABLE
drop user if exists hzy_unuasble cascade;
create user hzy_unuasble identified by Cantian_234;
drop table hzy_unuasble.test_usindx1;
create table hzy_unuasble.test_usindx1(
c_id int,
c_d_id int NOT NULL,
c_w_id int NOT NULL,
c_first varchar(50) NOT NULL,
c_middle char(2),
c_last varchar(16) NOT NULL,
c_street_1 varchar(20) NOT NULL,
c_street_2 varchar(20),
c_city varchar(20) NOT NULL,
c_state char(2) NOT NULL,
c_zip char(9) NOT NULL,
c_phone char(16) NOT NULL,
c_since timestamp,
c_credit char(2) NOT NULL,
c_credit_lim numeric(12,2),
c_discount numeric(4,4),
c_balance numeric(12,2),
c_ytd_payment real NOT NULL,
c_payment_cnt number NOT NULL,
c_delivery_cnt bool NOT NULL,
c_end date NOT NULL,
c_data varchar(1000),
c_clob clob,
c_text blob) 
partition by range(c_id) 
(
   partition PART_1 values less than (10),
   partition PART_2 values less than (20),
   partition PART_3 values less than (30),
   partition PART_4 values less than (40),
   partition PART_5 values less than (50),
   partition PART_6 values less than (60),
   partition PART_7 values less than (70),
   partition PART_8 values less than (80),
   partition PART_9 values less than (maxvalue)
);

CREATE INDEX hzy_unuasble.usidx1 ON hzy_unuasble.test_usindx1(c_id);
CREATE INDEX hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1(c_d_id) local;
CREATE INDEX hzy_unuasble.usidx3 ON hzy_unuasble.test_usindx1(c_w_id, c_last) local;

alter index hzy_unuasble.usidx1 ON hzy_unuasble.test_usindx1 modify partition PART_1 unusable;
alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 modify partition PART_1,PART_2 unusable;
alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 modify partition PART_111 unusable;

CREATE or replace procedure hzy_unuasble.lob_hzy_proc_1115(startnum int,endall int) is
i INT :=1;
j varchar(10);
BEGIN
  FOR i IN startnum..endall LOOP
    select cast(i as varchar(10)) into j from dual;
    insert into  hzy_unuasble.test_usindx1 select i,i,i,'is'||j||'cmRDs'||j,'OE','BAR'||j||'Bar'||j,'bkili'||j||'fcrRGF'||j,'pmbwo'||j||'vhSDGj'||j,'dyf'||j||'rDa'||j,'uq',4801||j,940||j||215||j,'2011-12-11 00:00:00','GC',50000.0,0.4361328,-10.0,10.0,1,true,'2011-12-11 00:00:00','dasd'||j,'dasdsd'||j,'\x1234354587643123455213445656723123424554566776763221132454566768767433242323445453565654542323';
  END LOOP;
END;
/

call hzy_unuasble.lob_hzy_proc_1115(1,100);
commit;
insert into hzy_unuasble.test_usindx1 select * from hzy_unuasble.test_usindx1;
insert into hzy_unuasble.test_usindx1 select * from hzy_unuasble.test_usindx1;
commit;
select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' AND SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by part#;
alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 modify partition PART_1 unusable;

select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' AND SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by part#;
call hzy_unuasble.lob_hzy_proc_1115(1,100);
commit;
select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' AND SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by part#;
update hzy_unuasble.test_usindx1 set c_d_id = 10;
delete from hzy_unuasble.test_usindx1;

--- UNIQUE INDEX UNUSABLE
purge recyclebin;
drop table hzy_unuasble.test_usindx1;
create table hzy_unuasble.test_usindx1(
c_id int,
c_d_id int NOT NULL,
c_w_id int NOT NULL,
c_first varchar(50) NOT NULL,
c_middle char(2),
c_last varchar(16) NOT NULL,
c_street_1 varchar(20) NOT NULL,
c_street_2 varchar(20),
c_city varchar(20) NOT NULL,
c_state char(2) NOT NULL,
c_zip char(9) NOT NULL,
c_phone char(16) NOT NULL,
c_since timestamp,
c_credit char(2) NOT NULL,
c_credit_lim numeric(12,2),
c_discount numeric(4,4),
c_balance numeric(12,2),
c_ytd_payment real NOT NULL,
c_payment_cnt number NOT NULL,
c_delivery_cnt bool NOT NULL,
c_end date NOT NULL,
c_data varchar(1000),
c_clob clob,
c_text blob) 
partition by range(c_id) 
(
   partition PART_1 values less than (10),
   partition PART_2 values less than (20),
   partition PART_3 values less than (30),
   partition PART_4 values less than (40),
   partition PART_5 values less than (50),
   partition PART_6 values less than (60),
   partition PART_7 values less than (70),
   partition PART_8 values less than (80),
   partition PART_9 values less than (maxvalue)
);

CREATE unique INDEX hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1(c_id) local;

call hzy_unuasble.lob_hzy_proc_1115(1,100);
commit;

select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' AND SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by part#;

alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 modify partition PART_1 unusable;

select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' AND SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by part#;

truncate table hzy_unuasble.test_usindx1;
call hzy_unuasble.lob_hzy_proc_1115(1,100);
commit;

select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' AND SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by part#;

--- PARENT PART INDEX UNUSABLE ERROR
purge recyclebin;
drop table hzy_unuasble.test_usindx1;
create table hzy_unuasble.test_usindx1(
c_id int,
c_d_id int NOT NULL,
c_w_id int NOT NULL,
c_first varchar(50) NOT NULL,
c_middle char(2),
c_last varchar(16) NOT NULL,
c_street_1 varchar(20) NOT NULL,
c_street_2 varchar(20),
c_city varchar(20) NOT NULL,
c_state char(2) NOT NULL,
c_zip char(9) NOT NULL,
c_phone char(16) NOT NULL,
c_since timestamp,
c_credit char(2) NOT NULL,
c_credit_lim numeric(12,2),
c_discount numeric(4,4),
c_balance numeric(12,2),
c_ytd_payment real NOT NULL,
c_payment_cnt number NOT NULL,
c_delivery_cnt bool NOT NULL,
c_end date NOT NULL,
c_data varchar(1000),
c_clob clob,
c_text blob) 
partition by range(c_id) subpartition by range(c_w_id)
(
   partition PART_1 values less than (10)
   (
     subpartition p11 values less than(20),
     subpartition p12 values less than(maxvalue)
   ),
   partition PART_2 values less than (50)
   (
     subpartition p21 values less than(20),
     subpartition p22 values less than(maxvalue)
   ),
   partition PART_3 values less than (maxvalue)
   (
     subpartition p31 values less than(50),
     subpartition p32 values less than(maxvalue)
   )
);

CREATE INDEX hzy_unuasble.usidx1 ON hzy_unuasble.test_usindx1(c_id);
CREATE INDEX hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1(c_d_id) local;
CREATE INDEX hzy_unuasble.usidx3 ON hzy_unuasble.test_usindx1(c_w_id, c_last) local;

alter index hzy_unuasble.usidx1 ON hzy_unuasble.test_usindx1 modify partition PART_11 unusable;
alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 modify partition PART_11,PART_21 unusable;
alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 modify partition PART_311 unusable;

call hzy_unuasble.lob_hzy_proc_1115(1,100);
commit;

insert into hzy_unuasble.test_usindx1 select * from hzy_unuasble.test_usindx1;
insert into hzy_unuasble.test_usindx1 select * from hzy_unuasble.test_usindx1;
commit;
select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' and SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by part#;

alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 modify partition PART_1 unusable;

select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' AND SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by 1,2;
select a.SUBpart#,a.FLAGS from sys.sys_sub_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index# 
order by a.SUBpart#,a.flags;

call hzy_unuasble.lob_hzy_proc_1115(1,100);
commit;

select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' AND SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by 1,2;
select a.SUBpart#,a.FLAGS from sys.sys_sub_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index# 
order by a.SUBpart#,a.flags;

--- PARENT PART INDEX UNUSABLE
purge recyclebin;
drop table hzy_unuasble.test_usindx1;
create table hzy_unuasble.test_usindx1(
c_id int,
c_d_id int NOT NULL,
c_w_id int NOT NULL,
c_first varchar(50) NOT NULL,
c_middle char(2),
c_last varchar(16) NOT NULL,
c_street_1 varchar(20) NOT NULL,
c_street_2 varchar(20),
c_city varchar(20) NOT NULL,
c_state char(2) NOT NULL,
c_zip char(9) NOT NULL,
c_phone char(16) NOT NULL,
c_since timestamp,
c_credit char(2) NOT NULL,
c_credit_lim numeric(12,2),
c_discount numeric(4,4),
c_balance numeric(12,2),
c_ytd_payment real NOT NULL,
c_payment_cnt number NOT NULL,
c_delivery_cnt bool NOT NULL,
c_end date NOT NULL,
c_data varchar(1000),
c_clob clob,
c_text blob) 
partition by range(c_id) subpartition by range(c_w_id)
(
   partition PART_1 values less than (10)
   (
     subpartition p11 values less than(20),
     subpartition p12 values less than(maxvalue)
   ),
   partition PART_2 values less than (50)
   (
     subpartition p21 values less than(20),
     subpartition p22 values less than(maxvalue)
   ),
   partition PART_3 values less than (maxvalue)
   (
     subpartition p31 values less than(50),
     subpartition p32 values less than(maxvalue)
   )
);
CREATE INDEX hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1(c_d_id) local;
call hzy_unuasble.lob_hzy_proc_1115(1,100);
commit;

insert into hzy_unuasble.test_usindx1 select * from hzy_unuasble.test_usindx1;
insert into hzy_unuasble.test_usindx1 select * from hzy_unuasble.test_usindx1;
commit;
select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' and SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by part#;

alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 modify partition p11 unusable;
alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 modify subpartition p11 unusable;

select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' AND SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by 1,2;
select a.SUBpart#,a.FLAGS from sys.sys_sub_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by 1,2;

call hzy_unuasble.lob_hzy_proc_1115(1,100);
commit;

select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' AND SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by 1,2;
select a.SUBpart#,a.FLAGS from sys.sys_sub_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by 1,2;
update hzy_unuasble.test_usindx1 set c_d_id = 10;
delete from hzy_unuasble.test_usindx1;
commit;
alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 rebuild;
alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 unusable;
select PARTITION_NAME, status from adm_ind_partitions where INDEX_OWNER = 'HZY_UNUASBLE' and INDEX_NAME = 'USIDX2' order by PARTITION_NAME;
select PARTITION_NAME, status from adm_ind_subpartitions where INDEX_OWNER = 'HZY_UNUASBLE' and INDEX_NAME = 'USIDX2' order by PARTITION_NAME;
select INDEX_NAME, status from adm_indexes where owner = 'HZY_UNUASBLE' and INDEX_NAME = 'USIDX2';
alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 rebuild partition PART_1;
alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 rebuild partition PART_2;
alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 rebuild subpartition p31;
alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 rebuild subpartition p32;
select PARTITION_NAME, status from adm_ind_partitions where INDEX_OWNER = 'HZY_UNUASBLE' and INDEX_NAME = 'USIDX2' order by PARTITION_NAME;
select PARTITION_NAME, status from adm_ind_subpartitions where INDEX_OWNER = 'HZY_UNUASBLE' and INDEX_NAME = 'USIDX2' order by PARTITION_NAME;
select INDEX_NAME, status from adm_indexes where owner = 'HZY_UNUASBLE' and INDEX_NAME = 'USIDX2';

--- SUB PART UNIQUE INDEX UNUSABLE 
purge recyclebin;
drop table hzy_unuasble.test_usindx1;
create table hzy_unuasble.test_usindx1(
c_id int,
c_d_id int NOT NULL,
c_w_id int NOT NULL,
c_first varchar(50) NOT NULL,
c_middle char(2),
c_last varchar(16) NOT NULL,
c_street_1 varchar(20) NOT NULL,
c_street_2 varchar(20),
c_city varchar(20) NOT NULL,
c_state char(2) NOT NULL,
c_zip char(9) NOT NULL,
c_phone char(16) NOT NULL,
c_since timestamp,
c_credit char(2) NOT NULL,
c_credit_lim numeric(12,2),
c_discount numeric(4,4),
c_balance numeric(12,2),
c_ytd_payment real NOT NULL,
c_payment_cnt number NOT NULL,
c_delivery_cnt bool NOT NULL,
c_end date NOT NULL,
c_data varchar(1000),
c_clob clob,
c_text blob) 
partition by range(c_id) subpartition by range(c_w_id)
(
   partition PART_1 values less than (10)
   (
     subpartition p11 values less than(20),
     subpartition p12 values less than(maxvalue)
   ),
   partition PART_2 values less than (50)
   (
     subpartition p21 values less than(20),
     subpartition p22 values less than(maxvalue)
   ),
   partition PART_3 values less than (maxvalue)
   (
     subpartition p31 values less than(50),
     subpartition p32 values less than(maxvalue)
   )
);

CREATE unique INDEX hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1(c_id,c_w_id) local;
call hzy_unuasble.lob_hzy_proc_1115(1,100);
commit;

select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' AND SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by part#;
alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 modify partition PART_1 unusable;

select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' AND SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.SUBpart#,a.FLAGS from sys.sys_sub_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by 1,2;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by 1,2;
call hzy_unuasble.lob_hzy_proc_1115(1,10);
alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 rebuild partition PART_1;
select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' AND SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.SUBpart#,a.FLAGS from sys.sys_sub_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by 1,2;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by 1,2;
alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 unusable;
select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' AND SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.SUBpart#,a.FLAGS from sys.sys_sub_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by 1,2;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by 1,2;
update hzy_unuasble.test_usindx1 set c_id = 10;
delete from hzy_unuasble.test_usindx1;
commit;

alter index hzy_unuasble.usidx2 ON hzy_unuasble.test_usindx1 rebuild;
select segment_name,PARTITION_NAME,bytes,pages from adm_segments where owner = 'HZY_UNUASBLE' and SEGMENT_TYPE = 'INDEX' AND SEGMENT_NAME like '%USIDX%' order by segment_name,PARTITION_NAME;
select a.SUBpart#,a.FLAGS from sys.sys_sub_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by 1,2;
select a.part#,a.FLAGS from sys.sys_index_parts a , sys.sys_indexes b ,sys.sys_tables c where c.name = 'TEST_USINDX1' and c.id = b.table# and c.user# = b.user# and b.name = 'USIDX2' and a.table# = c.id and b.id = a.index#  order by 1,2;
call hzy_unuasble.lob_hzy_proc_1115(1,10);
update hzy_unuasble.test_usindx1 set c_id = 10;
delete from hzy_unuasble.test_usindx1;
commit;

drop table if exists test1;
create table test1(f1 varchar2(4000 char));
create index idx_test1 on test1(f1);
insert into test1 values(lpad('中国',2000,'中国'));
select * from test1 where f1 = lpad('中国',2000,'中国');
drop table if exists test2;
create table test2(f1 varchar2(2000 char), f2 varchar2(2000 char));
create index idx_test2 on test2(f1, f2);
insert into test2 values(lpad('中国',1000,'中国'), lpad('中国',1000,'中国'));
select * from test2 where f1 = lpad('中国',1000,'中国') and f2 = lpad('中国',1000,'中国');
drop table test1;
drop table test2;
drop PROCEDURE hzy_unuasble.LOB_HZY_PROC_1115;
drop user hzy_unuasble cascade;
drop table if exists test_time;
CREATE TABLE test_time (time  TIMESTAMP(6) WITH TIME ZONE);
create index idx_time on test_time(time);
insert into test_time values ('2020-01-01 08:00:00.00000 +01:00');
commit;
update test_time set time = '2020-01-01 09:00:00.00000 +02:00';
select * from test_time;
update test_time set time = '2020-01-01 08:00:00.00000 +01:00'; 
select * from test_time;
truncate table test_time;
drop index idx_time on test_time;
create index idx_time on test_time(time) crmode row;
insert into test_time values ('2020-01-01 08:00:00.00000 +01:00');
commit;
update test_time set time = '2020-01-01 09:00:00.00000 +02:00';
select * from test_time;
update test_time set time = '2020-01-01 08:00:00.00000 +01:00'; 
select * from test_time;
drop table test_time;
create global temporary table test_time (time  TIMESTAMP(6) WITH TIME ZONE) on commit PRESERVE rows;
create index idx_time on test_time(time);
insert into test_time values ('2020-01-01 08:00:00.00000 +01:00');
commit;
update test_time set time = '2020-01-01 09:00:00.00000 +02:00';
select * from test_time;
update test_time set time = '2020-01-01 08:00:00.00000 +01:00'; 
select * from test_time;
drop table test_time;

--DTS202104260DGXB4P1I00
drop table IF EXISTS TEST_DUPLICATE_127;

CREATE TABLE "TEST_DUPLICATE_127"
(
 "ID" BINARY_DOUBLE NOT NULL,
 "GRADE" BINARY_DOUBLE
);

create unique index idx_DUPLICATE_127 on "TEST_DUPLICATE_127"(id);
INSERT INTO "TEST_DUPLICATE_127" ("ID","GRADE") values (0.1234567891,null);
INSERT INTO "TEST_DUPLICATE_127" ("ID","GRADE") values (0.12345678912,null);
INSERT INTO "TEST_DUPLICATE_127" ("ID","GRADE") values (0.1234567891236,null);
COMMIT;
truncate table "TEST_DUPLICATE_127";
drop index idx_DUPLICATE_127 on "TEST_DUPLICATE_127";
create index idx_DUPLICATE_127 on "TEST_DUPLICATE_127"(id);
INSERT INTO "TEST_DUPLICATE_127" ("ID","GRADE") values (1000000000000005994, 1);
update "TEST_DUPLICATE_127" set id = 1000000000000006903 where id = 1000000000000005994;
update "TEST_DUPLICATE_127" set id = 1000000000000006740 where id = 1000000000000006903;
update "TEST_DUPLICATE_127" set id = 1000000000000005617 where id = 1000000000000006740;
rollback;
drop table TEST_DUPLICATE_127;
--20210525
drop table if exists temp001;
create table temp001(f1 int, f2 int, f3 varchar(1000));
insert into temp001 values(1,1,'sdsdsf'),(2,2,'sdsafdg');
commit;
create index temp001_idx on temp001(f1);
create index temp001_idx2 on temp001(f2);
explain select /*+rule*/ * from (select null a, f2 b from temp001 union all select f1 a, null b from temp001) where a = 1 or b = 2;
explain select /*+rule*/ * from (select null a, f2 b, f3 c from temp001 union all select f1 a, null b, f3 c from temp001) where (a = 1 or b = 2 ) and c is not null;
explain select /*+rule*/ * from (select null a, f2 b, f3 c from temp001) where (a = 1 or b = 2 ) and c is not null;
explain select * from (select /*+rule*/ null a, f2 b, f3 c from temp001 ,sys_dummy) where (a = 1 or b = 2 ) and c is not null;
explain select * from (select null a, f2 b, f3 c from temp001 ,sys_dummy) where (a = 1 or b = 2 ) and c is not null;
drop table temp001;
alter system set ENABLE_IDX_KEY_LEN_CHECK = FALSE;
drop table if exists large_key;
CREATE TABLE large_key(c1 INTEGER, c2 VARCHAR(4100), c3 INTEGER, c4 char(100)) partition by range (c1) (partition p1 values less than (10), partition p2 values less than (20), partition p3 values less than  (maxvalue)) ;
insert into large_key values (1, LPAD('1', 4058, '1'), 2, '1');
insert into large_key values (1, LPAD('1', 4058, '1'), 2, '1');
insert into large_key values (1, LPAD('1', 4058, '1'), 2, '1');
insert into large_key values (1, LPAD('1', 4058, '1'), 2, '1');
CREATE INDEXcluster (INDEX ix_large_key ON large_key( c2, c3) parallel 5 local, INDEX ix_large_key_1 ON large_key(c2) parallel 5 local, INDEX ix_large_key_2 ON large_key(c1, c2, c3) parallel 5  local);
drop table if exists large_key;
alter system set ENABLE_IDX_KEY_LEN_CHECK = TRUE;