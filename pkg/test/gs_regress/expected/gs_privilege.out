

SQL> conn / as sysdba

connected.

SQL> drop user if exists user1 cascade;

Succeed.

SQL> create user USER1 identified by Root1234;

Succeed.

SQL> grant connect to USER1;

Succeed.

SQL> SELECT USER_ID FROM ADM_USERS where username = 'SYS';

USER_ID
------------
0

1 rows fetched.

SQL> ALTER SESSION SET CURRENT_SCHEMA=USER1;

Succeed.

SQL> SELECT USERNAME FROM ADM_USERS where username = 'SYS';

USERNAME
----------------------------------------------------------------
SYS

1 rows fetched.

SQL> conn USER1/Root1234@127.0.0.1:1611

connected.

SQL> SELECT USER_ID FROM ADM_USERS where username = 'SYS';

CT-01001, Permissions were insufficient
SQL> SELECT USERNAME FROM ADM_USERS where username = 'SYS';

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop user if exists user1 cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists u_tc_security_trigger_001 cascade;

Succeed.

SQL> drop user if exists u_dba cascade;

Succeed.

SQL> drop table if exists t1;

Succeed.

SQL> drop function if exists get_spacename_by_id;

Succeed.

SQL> create table t1(id int);

Succeed.

SQL> create user u_tc_security_trigger_001 identified by Changeme123;

Succeed.

SQL> grant create session,create table,create trigger,CREATE SYNONYM,CREATE PUBLIC SYNONYM to u_tc_security_trigger_001;

Succeed.

SQL> create user u_dba identified by Changeme123;

Succeed.

SQL> grant create session,create table,create trigger,CREATE SYNONYM,CREATE PUBLIC SYNONYM  to u_dba;

Succeed.

SQL> create table u_dba.t1(id int);

Succeed.

SQL> grant all on sys.t1 to u_tc_security_trigger_001;

Succeed.

SQL> conn u_tc_security_trigger_001/Changeme123@127.0.0.1:1611

connected.

SQL> drop table if exists t1;

Succeed.

SQL> drop table if exists t2;

Succeed.

SQL> create table t1(id int);

Succeed.

SQL> create table t2(id int);

Succeed.

SQL> insert into t1 values(1),(2),(3),(4);

4 rows affected.

SQL> commit;

Succeed.

SQL> drop SYNONYm if exists dba_s1 ;

Succeed.

SQL> drop SYNONYm if exists dba_s2 ;

Succeed.

SQL> drop SYNONYm if exists sys_s1 ;

Succeed.

SQL> drop SYNONYm if exists sys_s2 ;

Succeed.

SQL> CREATE OR REPLACE SYNONYM dba_s1 for u_dba.t1;

Succeed.

SQL> CREATE OR REPLACE SYNONYM dba_s2 for u_dba.t2;

CT-01001, Permissions were insufficient
SQL> CREATE OR REPLACE SYNONYM sys_s1 for sys.t1;

Succeed.

SQL> CREATE OR REPLACE SYNONYM sys_s2 for sys.t2;

CT-01001, Permissions were insufficient
SQL> create or replace trigger trig2 before delete or update or insert on sys_s1
  2 begin
  3     dbe_output.print_line('trigger done');
  4 end;
  5 /

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> grant create any trigger to u_tc_security_trigger_001;

Succeed.

SQL> conn u_tc_security_trigger_001/Changeme123@127.0.0.1:1611

connected.

SQL> create or replace trigger trig2 before delete or update or insert on sys_s1
  2 begin
  3     dbe_output.print_line('trigger done');
  4 end;
  5 /

CT-00601, Sql syntax error: cannot create triggers on objects owned by sys
SQL> insert into  sys.t1 values(10);

1 rows affected.

SQL> commit;

Succeed.

SQL> select * from sys.t1;

ID
------------
10

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> insert into  sys.t1 values(10);

1 rows affected.

SQL> commit;

Succeed.

SQL> select * from sys.t1;

ID
------------
10
10

2 rows fetched.

SQL> conn / as sysdba

connected.

SQL> drop user if exists u_tc_security_trigger_001 cascade;

Succeed.

SQL> drop user if exists u_dba cascade;

Succeed.

SQL> drop table if exists t1;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists regress_z1 cascade;

Succeed.

SQL> create user regress_z1 identified by Cantian_234;

Succeed.

SQL> grant dba to regress_z1;

Succeed.

SQL> drop user if exists regress_z2 cascade;

Succeed.

SQL> create user regress_z2 identified by Cantian_234;

Succeed.

SQL> grant dba to regress_z2;

Succeed.

SQL> conn regress_z1/Cantian_234@127.0.0.1:1611

connected.

SQL> create or replace package pk_z1
  2 is
  3 function aaa_f1 return int;
  4 procedure   aaa_p1;
  5 end;
  6 /

Succeed.

SQL> create or replace package body pk_z1
  2 is
  3 function aaa_f1 return int
  4 is
  5         V1 int:=10 ;
  6                 begin
  7                         null;
  8                         return V1;
  9                 end;
 10
 11  procedure aaa_p1
 12  is
 13  V1 int:=9;
 14         begin
 15                 select count(1) into V1 from dual;
 16                  dbe_output.print_line(V1);
 17         end;
 18 end;
 19 /

Succeed.

SQL> drop package if exists pk_z1;

Succeed.

SQL> create or replace package pk_z1
  2 is
  3 function aaa_f1 return int;
  4 procedure   aaa_p1;
  5 end;
  6 /

Succeed.

SQL> create or replace package body pk_z1
  2 is
  3 function aaa_f1 return int
  4 is
  5  V1 int:=10 ;
  6  begin
  7  null;
  8 return V1;
  9 end;
 10 procedure aaa_p1
 11  is
 12  V1 int:=9;
 13  begin
 14  select count(1) into V1 from dual;
 15  dbe_output.print_line(V1);
 16 end;
 17 end;
 18 /

Succeed.

SQL> conn regress_z2/Cantian_234@127.0.0.1:1611

connected.

SQL> create or replace package pk_z1
  2 is
  3 function aaa_f1 return int;
  4 procedure   aaa_p1;
  5 end;
  6 /

Succeed.

SQL> create or replace package body pk_z1
  2 is
  3 function aaa_f1 return int
  4 is
  5         V1 int:=10 ;
  6                 begin
  7                         null;
  8                         return V1;
  9                 end;
 10
 11  procedure aaa_p1
 12  is
 13  V1 int:=9;
 14         begin
 15                 select count(1) into V1 from dual;
 16                  dbe_output.print_line(V1);
 17         end;
 18 end;
 19 /

Succeed.

SQL> conn regress_z1/Cantian_234@127.0.0.1:1611

connected.

SQL> SELECT OWNER, OBJECT_NAME, PACKAGE_NAME FROM DB_ARGUMENTS K WHERE K.IN_OUT = 'OUT' AND K.DATA_LEVEL = 0 and OBJECT_NAME = 'AAA_F1' order by owner;

OWNER                                                            OBJECT_NAME                                                      PACKAGE_NAME
---------------------------------------------------------------- ---------------------------------------------------------------- ----------------------------------------------------------------
REGRESS_Z1                                                       AAA_F1                                                           PK_Z1
REGRESS_Z2                                                       AAA_F1                                                           PK_Z1

2 rows fetched.

SQL> conn / as sysdba

connected.

SQL> drop user if exists regress_z1 cascade;

Succeed.

SQL> drop user if exists regress_z2 cascade;

Succeed.

SQL> --TRIGGER
SQL> conn / as sysdba

connected.

SQL> drop user if exists c##testuser cascade;

Succeed.

SQL> create user c##testuser identified by Cantian_234;

Succeed.

SQL> grant connect, create any trigger to c##testuser;

Succeed.

SQL> grant execute on DBE_DIAGNOSE to c##testuser;

Succeed.

SQL> drop user if exists c##testuser_good cascade;

Succeed.

SQL> create user C##TESTUSER_GOOD identified by Cantian_234;

Succeed.

SQL> grant connect, create table , create trigger to c##testuser_good;

Succeed.

SQL> conn c##testuser_good/Cantian_234@127.0.0.1:1611

connected.

SQL> drop table if exists t_enable_triggers;

Succeed.

SQL> create table t_enable_triggers(f1 int, f2 int);

Succeed.

SQL> CREATE OR REPLACE TRIGGER TRIG_ENABLE_TRIGGERS1 BEFORE INSERT OR UPDATE OR DELETE ON t_enable_triggers
  2 BEGIN
  3 dbe_output.print_line('BEFORE t_enable_triggers');
  4 END;
  5 /

Succeed.

SQL> conn c##testuser/Cantian_234@127.0.0.1:1611

connected.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'TRIG_ENABLE_TRIGGERS1', 'T');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'T
----------------------------------------------------------------
TRUE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'TRIG_ENABLE_TRIGGERS1', 'TRIGGER');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'T
----------------------------------------------------------------
TRUE

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> revoke create any trigger from c##testuser;

Succeed.

SQL> conn c##testuser/Cantian_234@127.0.0.1:1611

connected.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'TRIG_ENABLE_TRIGGERS1', 'T');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'T
----------------------------------------------------------------
FALSE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'TRIG_ENABLE_TRIGGERS1', 'TRIGGER');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'T
----------------------------------------------------------------
FALSE

1 rows fetched.

SQL> --PROCEDURE
SQL> conn / as sysdba

connected.

SQL> drop user if exists c##testuser cascade;

Succeed.

SQL> create user c##testuser identified by Cantian_234;

Succeed.

SQL> grant connect, execute any procedure to c##testuser;

Succeed.

SQL> grant execute on DBE_DIAGNOSE to c##testuser;

Succeed.

SQL> drop user if exists c##testuser_good cascade;

Succeed.

SQL> create user C##TESTUSER_GOOD identified by Cantian_234;

Succeed.

SQL> grant connect, create table , create PROCEDURE to c##testuser_good;

Succeed.

SQL> conn c##testuser_good/Cantian_234@127.0.0.1:1611

connected.

SQL> CREATE OR REPLACE PROCEDURE PLSQL_Zenith_Test_004(param1 out varchar2)
  2 IS
  3     tmp varchar2(20) :='12345678';
  4 Begin
  5     dbe_output.print_line('OUT PUT RESULT:'||param1);
  6 end PLSQL_ZENITH_TEST_004;
  7 /

Succeed.

SQL> conn c##testuser/Cantian_234@127.0.0.1:1611

connected.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'P');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
TRUE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'PROCEDURE');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
TRUE

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> revoke execute any procedure from c##testuser;

Succeed.

SQL> conn c##testuser/Cantian_234@127.0.0.1:1611

connected.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'P');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
FALSE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'PROCEDURE');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
FALSE

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> grant execute on C##TESTUSER_GOOD.PLSQL_ZENITH_TEST_004 to c##testuser;

Succeed.

SQL> conn c##testuser/Cantian_234@127.0.0.1:1611

connected.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'P');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
TRUE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'PROCEDURE');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
TRUE

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> revoke execute on C##TESTUSER_GOOD.PLSQL_ZENITH_TEST_004 from c##testuser;

Succeed.

SQL> conn c##testuser/Cantian_234@127.0.0.1:1611

connected.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'P');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
FALSE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'PROCEDURE');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
FALSE

1 rows fetched.

SQL> --FUNCTION
SQL> conn / as sysdba

connected.

SQL> drop user if exists c##testuser cascade;

Succeed.

SQL> create user c##testuser identified by Cantian_234;

Succeed.

SQL> grant connect, execute any procedure to c##testuser;

Succeed.

SQL> grant execute on DBE_DIAGNOSE to c##testuser;

Succeed.

SQL> drop user if exists c##testuser_good cascade;

Succeed.

SQL> create user C##TESTUSER_GOOD identified by Cantian_234;

Succeed.

SQL> grant connect, create table , create PROCEDURE to c##testuser_good;

Succeed.

SQL> conn c##testuser_good/Cantian_234@127.0.0.1:1611

connected.

SQL>
SQL> CREATE OR REPLACE FUNCTION PLSQL_ZENITH_TEST_004 return varchar2
  2 IS
  3  cunt int := 0;
  4  Begin
  5  select count(*) into cunt from dual;
  6  dbe_output.print_line(cunt);
  7  IF SQL % FOUND
  8   then
  9  return cunt;
 10  end if;
 11  End PLSQL_ZENITH_TEST_004;
 12 /

Succeed.

SQL> conn c##testuser/Cantian_234@127.0.0.1:1611

connected.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'F');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
TRUE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'FUNCTION');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
TRUE

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> revoke execute any procedure from c##testuser;

Succeed.

SQL> conn c##testuser/Cantian_234@127.0.0.1:1611

connected.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'F');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
FALSE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'FUNCTION');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
FALSE

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> grant execute on C##TESTUSER_GOOD.PLSQL_ZENITH_TEST_004 to c##testuser;

Succeed.

SQL> conn c##testuser/Cantian_234@127.0.0.1:1611

connected.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'F');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
TRUE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'FUNCTION');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
TRUE

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> revoke execute on C##TESTUSER_GOOD.PLSQL_ZENITH_TEST_004 from c##testuser;

Succeed.

SQL> conn c##testuser/Cantian_234@127.0.0.1:1611

connected.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'F');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
FALSE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'FUNCTION');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
FALSE

1 rows fetched.

SQL> --TYPE
SQL> conn / as sysdba

connected.

SQL> drop user if exists c##testuser cascade;

Succeed.

SQL> create user c##testuser identified by Cantian_234;

Succeed.

SQL> grant connect, execute any type to c##testuser;

Succeed.

SQL> grant execute on DBE_DIAGNOSE to c##testuser;

Succeed.

SQL> drop user if exists c##testuser_good cascade;

Succeed.

SQL> create user C##TESTUSER_GOOD identified by Cantian_234;

Succeed.

SQL> grant connect, create table , create type to c##testuser_good;

Succeed.

SQL> conn c##testuser_good/Cantian_234@127.0.0.1:1611

connected.

SQL> CREATE OR REPLACE TYPE PLSQL_ZENITH_TEST_004 FORCE AS OBJECT
  2 ( month int,
  3   month1 int
  4 );
  5 /

Succeed.

SQL> conn c##testuser/Cantian_234@127.0.0.1:1611

connected.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'Y');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
TRUE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'O');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
TRUE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'TYPE');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
TRUE

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> revoke execute any type from c##testuser;

Succeed.

SQL> conn c##testuser/Cantian_234@127.0.0.1:1611

connected.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'Y');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
FALSE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'O');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
FALSE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'TYPE');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
FALSE

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> grant execute on C##TESTUSER_GOOD.PLSQL_ZENITH_TEST_004 to c##testuser;

Succeed.

SQL> conn c##testuser/Cantian_234@127.0.0.1:1611

connected.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'Y');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
TRUE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'O');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
TRUE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'TYPE');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
TRUE

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> revoke execute on C##TESTUSER_GOOD.PLSQL_ZENITH_TEST_004 from c##testuser;

Succeed.

SQL> conn c##testuser/Cantian_234@127.0.0.1:1611

connected.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'Y');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
FALSE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'O');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
FALSE

1 rows fetched.

SQL> select DBE_DIAGNOSE.has_obj_privs('C##TESTUSER', 'C##TESTUSER_GOOD', 'PLSQL_ZENITH_TEST_004', 'TYPE');

DBE_DIAGNOSE.HAS_OBJ_PRIVS('C##TESTUSER', 'C##TESTUSER_GOOD', 'P
----------------------------------------------------------------
FALSE

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> drop user if exists c##testuser cascade;

Succeed.

SQL> drop user if exists c##testuser_good cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists AAA cascade;

Succeed.

SQL> create user AAA identified by Cantian_234;

Succeed.

SQL> grant connect , create table,create sequence, CREATE ANY DIRECTORY  to AAA;

Succeed.

SQL> drop user if exists bbb cascade;

Succeed.

SQL> create user bbb identified by Cantian_234;

Succeed.

SQL> grant connect , create table,create sequence, CREATE ANY DIRECTORY  to bbb;

Succeed.

SQL> drop user if exists ccc cascade;

Succeed.

SQL> create user ccc identified by Cantian_234;

Succeed.

SQL> grant connect , create table,create sequence, CREATE ANY DIRECTORY  to ccc;

Succeed.

SQL> drop user if exists ddd cascade;

Succeed.

SQL> create user ddd identified by Cantian_234;

Succeed.

SQL> grant connect , create table,create sequence, CREATE ANY DIRECTORY  to ddd;

Succeed.

SQL> drop user if exists eee cascade;

Succeed.

SQL> create user eee identified by Cantian_234;

Succeed.

SQL> grant connect , create table,create sequence, CREATE ANY DIRECTORY  to eee;

Succeed.

SQL> create or replace directory test_dir as '/home/regress/CantianKernel/pkg/test/gs_regress/data';

Succeed.

SQL> grant read on directory test_dir to aaa  with grant option;

Succeed.

SQL> conn aaa/Cantian_234@127.0.0.1:1611

connected.

SQL> grant read on directory test_dir to bbb  with grant option;

Succeed.

SQL> conn bbb/Cantian_234@127.0.0.1:1611

connected.

SQL> grant read on directory test_dir to ccc  with grant option;

Succeed.

SQL> conn ccc/Cantian_234@127.0.0.1:1611

connected.

SQL> grant read on directory test_dir to ddd  with grant option;

Succeed.

SQL> conn ddd/Cantian_234@127.0.0.1:1611

connected.

SQL> grant read on directory test_dir to eee  with grant option;

Succeed.

SQL> conn / as sysdba

connected.

SQL> select * from dba_tab_privs where OBJECT_NAME = 'TEST_DIR' ORDER BY GRANTEE;

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------
AAA                                                              SYS                                                              TEST_DIR                                                         DIRECTORY   READ ON DIRECTORY    YES      
BBB                                                              SYS                                                              TEST_DIR                                                         DIRECTORY   READ ON DIRECTORY    YES      
CCC                                                              SYS                                                              TEST_DIR                                                         DIRECTORY   READ ON DIRECTORY    YES      
DDD                                                              SYS                                                              TEST_DIR                                                         DIRECTORY   READ ON DIRECTORY    YES      
EEE                                                              SYS                                                              TEST_DIR                                                         DIRECTORY   READ ON DIRECTORY    YES      

5 rows fetched.

SQL> revoke read on directory test_dir from aaa;

Succeed.

SQL> select * from dba_tab_privs where OBJECT_NAME = 'TEST_DIR' ORDER BY GRANTEE;

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------

0 rows fetched.

SQL> conn / as sysdba

connected.

SQL> drop user if exists AAA cascade;

Succeed.

SQL> create user AAA identified by Cantian_234;

Succeed.

SQL> grant connect , create table,create sequence, CREATE ANY DIRECTORY  to AAA;

Succeed.

SQL> drop user if exists bbb cascade;

Succeed.

SQL> create user bbb identified by Cantian_234;

Succeed.

SQL> grant connect , create table,create sequence, CREATE ANY DIRECTORY  to bbb;

Succeed.

SQL> drop user if exists ccc cascade;

Succeed.

SQL> create user ccc identified by Cantian_234;

Succeed.

SQL> grant connect , create table,create sequence, CREATE ANY DIRECTORY  to ccc;

Succeed.

SQL> drop user if exists ddd cascade;

Succeed.

SQL> create user ddd identified by Cantian_234;

Succeed.

SQL> grant connect , create table,create sequence, CREATE ANY DIRECTORY  to ddd;

Succeed.

SQL> drop user if exists eee cascade;

Succeed.

SQL> create user eee identified by Cantian_234;

Succeed.

SQL> grant connect , create table,create sequence, CREATE ANY DIRECTORY  to eee;

Succeed.

SQL> create or replace directory test_dir as '/home/regress/CantianKernel/pkg/test/gs_regress/data';

Succeed.

SQL> grant read on directory test_dir to aaa  with grant option;

Succeed.

SQL> conn aaa/Cantian_234@127.0.0.1:1611

connected.

SQL> grant read on directory test_dir to bbb  with grant option;

Succeed.

SQL> conn bbb/Cantian_234@127.0.0.1:1611

connected.

SQL> grant read on directory test_dir to ccc  with grant option;

Succeed.

SQL> conn ccc/Cantian_234@127.0.0.1:1611

connected.

SQL> grant read on directory test_dir to ddd  with grant option;

Succeed.

SQL> conn ddd/Cantian_234@127.0.0.1:1611

connected.

SQL> grant read on directory test_dir to eee  with grant option;

Succeed.

SQL> conn / as sysdba

connected.

SQL> select * from dba_tab_privs where OBJECT_NAME = 'TEST_DIR' ORDER BY GRANTEE;

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------
AAA                                                              SYS                                                              TEST_DIR                                                         DIRECTORY   READ ON DIRECTORY    YES      
BBB                                                              SYS                                                              TEST_DIR                                                         DIRECTORY   READ ON DIRECTORY    YES      
CCC                                                              SYS                                                              TEST_DIR                                                         DIRECTORY   READ ON DIRECTORY    YES      
DDD                                                              SYS                                                              TEST_DIR                                                         DIRECTORY   READ ON DIRECTORY    YES      
EEE                                                              SYS                                                              TEST_DIR                                                         DIRECTORY   READ ON DIRECTORY    YES      

5 rows fetched.

SQL> drop directory test_dir;

Succeed.

SQL> select * from dba_tab_privs where OBJECT_NAME = 'TEST_DIR' ORDER BY GRANTEE;

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------

0 rows fetched.

SQL> drop user if exists AAA cascade;

Succeed.

SQL> drop user if exists bbb cascade;

Succeed.

SQL> drop user if exists ccc cascade;

Succeed.

SQL> drop user if exists ddd cascade;

Succeed.

SQL> drop user if exists eee cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists dbatest1 cascade;

Succeed.

SQL> drop user if exists dbatest2 cascade;

Succeed.

SQL> drop user if exists dbatest3 cascade;

Succeed.

SQL> drop user if exists dbatest4 cascade;

Succeed.

SQL> drop user if exists dbatest5 cascade;

Succeed.

SQL> drop user if exists dbatest6 cascade;

Succeed.

SQL> drop user if exists dbatest7 cascade;

Succeed.

SQL> drop user if exists dbatest8 cascade;

Succeed.

SQL> drop user if exists dbatest9 cascade;

Succeed.

SQL> drop user if exists dbatest10 cascade;

Succeed.

SQL> create user dbatest1 identified by Cantian_234;

Succeed.

SQL> create user dbatest2 identified by Cantian_234;

Succeed.

SQL> create user dbatest3 identified by Cantian_234;

Succeed.

SQL> create user dbatest4 identified by Cantian_234;

Succeed.

SQL> create user dbatest5 identified by Cantian_234;

Succeed.

SQL> create user dbatest6 identified by Cantian_234;

Succeed.

SQL> create user dbatest7 identified by Cantian_234;

Succeed.

SQL> create user dbatest8 identified by Cantian_234;

Succeed.

SQL> create user dbatest9 identified by Cantian_234;

Succeed.

SQL> create user dbatest10 identified by Cantian_234;

Succeed.

SQL> grant connect to dbatest1;

Succeed.

SQL> grant connect to dbatest2;

Succeed.

SQL> grant connect to dbatest3;

Succeed.

SQL> grant connect to dbatest4;

Succeed.

SQL> grant connect to dbatest5;

Succeed.

SQL> grant connect ,create role to dbatest6;

Succeed.

SQL> grant connect ,create role to dbatest7;

Succeed.

SQL> grant connect ,create role to dbatest8;

Succeed.

SQL> grant connect to dbatest9;

Succeed.

SQL> grant connect to dbatest10;

Succeed.

SQL> drop table if exists sys_tab_table1;

Succeed.

SQL> create table sys_tab_table1(id int);

Succeed.

SQL> grant select on sys.sys_tab_table1 to dbatest1 with grant option;

Succeed.

SQL> conn dbatest1/Cantian_234@127.0.0.1:1611

connected.

SQL> grant select on sys.sys_tab_table1 to dbatest2 with grant option;

Succeed.

SQL> conn dbatest2/Cantian_234@127.0.0.1:1611

connected.

SQL> grant select on sys.sys_tab_table1 to dbatest3 with grant option;

Succeed.

SQL> conn dbatest3/Cantian_234@127.0.0.1:1611

connected.

SQL> grant select on sys.sys_tab_table1 to dbatest4 with grant option;

Succeed.

SQL> conn dbatest4/Cantian_234@127.0.0.1:1611

connected.

SQL> grant select on sys.sys_tab_table1 to dbatest5 with grant option;

Succeed.

SQL> conn dbatest5/Cantian_234@127.0.0.1:1611

connected.

SQL> grant select on sys.sys_tab_table1 to dbatest6 with grant option;

Succeed.

SQL> conn dbatest6/Cantian_234@127.0.0.1:1611

connected.

SQL> grant select on sys.sys_tab_table1 to dbatest7 with grant option;

Succeed.

SQL> conn dbatest7/Cantian_234@127.0.0.1:1611

connected.

SQL> grant select on sys.sys_tab_table1 to dbatest8 with grant option;

Succeed.

SQL> conn dbatest8/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from sys.sys_tab_table1;

ID
------------

0 rows fetched.

SQL> conn / as sysdba

connected.

SQL> drop user if exists dbatest1 cascade;

Succeed.

SQL> conn dbatest8/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from sys.sys_tab_table1;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop user if exists dbatest1 cascade;

Succeed.

SQL> drop user if exists dbatest2 cascade;

Succeed.

SQL> drop user if exists dbatest3 cascade;

Succeed.

SQL> drop user if exists dbatest4 cascade;

Succeed.

SQL> drop user if exists dbatest5 cascade;

Succeed.

SQL> drop user if exists dbatest6 cascade;

Succeed.

SQL> drop user if exists dbatest7 cascade;

Succeed.

SQL> drop user if exists dbatest8 cascade;

Succeed.

SQL> drop user if exists dbatest9 cascade;

Succeed.

SQL> drop user if exists dbatest10 cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists dbatest1 cascade;

Succeed.

SQL> drop user if exists dbatest2 cascade;

Succeed.

SQL> drop user if exists dbatest3 cascade;

Succeed.

SQL> create user dbatest1 identified by Cantian_234;

Succeed.

SQL> create user dbatest2 identified by Cantian_234;

Succeed.

SQL> create user dbatest3 identified by Cantian_234;

Succeed.

SQL> grant connect,create role to dbatest1;

Succeed.

SQL> grant connect,create role to dbatest2;

Succeed.

SQL> grant connect,create role to dbatest3;

Succeed.

SQL> drop table if exists sys_tab_table1;

Succeed.

SQL> create table sys_tab_table1(id int);

Succeed.

SQL> grant select on sys.sys_tab_table1 to dbatest1 with grant option;

Succeed.

SQL> conn dbatest1/Cantian_234@127.0.0.1:1611

connected.

SQL> create role TEST_ROLE11111111111 ;

Succeed.

SQL> grant select on sys.sys_tab_table1 to TEST_ROLE11111111111;

Succeed.

SQL> grant TEST_ROLE11111111111 to dbatest2;

Succeed.

SQL> conn dbatest2/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from sys.sys_tab_table1;

ID          
------------

0 rows fetched.

SQL> conn / as sysdba

connected.

SQL> select * from dba_tab_privs where grantee = 'TEST_ROLE11111111111';

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------
TEST_ROLE11111111111                                             SYS                                                              SYS_TAB_TABLE1                                                   TABLE       SELECT               NO

1 rows fetched.

SQL> drop user if exists dbatest1 cascade;

Succeed.

SQL> select * from dba_tab_privs where grantee = 'TEST_ROLE11111111111';

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------

0 rows fetched.

SQL> conn dbatest2/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from sys.sys_tab_table1;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop role TEST_ROLE11111111111;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists dbatest1 cascade;

Succeed.

SQL> drop user if exists dbatest2 cascade;

Succeed.

SQL> drop user if exists dbatest3 cascade;

Succeed.

SQL> create user dbatest1 identified by Cantian_234;

Succeed.

SQL> create user dbatest2 identified by Cantian_234;

Succeed.

SQL> create user dbatest3 identified by Cantian_234;

Succeed.

SQL> grant connect,create role to dbatest1;

Succeed.

SQL> grant connect,create role to dbatest2;

Succeed.

SQL> grant connect,create role to dbatest3;

Succeed.

SQL> drop table if exists sys_tab_table1;

Succeed.

SQL> create table sys_tab_table1(id int);

Succeed.

SQL> grant select on sys.sys_tab_table1 to dbatest1 with grant option;

Succeed.

SQL> conn dbatest1/Cantian_234@127.0.0.1:1611

connected.

SQL> create role TEST_ROLE2222222222 ;

Succeed.

SQL> grant select on sys.sys_tab_table1 to TEST_ROLE2222222222;

Succeed.

SQL> grant select on sys.sys_tab_table1 to dbatest2 with grant option;

Succeed.

SQL> conn dbatest2/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from sys.sys_tab_table1;

ID
------------

0 rows fetched.

SQL> conn / as sysdba

connected.

SQL> select * from dba_tab_privs where grantee = 'TEST_ROLE2222222222';

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------
TEST_ROLE2222222222                                              SYS                                                              SYS_TAB_TABLE1                                                   TABLE       SELECT               NO

1 rows fetched.

SQL> select * from dba_tab_privs where grantee = 'DBATEST2';

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------
DBATEST2                                                         SYS                                                              SYS_TAB_TABLE1                                                   TABLE       SELECT               YES

1 rows fetched.

SQL> drop user if exists dbatest1 cascade;

Succeed.

SQL> select * from dba_tab_privs where grantee = 'TEST_ROLE2222222222';

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------

0 rows fetched.

SQL> select * from dba_tab_privs where grantee = 'DBATEST2';

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------

0 rows fetched.

SQL> conn dbatest2/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from sys.sys_tab_table1;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop role TEST_ROLE2222222222;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists dbatest1 cascade;

Succeed.

SQL> drop user if exists dbatest2 cascade;

Succeed.

SQL> drop user if exists dbatest3 cascade;

Succeed.

SQL> drop user if exists dbatest4 cascade;

Succeed.

SQL> drop user if exists dbatest5 cascade;

Succeed.

SQL> drop user if exists dbatest6 cascade;

Succeed.

SQL> drop user if exists dbatest7 cascade;

Succeed.

SQL> drop user if exists dbatest8 cascade;

Succeed.

SQL> drop user if exists dbatest9 cascade;

Succeed.

SQL> drop user if exists dbatest10 cascade;

Succeed.

SQL> create user dbatest1 identified by Cantian_234;

Succeed.

SQL> create user dbatest2 identified by Cantian_234;

Succeed.

SQL> create user dbatest3 identified by Cantian_234;

Succeed.

SQL> create user dbatest4 identified by Cantian_234;

Succeed.

SQL> create user dbatest5 identified by Cantian_234;

Succeed.

SQL> create user dbatest6 identified by Cantian_234;

Succeed.

SQL> create user dbatest7 identified by Cantian_234;

Succeed.

SQL> create user dbatest8 identified by Cantian_234;

Succeed.

SQL> create user dbatest9 identified by Cantian_234;

Succeed.

SQL> create user dbatest10 identified by Cantian_234;

Succeed.

SQL> grant connect to dbatest1;

Succeed.

SQL> grant connect to dbatest2;

Succeed.

SQL> grant connect to dbatest3;

Succeed.

SQL> grant connect to dbatest4;

Succeed.

SQL> grant connect to dbatest5;

Succeed.

SQL> grant connect ,create role to dbatest6;

Succeed.

SQL> grant connect ,create role to dbatest7;

Succeed.

SQL> grant connect ,create role to dbatest8;

Succeed.

SQL> grant connect to dbatest9;

Succeed.

SQL> grant connect to dbatest10;

Succeed.

SQL> drop table if exists sys_tab_table1;

Succeed.

SQL> create table sys_tab_table1(id int);

Succeed.

SQL> grant select on sys.sys_tab_table1 to dbatest1 with grant option;

Succeed.

SQL> conn dbatest1/Cantian_234@127.0.0.1:1611

connected.

SQL> grant select on sys.sys_tab_table1 to dbatest2 with grant option;

Succeed.

SQL> conn dbatest2/Cantian_234@127.0.0.1:1611

connected.

SQL> grant select on sys.sys_tab_table1 to dbatest3 with grant option;

Succeed.

SQL> conn dbatest3/Cantian_234@127.0.0.1:1611

connected.

SQL> grant select on sys.sys_tab_table1 to dbatest4 with grant option;

Succeed.

SQL> conn dbatest4/Cantian_234@127.0.0.1:1611

connected.

SQL> grant select on sys.sys_tab_table1 to dbatest5 with grant option;

Succeed.

SQL> conn dbatest5/Cantian_234@127.0.0.1:1611

connected.

SQL> grant select on sys.sys_tab_table1 to dbatest6 with grant option;

Succeed.

SQL> conn dbatest6/Cantian_234@127.0.0.1:1611

connected.

SQL> create role test_role6;

Succeed.

SQL> grant select on sys.sys_tab_table1 to test_role6;

Succeed.

SQL> grant select on sys.sys_tab_table1 to dbatest7 with grant option;

Succeed.

SQL> grant test_role6 to dbatest10;

Succeed.

SQL> conn dbatest7/Cantian_234@127.0.0.1:1611

connected.

SQL> create role test_role7;

Succeed.

SQL> grant select on sys.sys_tab_table1 to test_role7;

Succeed.

SQL> grant test_role7 to dbatest9;

Succeed.

SQL> grant select on sys.sys_tab_table1 to dbatest8 with grant option;

Succeed.

SQL> conn dbatest8/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from sys.sys_tab_table1;

ID
------------

0 rows fetched.

SQL> conn dbatest9/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from sys.sys_tab_table1;

ID
------------

0 rows fetched.

SQL> conn dbatest10/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from sys.sys_tab_table1;

ID
------------

0 rows fetched.

SQL> conn / as sysdba

connected.

SQL> drop user if exists dbatest1 cascade;

Succeed.

SQL> conn dbatest8/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from sys.sys_tab_table1;

CT-01001, Permissions were insufficient
SQL> conn dbatest9/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from sys.sys_tab_table1;

CT-01001, Permissions were insufficient
SQL> conn dbatest10/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from sys.sys_tab_table1;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop role test_role6;

Succeed.

SQL> drop role test_role7;

Succeed.

SQL> drop user if exists dbatest1 cascade;

Succeed.

SQL> drop user if exists dbatest2 cascade;

Succeed.

SQL> drop user if exists dbatest3 cascade;

Succeed.

SQL> drop user if exists dbatest4 cascade;

Succeed.

SQL> drop user if exists dbatest5 cascade;

Succeed.

SQL> drop user if exists dbatest6 cascade;

Succeed.

SQL> drop user if exists dbatest7 cascade;

Succeed.

SQL> drop user if exists dbatest8 cascade;

Succeed.

SQL> drop user if exists dbatest9 cascade;

Succeed.

SQL> drop user if exists dbatest10 cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> alter system set ENABLE_ACCESS_DC=FALSE;

Succeed.

SQL> drop user if exists test_use_1000 cascade;

Succeed.

SQL> create user test_use_1000 identified by Cantian_234;

Succeed.

SQL> grant connect,select any table to test_use_1000;

Succeed.

SQL> conn test_use_1000/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from sys.ssssss;

CT-01001, [1:15]Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop user if exists test_use_1000 cascade;

Succeed.

SQL> create user test_use_1000 identified by Cantian_234;

Succeed.

SQL> grant connect,select any dictionary to test_use_1000;

Succeed.

SQL> conn test_use_1000/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from sys.ssssss;

CT-00843, [1:15]The table or view SYS.SSSSSS does not exist.
SQL> conn / as sysdba

connected.

SQL> alter system set ENABLE_ACCESS_DC = TRUE;

Succeed.

SQL> drop user if exists test_use_1000 cascade;

Succeed.

SQL> conn / as  sysdba

connected.

SQL> drop user if exists c##core_user cascade;

Succeed.

SQL> create user c##core_user identified by Cantian_234;

Succeed.

SQL> grant connect ,create table , create view to c##core_user;

Succeed.

SQL> drop user if exists c##core_user1 cascade;

Succeed.

SQL> create user c##core_user1 identified by Cantian_234;

Succeed.

SQL> grant connect ,create table , create view to c##core_user1;

Succeed.

SQL> drop table if exists table_core1;

Succeed.

SQL> create table table_core1(id int);

Succeed.

SQL> conn  c##core_user1/Cantian_234@127.0.0.1:1611

connected.

SQL> create table table_core1(id int);

Succeed.

SQL> conn  c##core_user/Cantian_234@127.0.0.1:1611

connected.

SQL> create table table_core1(id int);

Succeed.

SQL> create table inset_as_select_tab(id int);

Succeed.

SQL> create table inset_as_select_tab1(id int);

Succeed.

SQL> select id from sys.table_core1;

CT-01001, Permissions were insufficient
SQL> select id from c##core_user.table_core1;

ID
------------

0 rows fetched.

SQL> select id from c##core_user1.table_core1;

CT-01001, Permissions were insufficient
SQL> create table tab_as_ddm as  select * from sys.sys_ddm;

CT-01001, Permissions were insufficient
SQL> create view view_as_ddm as  select * from sys.sys_ddm;

CT-01001, Permissions were insufficient
SQL> insert into inset_as_select_tab  select * from sys.table_core1;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> grant select any dictionary to c##core_user;

Succeed.

SQL> conn  c##core_user/Cantian_234@127.0.0.1:1611

connected.

SQL> select id from c##core_user1.table_core1;

CT-01001, Permissions were insufficient
SQL> select id from sys.table_core1;

ID
------------

0 rows fetched.

SQL> create table tab_as_ddm1 as  select * from sys.sys_ddm;

Succeed.

SQL> create view view_as_ddm1 as  select * from sys.sys_ddm;

Succeed.

SQL> insert into inset_as_select_tab1  select * from sys.table_core1;

0 rows affected.

SQL> conn / as sysdba

connected.

SQL> revoke select any dictionary from c##core_user;

Succeed.

SQL> alter system set ENABLE_ACCESS_DC = false ;

Succeed.

SQL> grant select any table to c##core_user;

Succeed.

SQL> conn  c##core_user/Cantian_234@127.0.0.1:1611

connected.

SQL> select id from c##core_user1.table_core1;

ID
------------

0 rows fetched.

SQL> select id from sys.table_core1;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> alter system set ENABLE_ACCESS_DC = TRUE ;

Succeed.

SQL> grant select any table to c##core_user;

Succeed.

SQL> conn  c##core_user/Cantian_234@127.0.0.1:1611

connected.

SQL> select id from c##core_user1.table_core1;

ID
------------

0 rows fetched.

SQL> select id from sys.table_core1;

ID
------------

0 rows fetched.

SQL> conn / as  sysdba

connected.

SQL> drop user if exists c##core_user cascade;

Succeed.

SQL> drop user if exists c##core_user1 cascade;

Succeed.

SQL> conn / as  sysdba

connected.

SQL> alter system set ENABLE_ACCESS_DC = false ;

Succeed.

SQL> drop user if exists c##core_user cascade;

Succeed.

SQL> create user c##core_user identified by Cantian_234;

Succeed.

SQL> grant connect ,create table , create view to c##core_user;

Succeed.

SQL> drop table if exists table_core1;

Succeed.

SQL> create table table_core1(id int);

Succeed.

SQL> select name from sys.sys_users where name = 'C##CORE_USER';

NAME
----------------------------------------------------------------
C##CORE_USER

1 rows fetched.

SQL> conn  c##core_user/Cantian_234@127.0.0.1:1611

connected.

SQL> select id from sys.table_core1;

CT-01001, Permissions were insufficient
SQL> select name from sys.sys_users where name = 'C##CORE_USER';

CT-01001, Permissions were insufficient
SQL> conn / as  sysdba

connected.

SQL> grant select any table to c##core_user;

Succeed.

SQL> conn  c##core_user/Cantian_234@127.0.0.1:1611

connected.

SQL> select id from sys.table_core1;

CT-01001, Permissions were insufficient
SQL> select name from sys.sys_users where name = 'C##CORE_USER';

CT-01001, Permissions were insufficient
SQL> conn / as  sysdba

connected.

SQL> alter system set ENABLE_ACCESS_DC  = true;

Succeed.

SQL> conn  c##core_user/Cantian_234@127.0.0.1:1611

connected.

SQL> select id from sys.table_core1;

ID
------------

0 rows fetched.

SQL> select name from sys.sys_users where name = 'C##CORE_USER';

NAME
----------------------------------------------------------------
C##CORE_USER

1 rows fetched.

SQL> conn / as  sysdba

connected.

SQL> revoke select any table from c##core_user;

Succeed.

SQL> grant select any dictionary to c##core_user;

Succeed.

SQL> conn  c##core_user/Cantian_234@127.0.0.1:1611

connected.

SQL> select id from sys.table_core1;

ID
------------

0 rows fetched.

SQL> select name from sys.sys_users where name = 'C##CORE_USER';

NAME
----------------------------------------------------------------
C##CORE_USER

1 rows fetched.

SQL> conn / as  sysdba

connected.

SQL> revoke select any dictionary from c##core_user;

Succeed.

SQL> grant select on table_core1 to c##core_user;

Succeed.

SQL> grant select on sys_users to c##core_user;

Succeed.

SQL> conn  c##core_user/Cantian_234@127.0.0.1:1611

connected.

SQL> select id from sys.table_core1;

ID
------------

0 rows fetched.

SQL> select name from sys.sys_users where name = 'C##CORE_USER';

NAME
----------------------------------------------------------------
C##CORE_USER

1 rows fetched.

SQL> conn / as  sysdba

connected.

SQL> drop user if exists c##core_user cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists view_for_sys_obj cascade;

Succeed.

SQL> create user view_for_sys_obj identified by Cantian_234;

Succeed.

SQL> grant create view ,connect to view_for_sys_obj;

Succeed.

SQL> alter system set  ENABLE_ACCESS_DC = FALSE;

Succeed.

SQL> conn view_for_sys_obj/Cantian_234@127.0.0.1:1611

connected.

SQL> create or replace view sysob as select object_name  from all_objects O, DB_TABLES D where D.TABLE_NAME = O.OBJECT_NAME;

Succeed.

SQL> conn / as sysdba

connected.

SQL> alter system set  ENABLE_ACCESS_DC = TRUE;

Succeed.

SQL> drop user if exists view_for_sys_obj cascade;

Succeed.

SQL> CONN / AS SYSDBA

connected.

SQL> DROP ROLE DBA;

CT-00815, role DBA is system role, can not drop
SQL> DROP ROLE STATISTICS;

CT-00815, role STATISTICS is system role, can not drop
SQL> DROP USER IF EXISTS SYSN_USER1 CASCADE;

Succeed.

SQL> DROP USER IF EXISTS SYN_CC CASCADE;

Succeed.

SQL> CREATE USER SYSN_USER1 IDENTIFIED BY USER102_USER;

Succeed.

SQL> CREATE USER SYN_CC IDENTIFIED BY USER102_USER;

Succeed.

SQL> GRANT CONNECT, GRANT ANY ROLE  TO SYSN_USER1;

Succeed.

SQL> CONN SYSN_USER1/USER102_USER@127.0.0.1:1611

connected.

SQL> GRANT RESOURCE,DBA,CONNECT TO SYSN_USER1;

CT-01001, Permissions were insufficient
SQL> GRANT RESOURCE,DBA,CONNECT TO SYN_CC;

CT-01001, Permissions were insufficient
SQL> CONN / AS SYSDBA

connected.

SQL> SELECT * FROM ADM_ROLE_PRIVS WHERE GRANTEE = 'SYSN_USER1';

GRANTEE                                                          GRANTED_ROLE                                                     ADMIN_OPTION
---------------------------------------------------------------- ---------------------------------------------------------------- ------------
SYSN_USER1                                                       CONNECT                                                          NO

1 rows fetched.

SQL> SELECT * FROM ADM_ROLE_PRIVS WHERE GRANTEE = 'SYN_CC';

GRANTEE                                                          GRANTED_ROLE                                                     ADMIN_OPTION
---------------------------------------------------------------- ---------------------------------------------------------------- ------------

0 rows fetched.

SQL> DROP USER IF EXISTS SYSN_USER1 CASCADE;

Succeed.

SQL> DROP USER IF EXISTS SYN_CC CASCADE;

Succeed.

SQL> CREATE USER SYSN_USER1 IDENTIFIED BY USER102_USER;

Succeed.

SQL> CREATE USER SYN_CC IDENTIFIED BY USER102_USER;

Succeed.

SQL> GRANT CONNECT, GRANT ANY ROLE, GRANT ANY PRIVILEGE   TO SYSN_USER1;

Succeed.

SQL> CONN SYSN_USER1/USER102_USER@127.0.0.1:1611

connected.

SQL> GRANT RESOURCE,DBA,CONNECT TO SYSN_USER1;

Succeed.

SQL> GRANT RESOURCE,DBA,CONNECT TO SYN_CC;

Succeed.

SQL> CONN / AS SYSDBA

connected.

SQL> SELECT * FROM ADM_ROLE_PRIVS WHERE GRANTEE = 'SYSN_USER1';

GRANTEE                                                          GRANTED_ROLE                                                     ADMIN_OPTION
---------------------------------------------------------------- ---------------------------------------------------------------- ------------
SYSN_USER1                                                       DBA                                                              NO
SYSN_USER1                                                       RESOURCE                                                         NO
SYSN_USER1                                                       CONNECT                                                          NO

3 rows fetched.

SQL> SELECT * FROM ADM_ROLE_PRIVS WHERE GRANTEE = 'SYN_CC';

GRANTEE                                                          GRANTED_ROLE                                                     ADMIN_OPTION
---------------------------------------------------------------- ---------------------------------------------------------------- ------------
SYN_CC                                                           DBA                                                              NO
SYN_CC                                                           RESOURCE                                                         NO
SYN_CC                                                           CONNECT                                                          NO

3 rows fetched.

SQL> DROP USER IF EXISTS SYSN_USER1 CASCADE;

Succeed.

SQL> DROP USER IF EXISTS SYN_CC CASCADE;

Succeed.

SQL> CONN / AS SYSDBA

connected.

SQL> DROP USER IF EXISTS SYSN_USER1 CASCADE;

Succeed.

SQL> DROP USER IF EXISTS SYN_CC CASCADE;

Succeed.

SQL> CREATE USER SYSN_USER1 IDENTIFIED BY USER102_USER;

Succeed.

SQL> GRANT CREATE SYNONYM, CREATE PUBLIC SYNONYM, CREATE ANY SYNONYM TO SYSN_USER1;

Succeed.

SQL> GRANT CREATE TABLE, CONNECT TO SYSN_USER1;

Succeed.

SQL> CONN SYSN_USER1/USER102_USER@127.0.0.1:1611

connected.

SQL> CREATE TABLE SYSN_USER1_T1(ID INT);

Succeed.

SQL> CREATE OR REPLACE SYNONYM SYN_CC.T1 FOR SYSN_USER1_T1;

CT-00781, The user SYN_CC does not exist.
SQL> CONN / AS SYSDBA

connected.

SQL> CREATE USER SYN_CC IDENTIFIED BY USER102_USER;

Succeed.

SQL> GRANT CONNECT ,SELECT ANY TABLE TO SYN_CC;

Succeed.

SQL> CONN SYSN_USER1/USER102_USER@127.0.0.1:1611

connected.

SQL> CREATE OR REPLACE SYNONYM SYN_CC.SYNT1 FOR SYSN_USER1_T1;

Succeed.

SQL> CONN SYN_CC/USER102_USER@127.0.0.1:1611

connected.

SQL> SELECT * FROM SYNT1;

ID
------------

0 rows fetched.

SQL> CONN / AS  SYSDBA

connected.

SQL> REVOKE CREATE ANY SYNONYM FROM SYSN_USER1;

Succeed.

SQL> DROP SYNONYM SYN_CC.SYNT1;

Succeed.

SQL> CONN SYSN_USER1/USER102_USER@127.0.0.1:1611

connected.

SQL> CREATE OR REPLACE SYNONYM SYN_CC.SYNT1 FOR SYSN_USER1_T1;

CT-01001, Permissions were insufficient
SQL> CONN / AS SYSDBA

connected.

SQL> DROP USER IF EXISTS SYSN_USER1 CASCADE;

Succeed.

SQL> DROP USER IF EXISTS SYN_CC CASCADE;

Succeed.

SQL> CONN / AS SYSDBA

connected.

SQL> ALTER SYSTEM SET ENABLE_ACCESS_DC = TRUE;

Succeed.

SQL> DROP USER IF EXISTS SELECT_ANY_TABLE_USER CASCADE;

Succeed.

SQL> DROP TABLE IF EXISTS SYS_T1;

Succeed.

SQL> CREATE TABLE SYS_T1(ID INT);

Succeed.

SQL> CREATE USER SELECT_ANY_TABLE_USER IDENTIFIED BY SELECT_ANY_TABLE_USER102_SELECT_ANY_TABLE_USER;

Succeed.

SQL> GRANT SELECT ANY TABLE ,CREATE VIEW ,CONNECT TO SELECT_ANY_TABLE_USER;

Succeed.

SQL> CONN SELECT_ANY_TABLE_USER/SELECT_ANY_TABLE_USER102_SELECT_ANY_TABLE_USER@127.0.0.1:1611

connected.

SQL> CREATE VIEW VIEW1 AS SELECT * FROM SYS.SYS_T1;

Succeed.

SQL> CREATE VIEW VIEW2 AS SELECT * FROM SYS.SYS_AUDIT;

Succeed.

SQL> CONN / AS SYSDBA

connected.

SQL> ALTER SYSTEM SET ENABLE_ACCESS_DC = FALSE;

Succeed.

SQL> DROP USER IF EXISTS SELECT_ANY_TABLE_USER CASCADE;

Succeed.

SQL> DROP TABLE IF EXISTS SYS_T1;

Succeed.

SQL> CREATE TABLE SYS_T1(ID INT);

Succeed.

SQL> CREATE USER SELECT_ANY_TABLE_USER IDENTIFIED BY SELECT_ANY_TABLE_USER102_SELECT_ANY_TABLE_USER;

Succeed.

SQL> GRANT SELECT ANY TABLE ,CREATE VIEW ,CONNECT TO SELECT_ANY_TABLE_USER;

Succeed.

SQL> CONN SELECT_ANY_TABLE_USER/SELECT_ANY_TABLE_USER102_SELECT_ANY_TABLE_USER@127.0.0.1:1611

connected.

SQL> CREATE VIEW VIEW1 AS SELECT * FROM SYS.SYS_T1;

CT-01001, Permissions were insufficient
SQL> CREATE VIEW VIEW2 AS SELECT * FROM SYS.SYS_AUDIT;

CT-01001, Permissions were insufficient
SQL> CONN / AS SYSDBA

connected.

SQL> GRANT SELECT ON SYS_T1 TO SELECT_ANY_TABLE_USER;

Succeed.

SQL> GRANT SELECT ON SYS_AUDIT TO SELECT_ANY_TABLE_USER;

Succeed.

SQL> CONN / AS SYSDBA

connected.

SQL> ALTER SYSTEM SET ENABLE_ACCESS_DC = FALSE;

Succeed.

SQL> CONN SELECT_ANY_TABLE_USER/SELECT_ANY_TABLE_USER102_SELECT_ANY_TABLE_USER@127.0.0.1:1611

connected.

SQL> CREATE VIEW VIEW1 AS SELECT * FROM SYS.SYS_T1;

Succeed.

SQL> CREATE VIEW VIEW2 AS SELECT * FROM SYS.SYS_AUDIT;

Succeed.

SQL> CONN / AS SYSDBA

connected.

SQL> ALTER SYSTEM SET ENABLE_ACCESS_DC = TRUE;

Succeed.

SQL> DROP USER IF EXISTS SELECT_ANY_TABLE_USER CASCADE;

Succeed.

SQL> DROP TABLE IF EXISTS SYS_T1;

Succeed.

SQL> CONN / AS  SYSDBA

connected.

SQL> DROP USER IF EXISTS SELECT_ANY_TABLE_USER CASCADE;

Succeed.

SQL> CREATE USER SELECT_ANY_TABLE_USER IDENTIFIED BY CANTIAN_234;

Succeed.

SQL> GRANT DBA , CONNECT TO SELECT_ANY_TABLE_USER;

Succeed.

SQL> CONN SELECT_ANY_TABLE_USER/CANTIAN_234@127.0.0.1:1611

connected.

SQL> SELECT ID, NAME  FROM SYS.SYS_TABLES WHERE NAME='SYS_TABLES';

ID           NAME
------------ ----------------------------------------------------------------
0            SYS_TABLES

1 rows fetched.

SQL> SELECT ID, NAME  FROM SYS.SYS_USERS WHERE ID=0;

ID           NAME
------------ ----------------------------------------------------------------
0            SYS

1 rows fetched.

SQL> CONN / AS SYSDBA

connected.

SQL> REVOKE DBA FROM SELECT_ANY_TABLE_USER;

Succeed.

SQL> CONN SELECT_ANY_TABLE_USER/CANTIAN_234@127.0.0.1:1611

connected.

SQL> SELECT ID, NAME  FROM SYS.SYS_TABLES WHERE NAME='SYS_TABLES';

CT-01001, Permissions were insufficient
SQL> SELECT ID, NAME  FROM SYS.SYS_USERS WHERE ID=0;

CT-01001, Permissions were insufficient
SQL> CONN / AS SYSDBA

connected.

SQL> GRANT SELECT ON SYS.SYS_TABLES TO SELECT_ANY_TABLE_USER;

Succeed.

SQL> GRANT SELECT ON SYS.SYS_USERS TO SELECT_ANY_TABLE_USER;

Succeed.

SQL> CONN SELECT_ANY_TABLE_USER/CANTIAN_234@127.0.0.1:1611

connected.

SQL> SELECT ID, NAME  FROM SYS.SYS_TABLES WHERE NAME='SYS_TABLES';

ID           NAME
------------ ----------------------------------------------------------------
0            SYS_TABLES

1 rows fetched.

SQL> SELECT ID, NAME  FROM SYS.SYS_USERS WHERE ID=0;

ID           NAME
------------ ----------------------------------------------------------------
0            SYS

1 rows fetched.

SQL> CONN / AS SYSDBA

connected.

SQL> REVOKE SELECT ON SYS.SYS_TABLES FROM SELECT_ANY_TABLE_USER;

Succeed.

SQL> REVOKE SELECT ON SYS.SYS_USERS FROM SELECT_ANY_TABLE_USER;

Succeed.

SQL> CONN SELECT_ANY_TABLE_USER/CANTIAN_234@127.0.0.1:1611

connected.

SQL> SELECT ID, NAME  FROM SYS.SYS_TABLES WHERE NAME='SYS_TABLES';

CT-01001, Permissions were insufficient
SQL> SELECT ID, NAME  FROM SYS.SYS_USERS WHERE ID=0;

CT-01001, Permissions were insufficient
SQL> CONN / AS SYSDBA

connected.

SQL> ALTER SYSTEM SET ENABLE_ACCESS_DC = FALSE;

Succeed.

SQL> GRANT SELECT ANY TABLE TO SELECT_ANY_TABLE_USER;

Succeed.

SQL> CONN SELECT_ANY_TABLE_USER/CANTIAN_234@127.0.0.1:1611

connected.

SQL> SELECT ID, NAME  FROM SYS.SYS_TABLES WHERE NAME='SYS_TABLES';

CT-01001, Permissions were insufficient
SQL> SELECT ID, NAME  FROM SYS.SYS_USERS WHERE ID=0;

CT-01001, Permissions were insufficient
SQL> CONN / AS SYSDBA

connected.

SQL> ALTER SYSTEM SET ENABLE_ACCESS_DC = TRUE;

Succeed.

SQL> GRANT SELECT ANY TABLE TO SELECT_ANY_TABLE_USER;

Succeed.

SQL> CONN SELECT_ANY_TABLE_USER/CANTIAN_234@127.0.0.1:1611

connected.

SQL> SELECT ID, NAME  FROM SYS.SYS_TABLES WHERE NAME='SYS_TABLES';
ID           NAME                                                            
------------ ----------------------------------------------------------------
0            SYS_TABLES                                                      

1 rows fetched.

SQL> SELECT ID, NAME  FROM SYS.SYS_USERS WHERE ID=0;

ID           NAME                                                            
------------ ----------------------------------------------------------------
0            SYS                                                             

1 rows fetched.

SQL> CONN / AS SYSDBA

connected.

SQL> DROP USER SELECT_ANY_TABLE_USER;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists cao1 cascade;

Succeed.

SQL> drop user if exists cao2 cascade;

Succeed.

SQL> create user cao1 identified by Cantian_234;

Succeed.

SQL> grant create session,create procedure to cao1;

Succeed.

SQL> create user cao2 identified by Cantian_234;

Succeed.

SQL> grant create session to cao2;

Succeed.

SQL> conn cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> CREATE OR REPLACE PROCEDURE cao1_1()
  2 IS
  3     tmp varchar2(20) :='12345678';
  4 begin
  5  dbe_output.print_line('OUT PUT RESULT:'||tmp);
  6 end cao1_1;
  7 /

Succeed.

SQL> grant execute on cao1_1 to cao2;

Succeed.

SQL> conn cao2/Cantian_234@127.0.0.1:1611

connected.

SQL> call cao1.cao1_1;

PL/SQL procedure successfully completed.

SQL> conn cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> drop procedure cao1_1;

Succeed.

SQL> CREATE OR REPLACE PROCEDURE cao1_1()
  2 IS
  3     tmp varchar2(20) :='12345678';
  4 begin
  5  dbe_output.print_line('OUT PUT RESULT:'||tmp);
  6 end cao1_1;
  7 /

Succeed.

SQL> conn  cao2/Cantian_234@127.0.0.1:1611

connected.

SQL> call cao1.cao1_1;

CT-00944, PL/SQL(CAO2.ANONYMOUS BLOCK) terminated with compiling errors
[1:2] PLC-01001 Permissions were insufficient

SQL> conn cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> grant execute on cao1_1 to cao2;

Succeed.

SQL> conn  cao2/Cantian_234@127.0.0.1:1611

connected.

SQL> call cao1.cao1_1;

PL/SQL procedure successfully completed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists cao1 cascade;

Succeed.

SQL> drop user if exists cao2 cascade;

Succeed.

SQL> create user cao1 identified by Cantian_234;

Succeed.

SQL> grant create session,create procedure,create trigger,create table to cao1;

Succeed.

SQL> create user cao2 identified by Cantian_234;

Succeed.

SQL> grant create session to cao2;

Succeed.

SQL> conn cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> drop table if exists t_enable_triggers;

Succeed.

SQL> create table t_enable_triggers(f1 int, f2 int);

Succeed.

SQL> CREATE OR REPLACE TRIGGER trig_enable_triggers1 BEFORE INSERT OR UPDATE OR DELETE ON t_enable_triggers
  2 BEGIN
  3 	dbe_output.print_line('BEFORE t_enable_triggers');
  4 END;
  5 /

Succeed.

SQL> CREATE OR REPLACE TRIGGER trig_enable_triggers2 AFTER INSERT OR UPDATE OR DELETE ON t_enable_triggers
  2 BEGIN
  3 	dbe_output.print_line('AFTER t_enable_triggers');
  4 END;
  5 /

Succeed.

SQL> insert into t_enable_triggers values(1, 2);

1 rows affected.

SQL> update t_enable_triggers set f2=3;

1 rows affected.

SQL> grant execute on trig_enable_triggers1 to cao2; //non support

CT-00828, object CAO1.TRIG_ENABLE_TRIGGERS1 does not exist
SQL> grant insert on t_enable_triggers to cao2;

Succeed.

SQL> grant update on t_enable_triggers to cao2;

Succeed.

SQL> conn / as sysdba

connected.

SQL> select grantee, OBJECT_NAME, PRIVILEGE from adm_tab_privs where grantee = 'CAO2' and OBJECT_NAME = 'T_ENABLE_TRIGGERS';

GRANTEE                                                          OBJECT_NAME                                                      PRIVILEGE           
---------------------------------------------------------------- ---------------------------------------------------------------- --------------------
CAO2                                                             T_ENABLE_TRIGGERS                                                INSERT              
CAO2                                                             T_ENABLE_TRIGGERS                                                UPDATE              

2 rows fetched.

SQL> conn cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> drop trigger trig_enable_triggers1;

Succeed.

SQL> drop trigger trig_enable_triggers2;

Succeed.

SQL> drop table if exists t_enable_triggers;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists cao1 cascade;

Succeed.

SQL> drop user if exists cao2 cascade;

Succeed.

SQL> create user cao1 identified by Cantian_234;

Succeed.

SQL> grant create session,create procedure to cao1;

Succeed.

SQL> create user cao2 identified by Cantian_234;

Succeed.

SQL> grant create session to cao2;

Succeed.

SQL> conn cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> CREATE OR REPLACE PACKAGE cao1_1
  2 IS
  3 FUNCTION MYF RETURN INT;
  4 PROCEDURE MYP;
  5 END;
  6 /

Succeed.

SQL> CREATE OR REPLACE PACKAGE BODY cao1_1
  2 IS
  3 FUNCTION MYF RETURN INT
  4 IS
  5 d int;
  6 BEGIN
  7 select 10 into d from dual;
  8 RETURN d;
  9 END;
 10 PROCEDURE MYP IS
 11 v_sql1 varchar(1023);
 12 BEGIN
 13 for i in (select OBJECT_NAME from all_objects where OBJECT_ID<5 and object_type not in ('INDEX'))loop
 14 dbe_output.print_line(i.OBJECT_NAME);
 15 end loop;
 16 END;
 17 END;
 18 /

Succeed.

SQL> grant execute on cao1_1 to cao2;

Succeed.

SQL> conn cao2/Cantian_234@127.0.0.1:1611

connected.

SQL> call cao1.cao1_1.MYP;

PL/SQL procedure successfully completed.

SQL> select cao1.cao1_1.MYF();

CAO1.CAO1_1.MYF()
-----------------
10

1 rows fetched.

SQL> conn cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> drop package cao1_1;

Succeed.

SQL> CREATE OR REPLACE PACKAGE cao1_1
  2 IS
  3 FUNCTION MYF RETURN INT;
  4 PROCEDURE MYP;
  5 END;
  6 /

Succeed.

SQL> CREATE OR REPLACE PACKAGE BODY cao1_1
  2 IS
  3 FUNCTION MYF RETURN INT
  4 IS
  5 d int;
  6 BEGIN
  7 select 10 into d from dual;
  8 RETURN d;
  9 END;
 10 PROCEDURE MYP IS
 11 v_sql1 varchar(1023);
 12 BEGIN
 13 for i in (select OBJECT_NAME from all_objects where OBJECT_ID<5 and object_type not in ('INDEX'))loop
 14 dbe_output.print_line(i.OBJECT_NAME);
 15 end loop;
 16 END;
 17 END;
 18 /

Succeed.

SQL> conn  cao2/Cantian_234@127.0.0.1:1611

connected.

SQL> call   cao1.cao1_1.MYP;

CT-00944, PL/SQL(CAO2.ANONYMOUS BLOCK) terminated with compiling errors
[1:4] PLC-01001 Permissions were insufficient

SQL> select   cao1.cao1_1.MYF();

CT-01001, [1:10]Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop user if exists cao1 cascade;

Succeed.

SQL> drop user if exists cao2 cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists user1 cascade;

Succeed.

SQL> CREATE USER USER1 IDENTIFIED BY Cantian_234;

Succeed.

SQL> GRANT create session to USER1;

Succeed.

SQL> conn user1/Cantian_234@127.0.0.1:1611

connected.

SQL> EXECUTE USER3.procedure1;

CT-00944, PL/SQL(USER1.ANONYMOUS BLOCK) terminated with compiling errors
[1:2] PLC-01001 Permissions were insufficient

SQL> select USER3.FUNCTION1(1);

CT-01001, [1:8]Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop user if exists user1 cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists user1 cascade;

Succeed.

SQL> drop user if exists user23 cascade;

Succeed.

SQL> CREATE USER USER1 IDENTIFIED BY Cantian_234;

Succeed.

SQL> GRANT create session to USER1;

Succeed.

SQL> conn user1/Cantian_234@127.0.0.1:1611

connected.

SQL> TRUNCATE TABLE USER23.TB_T1;

CT-01001, Permissions were insufficient
SQL> REPLACE INTO USER23.TB_T1(COL1) VALUES('TEST2');

CT-01001, [1:14]Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop user if exists user1 cascade;

Succeed.

SQL> drop user if exists user23 cascade;

Succeed.

SQL> conn / as  sysdba

connected.

SQL> drop user if exists cao cascade ;

Succeed.

SQL> drop user if exists cao1 cascade ;

Succeed.

SQL> drop user if exists cao2 cascade ;

Succeed.

SQL> create user cao identified by cao102_cao;

Succeed.

SQL> create user cao1 identified by cao102_cao;

Succeed.

SQL> create user cao2 identified by cao102_cao;

Succeed.

SQL> grant connect ,select any table ,create view to cao;

Succeed.

SQL> grant connect ,select any table ,create view to cao1;

Succeed.

SQL> grant connect ,select any table ,create view to cao2;

Succeed.

SQL> create table cao2.t1 (id int);

Succeed.

SQL> insert into cao2.t1 values (10);

1 rows affected.

SQL> conn  cao/cao102_cao@127.0.0.1:1611

connected.

SQL> create view view1 as select * from cao2.t1;

Succeed.

SQL> select * from cao.view1;

ID
------------

0 rows fetched.

SQL> conn  cao1/cao102_cao@127.0.0.1:1611

connected.

SQL> select * from cao.view1;

ID
------------

0 rows fetched.

SQL> conn / as sysdba

connected.

SQL> select * from cao.view1;

ID
------------

0 rows fetched.

SQL> revoke select any table from cao;

Succeed.

SQL> select * from cao.view1;

CT-01001, Permissions were insufficient
SQL> conn  cao/cao102_cao@127.0.0.1:1611

connected.

SQL> select * from view1;

CT-01001, Permissions were insufficient
SQL> conn  cao1/cao102_cao@127.0.0.1:1611

connected.

SQL> select * from cao.view1;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> grant select any table to cao;

Succeed.

SQL> conn  cao/cao102_cao@127.0.0.1:1611

connected.

SQL> select * from view1;

ID
------------

0 rows fetched.

SQL> conn  cao1/cao102_cao@127.0.0.1:1611

connected.

SQL> select * from cao.view1;

ID
------------

0 rows fetched.

SQL> conn / as  sysdba

connected.

SQL> drop user if exists cao cascade ;

Succeed.

SQL> drop user if exists cao1 cascade ;

Succeed.

SQL> drop user if exists cao2 cascade ;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists cao cascade;

Succeed.

SQL> drop user if exists cao1 cascade;

Succeed.

SQL> drop user if exists cao2 cascade;

Succeed.

SQL> create user cao identified by cao102_cao;

Succeed.

SQL> create user cao1 identified by cao102_cao;

Succeed.

SQL> create user cao2 identified by cao102_cao;

Succeed.

SQL> grant connect , create table  to cao;

Succeed.

SQL> conn cao/cao102_cao@127.0.0.1:1611

connected.

SQL> create table tt (id int);

Succeed.

SQL> grant  select on tt to cao1;

Succeed.

SQL> grant  select on cao1.tt to cao2;

CT-01001, Permissions were insufficient
SQL> grant  select on cao1.tt to cao3;

CT-01001, Permissions were insufficient
SQL> grant  connect to cao3;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop user if exists cao cascade;

Succeed.

SQL> drop user if exists cao1 cascade;

Succeed.

SQL> drop user if exists cao2 cascade;

Succeed.

SQL> conn / as  sysdba

connected.

SQL> CREATE USER cao1 IDENTIFIED BY Cantian_234;

Succeed.

SQL> GRANT create session to cao1;

Succeed.

SQL> CONN cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> DROP TABLE USER3.TB_T1;

CT-01001, Permissions were insufficient
SQL> DROP VIEW USER3.VIEW_T1;

CT-01001, Permissions were insufficient
SQL> drop role hello;

CT-01001, Permissions were insufficient
SQL> alter user helllo account unlock;

CT-01001, Permissions were insufficient
SQL> conn / as  sysdba

connected.

SQL> DROP USER if exists cao1 cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists cao cascade;

Succeed.

SQL> create user cao identified by cao102_cao;

Succeed.

SQL> grant connect , create table to cao;

Succeed.

SQL> conn cao/cao102_cao@127.0.0.1:1611

connected.

SQL> select * from dv_transactions;

CT-01001, Permissions were insufficient
SQL> select * from dv_all_trans;

CT-01001, Permissions were insufficient
SQL> select * from dv_global_transactions;

CT-01001, Permissions were insufficient
SQL> create table cao_t1 as select * from dv_global_transactions;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> grant select any table to cao;

Succeed.

SQL> conn cao/cao102_cao@127.0.0.1:1611

connected.

SQL> create table cao_t1 as select * from dv_global_transactions;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists cao cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists B1 cascade;

Succeed.

SQL> drop user if exists A1 cascade;

Succeed.

SQL> create user B1 identified by Cantian_234;

Succeed.

SQL> create user A1 identified by Cantian_234;

Succeed.

SQL> grant connect,create any table,CREATE ANY PROCEDURE to B1;

Succeed.

SQL> grant alter session,connect to A1;

Succeed.

SQL> conn B1/Cantian_234@127.0.0.1:1611

connected.

SQL> drop table sections;

CT-00843, The table or view B1.SECTIONS does not exist.
SQL> CREATE  TABLE sections
  2 (
  3   section_id   NUMBER(4) not null,
  4   section_name VARCHAR2(30),
  5   manager_id   NUMBER(6),
  6   place_id     NUMBER(4)
  7 ) ;

Succeed.

SQL> insert into  sections (section_id, section_name, manager_id, place_id) values (10, 'Administration', 200, 1700);

1 rows affected.

SQL> select * from sections;

SECTION_ID                               SECTION_NAME                   MANAGER_ID                               PLACE_ID
---------------------------------------- ------------------------------ ---------------------------------------- ----------------------------------------
10                                       Administration                 200                                      1700

1 rows fetched.

SQL> commit;

Succeed.

SQL> conn A1/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from B1.sections;

CT-01001, Permissions were insufficient
SQL> ALTER SESSION  set  current_schema = B1;

Succeed.

SQL> select * from sections;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop user if exists B1 cascade;

Succeed.

SQL> drop user if exists A1 cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists B cascade;

Succeed.

SQL> create user B identified by Cantian_234;

Succeed.

SQL> grant all to B;

Succeed.

SQL> drop user if exists A cascade;

Succeed.

SQL> create user A identified by Cantian_234;

Succeed.

SQL> grant connect to A;

Succeed.

SQL> conn B/Cantian_234@127.0.0.1:1611

connected.

SQL> CREATE SEQUENCE seq_auto_extend START WITH 10 MAXVALUE 200 INCREMENT BY 2 CYCLE;

Succeed.

SQL> conn / as sysdba

connected.

SQL> grant select on B.sections_view to A;

CT-00828, object B.SECTIONS_VIEW does not exist
SQL> conn A/Cantian_234@127.0.0.1:1611

connected.

SQL> select B.seq_auto_extend.nextval from dual;

CT-01001, Permissions were insufficient
SQL> conn B/Cantian_234@127.0.0.1:1611

connected.

SQL> DROP SEQUENCE IF EXISTS B.seq_auto_extend;

Succeed.

SQL> conn A/Cantian_234@127.0.0.1:1611

connected.

SQL> select B.seq_auto_extend.nextval from dual;

CT-01001, [1:8]Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> grant select any sequence to A;

Succeed.

SQL> conn A/Cantian_234@127.0.0.1:1611

connected.

SQL> select B.seq_auto_extend.nextval from dual;

CT-00848, [1:8]The sequence B.SEQ_AUTO_EXTEND does not exist.
SQL> conn / as sysdba

connected.

SQL> drop user if exists A cascade;

Succeed.

SQL> drop user if exists B cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists cao2 cascade;

Succeed.

SQL> drop user if exists cao1 cascade;

Succeed.

SQL> create user cao2 identified by Cantian_234;

Succeed.

SQL> create user cao1 identified by Cantian_234;

Succeed.

SQL> grant connect,create any table to cao2;

Succeed.

SQL> grant connect to cao1;

Succeed.

SQL> conn  cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> create table cao2.t1(id int);

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> grant connect,create any table to cao1;

Succeed.

SQL> conn  cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> create table cao2.t1(id int);

Succeed.

SQL> conn / as sysdba

connected.

SQL> revoke create any table from cao1;

Succeed.

SQL> conn  cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> create table cao2.t1(id int);

CT-01001, Permissions were insufficient
SQL> conn  cao2/Cantian_234@127.0.0.1:1611

connected.

SQL> drop table cao2.t1;

Succeed.

SQL> conn  cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> create table cao2.t1(id int);

CT-01001, Permissions were insufficient
SQL> select * from cao2.t1;

CT-01001, [1:15]Permissions were insufficient
SQL> drop table cao2.t1;

CT-01001, Permissions were insufficient
SQL> insert into cao2.t1 values (10);

CT-01001, [1:13]Permissions were insufficient
SQL> delete from cao2.t1;

CT-01001, [1:13]Permissions were insufficient
SQL> alter table cao2.t1 add column name char(10) ;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> grant create any table to cao1;

Succeed.

SQL> grant select any table to cao1;

Succeed.

SQL> grant drop any table to cao1;

Succeed.

SQL> grant insert any table to cao1;

Succeed.

SQL> grant delete any table to cao1;

Succeed.

SQL> grant alter any table to cao1;

Succeed.

SQL> conn  cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from cao2.t1;

CT-00843, [1:15]The table or view CAO2.T1 does not exist.
SQL> drop table cao2.t1;

CT-00843, The table or view CAO2.T1 does not exist.
SQL> insert into cao2.t1 values (10);

CT-00843, [1:13]The table or view CAO2.T1 does not exist.
SQL> delete from cao2.t1;

CT-00843, [1:13]The table or view CAO2.T1 does not exist.
SQL> alter table cao2.t1 add column name char(10) ;

CT-00843, The table or view CAO2.T1 does not exist.
SQL> create table cao2.t1(id int);

Succeed.

SQL> select * from cao2.t1;

ID
------------

0 rows fetched.

SQL> insert into cao2.t1 values (10);

1 rows affected.

SQL> delete from cao2.t1;

1 rows affected.

SQL> alter table cao2.t1 add column name char(10) ;

Succeed.

SQL> drop table cao2.t1;

Succeed.

SQL> create table cao2.t1(id int);

Succeed.

SQL> create index if not exists cao2.inxt1 on cao2.t1(id);

CT-01001, Permissions were insufficient
SQL> create index  cao2.inxt1 on cao2.t1(id);

CT-01001, Permissions were insufficient
SQL> drop index if exists cao2.inxt1 on cao2.t1;

CT-01001, Permissions were insufficient
SQL> drop index  cao2.inxt1 on cao2.t1;

CT-01001, Permissions were insufficient
SQL> alter index cao2.inxt1 on cao2.t1 rebuild online;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> revoke create any table from cao1;

Succeed.

SQL> revoke select any table from cao1;

Succeed.

SQL> revoke drop any table from cao1;

Succeed.

SQL> revoke insert any table from cao1;

Succeed.

SQL> revoke delete any table from cao1;

Succeed.

SQL> revoke alter any table from cao1;

Succeed.

SQL> grant create any index to cao1;

Succeed.

SQL> grant drop any index to cao1;

Succeed.

SQL> grant alter any index to cao1;

Succeed.

SQL> conn  cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> drop index if exists cao2.inxt1 on cao2.t1;

Succeed.

SQL> drop index  cao2.inxt1 on cao2.t1;

CT-00830, Index CAO2.INXT1 does not exist
SQL> alter index cao2.inxt1 on cao2.t1 rebuild online;

CT-00830, Index CAO2.INXT1 does not exist
SQL> create index if not exists cao2.inxt1 on cao2.t1(id);

Succeed.

SQL> create index  cao2.inxt1 on cao2.t1(id);

CT-00726, The column has been indexed by INXT1.
SQL> conn / as sysdba

connected.

SQL> revoke create any index from cao1;

Succeed.

SQL> revoke drop any index from cao1;

Succeed.

SQL> revoke alter any index from cao1;

Succeed.

SQL> conn  cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> create index if not exists cao2.inxt1 on cao2.t1(id);

CT-01001, Permissions were insufficient
SQL> create index  cao2.inxt1 on cao2.t1(id);

CT-01001, Permissions were insufficient
SQL> drop index if exists cao2.inxt1 on cao2.t1;

CT-01001, Permissions were insufficient
SQL> drop index  cao2.inxt1 on cao2.t1;

CT-01001, Permissions were insufficient
SQL> alter index cao2.inxt1 on cao2.t1 rebuild online;

CT-01001, Permissions were insufficient
SQL> create sequence cao2.sq;

CT-01001, Permissions were insufficient
SQL> drop   sequence cao2.sq;

CT-01001, Permissions were insufficient
SQL> alter  sequence cao2.sq  cycle;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> grant create any sequence to cao1;

Succeed.

SQL> grant drop any sequence to cao1;

Succeed.

SQL> grant alter any sequence to cao1;

Succeed.

SQL> conn  cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> drop   sequence cao2.sq;

CT-00848, The sequence CAO2.SQ does not exist.
SQL> alter  sequence cao2.sq  cycle;

CT-00848, The sequence CAO2.SQ does not exist.
SQL> create sequence cao2.sq;

Succeed.

SQL> drop   sequence cao2.sq;

Succeed.

SQL> alter  sequence cao2.sq  cycle;

CT-00848, The sequence CAO2.SQ does not exist.
SQL> conn / as sysdba

connected.

SQL> drop table cao2.t1;

Succeed.

SQL> grant select on cao2.t1 to cao1;

CT-00828, object CAO2.T1 does not exist
SQL> conn  cao1/Cantian_234@127.0.0.1:1611

connected.

SQL> create synonym cao2.hello0 for cao2.t1;

CT-01001, Permissions were insufficient
SQL> create synonym hello1 for cao2.t1;

CT-01001, Permissions were insufficient
SQL> drop synonym cao2.hello0;

CT-01001, Permissions were insufficient
SQL> drop synonym hello1;

CT-00724, Synonym CAO1.HELLO1 does not exist
SQL> COMMENT ON COLUMN cao2.training.staff_id  IS 'id of staffs taking training courses';

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop user if exists cao2 cascade;

Succeed.

SQL> drop user if exists cao1 cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> create user cao7 identified by Cantian_234;

Succeed.

SQL> grant create session to cao7;

Succeed.

SQL> conn cao7/Cantian_234@127.0.0.1:1611

connected.

SQL> SELECT DBE_DIAGNOSE.DBA_IND_POS('2,3,1,0,4','4') from dual;

CT-01001, [1:8]Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> grant EXECUTE ON sys.DBE_DIAGNOSE to cao7;

Succeed.

SQL> conn cao7/Cantian_234@127.0.0.1:1611

connected.

SQL> SELECT DBE_DIAGNOSE.DBA_IND_POS('2,3,1,0,4','4')     from dual;

DBE_DIAGNOSE.DBA_IND_POS('2,3,1,0,4','4')
-----------------------------------------
5                                        

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> revoke  EXECUTE ON sys.DBE_DIAGNOSE from  cao7;

Succeed.

SQL> conn cao7/Cantian_234@127.0.0.1:1611

connected.

SQL> SELECT DBE_DIAGNOSE.DBA_IND_POS('2,3,1,0,4','4')     from dual;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> grant EXECUTE ON sys.DBE_DIAGNOSE to cao7;

Succeed.

SQL> conn cao7/Cantian_234@127.0.0.1:1611

connected.

SQL> SELECT DBE_DIAGNOSE.DBA_IND_POS('2,3,1,0,4','4')     from dual;

DBE_DIAGNOSE.DBA_IND_POS('2,3,1,0,4','4')
-----------------------------------------
5                                        

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> drop user cao7 cascade;

Succeed.

SQL> create user cao7 identified by Cantian_234;

Succeed.

SQL> grant create session to cao7;

Succeed.

SQL> conn cao7/Cantian_234@127.0.0.1:1611

connected.

SQL> SELECT DBE_DIAGNOSE.DBA_IND_POS('2,3,1,0,4','4')     from dual;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop user cao7 cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> create user user1 identified by Changeme_123;

Succeed.

SQL> grant connect to user1;

Succeed.

SQL> create table table_sys(name varchar(10),id int);

Succeed.

SQL> insert into table_sys values('cao',10);

1 rows affected.

SQL> grant create any trigger to user1;

Succeed.

SQL> grant create any table to user1;

Succeed.

SQL> CREATE OR REPLACE TRIGGER t_trigger BEFORE UPDATE ON sys.table_sys FOR EACH ROW AS
  2 BEGIN
  3     dbe_output.print_line('BEFORE table_sys');
  4 END;
  5 /

Succeed.

SQL> CREATE OR REPLACE TRIGGER user1.t_trigger BEFORE UPDATE ON sys.table_sys FOR EACH ROW AS
  2 BEGIN
  3     dbe_output.print_line('BEFORE table_sys');
  4 END;
  5 /

CT-00601, Sql syntax error: cannot create triggers on objects owned by sys
SQL> conn user1/Changeme_123@127.0.0.1:1611

connected.

SQL> CREATE OR REPLACE TRIGGER t_trigger BEFORE UPDATE ON sys.table_sys FOR EACH ROW AS
  2 BEGIN
  3     dbe_output.print_line('BEFORE table_sys');
  4 END;
  5 /

CT-00601, Sql syntax error: cannot create triggers on objects owned by sys
SQL> CREATE OR REPLACE TRIGGER sys.t_trigger BEFORE UPDATE ON sys.table_sys FOR EACH ROW AS
  2 BEGIN
  3     dbe_output.print_line('BEFORE table_sys');
  4 END;
  5 /

CT-01001, Permissions were insufficient
SQL> create table u_t1(name varchar(10),id int);

Succeed.

SQL> insert into u_t1 values('cao',10);

1 rows affected.

SQL> CREATE OR REPLACE TRIGGER sys.t_trigger1 BEFORE UPDATE ON u_t1 FOR EACH ROW AS
  2 BEGIN
  3     dbe_output.print_line('BEFORE table_sys');
  4 END;
  5 /

CT-01001, Permissions were insufficient
SQL> CREATE OR REPLACE TRIGGER t_trigger1 BEFORE UPDATE ON u_t1 FOR EACH ROW AS
  2 BEGIN
  3     dbe_output.print_line('BEFORE table_sys');
  4 END;
  5 /

Succeed.

SQL> CREATE OR REPLACE TRIGGER t_trigger1 BEFORE UPDATE ON sys.table_sys FOR EACH ROW AS
  2 BEGIN
  3     dbe_output.print_line('BEFORE table_sys');
  4 END;
  5 /

CT-00601, Sql syntax error: cannot create triggers on objects owned by sys
SQL> select name from  all_source where name like '%TRIGG%';

NAME                                                            
----------------------------------------------------------------
T_TRIGGER1                                                      

1 rows fetched.

SQL> drop table u_t1;

Succeed.

SQL> conn / as sysdba

connected.

SQL> update table_sys set name='aa';

1 rows affected.

SQL> drop table table_sys;

Succeed.

SQL> drop user user1 cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> create user cao7 identified by Cantian_234;

Succeed.

SQL> grant create session to cao7;       

Succeed.

SQL> conn cao7/Cantian_234@127.0.0.1:1611

connected.

SQL> SELECT DBE_DIAGNOSE.DBA_IND_POS('2,3,1,0,4','4') from dual;     

CT-01001, [1:8]Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> SELECT DBE_DIAGNOSE.DBA_IND_POS('2,3,1,0,4','4')  from dual;

DBE_DIAGNOSE.DBA_IND_POS('2,3,1,0,4','4')
-----------------------------------------
5                                        

1 rows fetched.

SQL> create user cao6 identified by Cantian_234;

Succeed.

SQL> grant create session to cao6;

Succeed.

SQL> grant dba to cao6;

Succeed.

SQL> conn cao6/Cantian_234@127.0.0.1:1611

connected.

SQL> SELECT DBE_DIAGNOSE.DBA_IND_POS('2,3,1,0,4','4')   from dual;

CT-01001, [1:8]Permissions were insufficient
SQL> grant EXECUTE ON sys.DBE_DIAGNOSE to cao7;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> revoke dba from cao6;

Succeed.

SQL> grant EXECUTE ON DBE_DIAGNOSE to cao6;

Succeed.

SQL> conn cao6/Cantian_234@127.0.0.1:1611

connected.

SQL> SELECT DBE_DIAGNOSE.DBA_IND_POS('2,3,1,0,4','4')     from dual;

DBE_DIAGNOSE.DBA_IND_POS('2,3,1,0,4','4')
-----------------------------------------
5                                        

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> drop user cao6 cascade;

Succeed.

SQL> drop user cao7 cascade;

Succeed.

SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> create user cao identified by cao102_cao;

Succeed.

SQL> grant dba  to cao;

Succeed.

SQL> conn cao/cao102_cao@127.0.0.1:1611

connected.

SQL> SELECT OWNER FROM sys.dba_tables order by OWNER limit 1;

OWNER                                                           
----------------------------------------------------------------
SYS                                                             

1 rows fetched.

SQL> create table pri_t1 (id int,name char);

Succeed.

SQL> create view view_pri_t1 as select id  from pri_t1;

Succeed.

SQL> insert into pri_t1 values (10, 'd');

1 rows affected.

SQL> create public synonym syn_view_pri_t1 for cao.view_pri_t1;

Succeed.

SQL> select * from syn_view_pri_t1;

ID          
------------
10          

1 rows fetched.

SQL> select * from cao.view_pri_t1;

ID          
------------
10          

1 rows fetched.

SQL> select id  from (select * from pri_t1 );

ID          
------------
10          

1 rows fetched.

SQL> drop public synonym syn_view_pri_t1;

Succeed.

SQL> drop view view_pri_t1;

Succeed.

SQL> drop table pri_t1;

Succeed.

SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> drop user cao cascade;

Succeed.

SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> create user cao1 identified by cao102_cao;

Succeed.

SQL> grant connect ,create any table ,create any view  to cao1;

Succeed.

SQL> create  view abc as select DBE_DIAGNOSE.dba_user_name(0) from dual;

Succeed.

SQL> create  view cao1.abc as select DBE_DIAGNOSE.dba_user_name(0) from dual;

Succeed.

SQL> select owner,table_name,table_id from all_tables where table_name='SYS_TABLES';

OWNER                                                            TABLE_NAME                                                       TABLE_ID    
---------------------------------------------------------------- ---------------------------------------------------------------- ------------
SYS                                                              SYS_TABLES                                                       0           

1 rows fetched.

SQL> select DBE_DIAGNOSE.dba_user_name(0) from dual;

DBE_DIAGNOSE.DBA_USER_NAME(0)                                   
----------------------------------------------------------------
SYS                                                             

1 rows fetched.

SQL> select DBE_DIAGNOSE.dba_space_name(0) from dual;

DBE_DIAGNOSE.DBA_SPACE_NAME(0)                                  
----------------------------------------------------------------
SYSTEM                                                          

1 rows fetched.

SQL> conn cao1/cao102_cao@127.0.0.1:1611

connected.

SQL> select * from cao1.abc;

CT-00600, View ABC has errors
SQL> select * from sys.abc;

CT-01001, Permissions were insufficient
SQL> select DBE_DIAGNOSE.dba_user_name(0) from dual;

CT-01001, [1:8]Permissions were insufficient
SQL> select DBE_DIAGNOSE.dba_space_name(0) from dual;

CT-01001, [1:8]Permissions were insufficient
SQL> create  view abc as select DBE_DIAGNOSE.dba_user_name(0) from dual; 

CT-01001, [1:26]Permissions were insufficient
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> drop user cao1 cascade;

Succeed.

SQL> drop view abc;

Succeed.

SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> create table table_sys(name varchar(50));

Succeed.

SQL> CREATE OR REPLACE TRIGGER TRIGGER_sys
  2    after delete
  3    ON table_sys
  4    FOR EACH ROW
  5 BEGIN
  6    INSERT INTO table_sys(name)
  7        VALUES(:new.name);
  8 END;
  9 /

Succeed.

SQL> create user tri_user1 identified by Changeme_123;

Succeed.

SQL> grant ALTER ANY TRIGGER to tri_user1;

Succeed.

SQL> grant create session to tri_user1;

Succeed.

SQL> conn tri_user1/Changeme_123@127.0.0.1:1611

connected.

SQL> alter TRIGGER sys.TRIGGER_sys disable;

CT-01001, Permissions were insufficient
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> drop user tri_user1 cascade;

Succeed.

SQL> drop TRIGGER TRIGGER_sys;

Succeed.

SQL> drop table table_sys;

Succeed.

SQL> conn / as sysdba

connected.

SQL> create user cao_1 identified by Cantian_234;

Succeed.

SQL> grant create session,create table to cao_1;

Succeed.

SQL> create user cao_2 identified by Cantian_234;

Succeed.

SQL> grant create session,GRANT ANY OBJECT PRIVILEGE to cao_2;

Succeed.

SQL> create user cao_3 identified by Cantian_234;

Succeed.

SQL> grant create session,create table to cao_3;

Succeed.

SQL> conn cao_1/Cantian_234@127.0.0.1:1611

connected.

SQL> create table caot_1(id int);

Succeed.

SQL> insert into caot_1 values(10);

1 rows affected.

SQL> commit;

Succeed.

SQL> conn cao_2/Cantian_234@127.0.0.1:1611

connected.

SQL> grant select on cao_1.caot_1 to cao_3;

Succeed.

SQL> grant select on cao_1.caot_1 to cao_2;

CT-01005, [1:38]Users cannot grant permissions to or revoke permissions from themselves
SQL> select * from cao_1.caot_1;

CT-01001, Permissions were insufficient
SQL> conn cao_3/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from cao_1.caot_1;

ID          
------------
10          

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> drop user cao_1 cascade;

Succeed.

SQL> drop user cao_2 cascade;

Succeed.

SQL> drop user cao_3 cascade;

Succeed.

SQL> --DTS2019020108501
SQL> create user jie_1 identified by Cantian_234;

Succeed.

SQL> grant create session,CREATE ANY TABLE to jie_1;

Succeed.

SQL> create user jie_2 identified by Cantian_234;

Succeed.

SQL> grant create session,CREATE ANY TABLE,CREATE ANY TRIGGER to jie_2;

Succeed.

SQL> create user jie_3 identified by Cantian_234;

Succeed.

SQL> grant create session,CREATE ANY TABLE to jie_3;

Succeed.

SQL> create user jie_4 identified by Cantian_234;

Succeed.

SQL> grant create session,CREATE ANY TABLE to jie_4;

Succeed.

SQL> 
SQL> conn jie_1/Cantian_234@127.0.0.1:1611

connected.

SQL> create table jiet_1(id int);

Succeed.

SQL> insert into jiet_1 values (10);

1 rows affected.

SQL> grant insert on jiet_1 to jie_2;

Succeed.

SQL> conn jie_2/Cantian_234@127.0.0.1:1611

connected.

SQL> create table jiet_2(id int);

Succeed.

SQL> insert into jiet_2 values (20);

1 rows affected.

SQL> grant insert on jiet_2 to jie_3;

Succeed.

SQL>  create table jiet_2_1(id int);

Succeed.

SQL> insert into jiet_2_1 values (30);

1 rows affected.

SQL> grant insert on jiet_2_1 to jie_3;

Succeed.

SQL> CREATE OR REPLACE TRIGGER TRIGGER_jie_2_2
  2    after insert
  3    ON jiet_2
  4    FOR EACH ROW
  5 BEGIN
  6    INSERT INTO jiet_2_1(id)
  7        VALUES(100);
  8 END;
  9 / 

Succeed.

SQL> conn jie_3/Cantian_234@127.0.0.1:1611

connected.

SQL> insert into jie_2.jiet_2 values (300); 

1 rows affected.

SQL> commit;  

Succeed.

SQL> conn jie_4/Cantian_234@127.0.0.1:1611

connected.

SQL> insert into jie_2.jiet_2 values (400);

CT-01001, Permissions were insufficient
SQL> commit;

Succeed.

SQL> conn jie_2/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from jiet_2;

ID          
------------
20          
300         

2 rows fetched.

SQL> select * from jiet_2_1;

ID          
------------
30          
100         

2 rows fetched.

SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> drop user jie_1 cascade; 

Succeed.

SQL> drop user jie_2 cascade; 

Succeed.

SQL> drop user jie_3 cascade; 

Succeed.

SQL> drop user jie_4 cascade;

Succeed.

SQL> --DTS2019020205034
SQL> conn / as sysdba

connected.

SQL> create user cao_seq1 identified by Cantian_234;

Succeed.

SQL> grant create session,create any SEQUENCE to cao_seq1;

Succeed.

SQL> conn cao_seq1/Cantian_234@127.0.0.1:1611

connected.

SQL> create sequence alter_seq1 MAXVALUE 100 INCREMENT BY 1 START WITH 1 CACHE 20;

Succeed.

SQL> ALTER SEQUENCE alter_seq1 MAXVALUE 10000 INCREMENT BY 4 CYCLE;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user cao_seq1 cascade;

Succeed.

SQL> --DTS2019010204140
SQL> conn / as sysdba

connected.

SQL> create user bigcao identified by Cantian_234;

Succeed.

SQL> grant create session,create table,ALTER ANY TABLE,DROP ANY TABLE,FLASHBACK ANY TABLE,LOCK ANY TABLE,SELECT ANY TABLE,COMMENT ANY TABLE,UPDATE ANY TABLE,INSERT ANY TABLE,DELETE ANY TABLE,EXECUTE ANY PROCEDURE to bigcao;

Succeed.

SQL> create or replace PROCEDURE PROCEDURE_0121 is
  2 begin
  3 null;
  4 end;
  5 /

Succeed.

SQL> create table privi_bigtab(name varchar(2048));

Succeed.

SQL> insert into privi_bigtab values('xiaoming');

1 rows affected.

SQL> select name from sys.privi_bigtab;

NAME                                                            
----------------------------------------------------------------
xiaoming                                                        

1 rows fetched.

SQL> ALTER TABLE privi_bigtab MODIFY(name CONSTRAINT namefeikong NOT NULL);

Succeed.

SQL> create table privi_hua(id int);

Succeed.

SQL> grant  select on privi_hua to bigcao;

Succeed.

SQL> grant delete on privi_hua to bigcao;

Succeed.

SQL> grant update on privi_hua to bigcao;

Succeed.

SQL> grant insert on privi_hua to bigcao;

Succeed.

SQL> conn bigcao/Cantian_234@127.0.0.1:1611

connected.

SQL> --privilege for one object
SQL> select * from sys.privi_hua;

ID          
------------

0 rows fetched.

SQL> insert into sys.privi_hua values(10);

1 rows affected.

SQL> exec sys.PROCEDURE_0121;

CT-00944, PL/SQL(BIGCAO.ANONYMOUS BLOCK) terminated with compiling errors
[1:2] PLC-01001 Permissions were insufficient

SQL> update  sys.privi_hua set id =20 where id=10;

1 rows affected.

SQL> select * from sys.privi_hua;

ID          
------------
20          

1 rows fetched.

SQL> --privilege for any object
SQL> insert into sys.privi_bigtab values('xiaozhang');

CT-01001, Permissions were insufficient
SQL> update sys.privi_bigtab set name='xiaoyu' where name='xiaoming';

CT-01001, Permissions were insufficient
SQL> delete from sys.privi_bigtab;

CT-01001, Permissions were insufficient
SQL> LOCK TABLE sys.privi_bigtab IN SHARE MODE;

CT-01001, Permissions were insufficient
SQL> LOCK TABLE sys.privi_bigtab IN EXCLUSIVE MODE;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop user bigcao CASCADE;

Succeed.

SQL> drop table privi_bigtab;

Succeed.

SQL> drop table privi_hua;

Succeed.

SQL> ---procedure        
SQL> conn / as sysdba 

connected.

SQL> create user zzy identified by zzy102_zzy  ;              

Succeed.

SQL> grant connect to zzy;

Succeed.

SQL> grant create any table to zzy;

Succeed.

SQL> grant create public synonym to zzy;

Succeed.

SQL> grant create any synonym to zzy;

Succeed.

SQL> grant drop any procedure to zzy;

Succeed.

SQL> grant drop public synonym to zzy;

Succeed.

SQL> grant create any table to zzy;

Succeed.

SQL> grant drop any table to zzy;

Succeed.

SQL> create table test_tab1 (id int);

Succeed.

SQL> create public synonym pub_test_syn for test_tab1;

Succeed.

SQL> create synonym  pub_test_syn1 for test_tab1;

Succeed.

SQL> 
SQL> conn zzy/zzy102_zzy@127.0.0.1:1611 

connected.

SQL> drop public synonym pub_test_syn;-----keyi 

Succeed.

SQL> drop synonym sys.pub_test_syn1;-----bukeyi

CT-01001, Permissions were insufficient
SQL> create table test_tab2(id int);

Succeed.

SQL> create public synonym pub_test_syn3 for test_tab2;--keyi

Succeed.

SQL> create synonym sys.pub_test_syn4 for test_tab2;--bukeyi

CT-01001, Permissions were insufficient
SQL> drop public synonym pub_test_syn3;

Succeed.

SQL> drop table test_tab2;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop synonym sys.pub_test_syn1;

Succeed.

SQL> drop table test_tab1;

Succeed.

SQL> ---procedure
SQL> conn / as sysdba

connected.

SQL> grant create any procedure to zzy;

Succeed.

SQL> grant drop any procedure to zzy;

Succeed.

SQL> drop table if exists plsql_t1;

Succeed.

SQL> create table plsql_t1 (f1 int, f2 varchar(100));

Succeed.

SQL> insert into plsql_t1 values (1, 'a'), (2, 'b'), (3, 'c');

3 rows affected.

SQL> commit;

Succeed.

SQL> create or replace procedure plsql_p1()
  2 as
  3 a int := 10;
  4 c4 SYS_REFCURSOR;
  5 begin
  6 open c4 for select * from plsql_t1 where f1 < a order by f1;
  7 dbe_sql.return_cursor(c4);
  8 end;
  9 /

Succeed.

SQL> conn zzy/zzy102_zzy@127.0.0.1:1611

connected.

SQL> drop procedure sys.plsql_p1;

CT-01001, Permissions were insufficient
SQL> drop table if exists plsql_t2;

Succeed.

SQL> create table plsql_t2 (f1 int, f2 varchar(100));

Succeed.

SQL> insert into plsql_t2 values (1, 'a'), (2, 'b'), (3, 'c');

3 rows affected.

SQL> commit;

Succeed.

SQL> create procedure sys.plsql_p2()
  2 as
  3 a int := 10;
  4 c4 SYS_REFCURSOR;
  5 begin
  6 open c4 for select * from plsql_t2 where f1 < a order by f1;
  7 dbe_sql.return_cursor(c4);
  8 end;
  9 /

CT-01001, Permissions were insufficient
SQL> drop table plsql_t2;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop procedure sys.plsql_p1;

Succeed.

SQL> drop table plsql_t1;

Succeed.

SQL> ---trigger
SQL> conn / as sysdba

connected.

SQL> grant create any trigger to zzy;

Succeed.

SQL> grant drop any trigger to zzy;

Succeed.

SQL> create table tri_tab1(id int );

Succeed.

SQL> create table tri_tab2(id int );

Succeed.

SQL> CREATE OR REPLACE TRIGGER TRIG_BEFORE_INSERT
  2  BEFORE INSERT ON tri_tab1 
  3  BEGIN 
  4  INSERT INTO tri_tab2 VALUES(7);
  5  END;
  6  /

Succeed.

SQL> INSERT INTO tri_tab1 VALUES(2); 

1 rows affected.

SQL> select * from  tri_tab1;

ID          
------------
2           

1 rows fetched.

SQL> select * from  tri_tab2;

ID          
------------
7           

1 rows fetched.

SQL> conn zzy/zzy102_zzy@127.0.0.1:1611

connected.

SQL> create table tri_tab11(id int );

Succeed.

SQL> create table tri_tab21(id int );

Succeed.

SQL> drop TRIGGER sys.TRIG_BEFORE_INSERT;

CT-01001, Permissions were insufficient
SQL> CREATE OR REPLACE TRIGGER sys.TRIG_BEFORE_INSERT1
  2  BEFORE INSERT ON zzy.tri_tab11 
  3  BEGIN 
  4  INSERT INTO zzy.tri_tab21 VALUES(7);
  5  END;
  6  /

CT-01001, Permissions were insufficient
SQL> INSERT INTO tri_tab11 VALUES(2); 

1 rows affected.

SQL> select * from  tri_tab11;

ID          
------------
2           

1 rows fetched.

SQL> select * from  tri_tab21;

ID          
------------

0 rows fetched.

SQL> drop table tri_tab11;

Succeed.

SQL> drop table tri_tab21;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop table tri_tab1;

Succeed.

SQL> drop table tri_tab2;

Succeed.

SQL> drop TRIGGER sys.TRIG_BEFORE_INSERT;

CT-00828, trigger SYS.TRIG_BEFORE_INSERT does not exist
SQL> -----FUNCTION
SQL> conn / as sysdba

connected.

SQL> grant create any FUNCTION to zzy;

CT-00601, [1:7]Sql syntax error: invalid privilege or role name
SQL> grant drop any FUNCTION to zzy;

CT-00601, [1:7]Sql syntax error: invalid privilege or role name
SQL> DROP TABLE IF EXISTS PLSQL_T_PROC_1;

Succeed.

SQL> CREATE TABLE PLSQL_T_PROC_1 (F_INT1 INT);

Succeed.

SQL> CREATE OR REPLACE FUNCTION PLSQL_Zenith_Test_Sysdate return varchar2
  2 IS
  3  cunt int := 0;
  4  Begin
  5  select count(*) into cunt from dual;
  6  dbe_output.print_line(cunt);
  7  IF SQL % FOUND
  8   then
  9  return cunt;
 10  end if;
 11  End PLSQL_Zenith_Test_Sysdate;
 12 /

Succeed.

SQL> 
SQL> 
SQL> conn zzy/zzy102_zzy@127.0.0.1:1611

connected.

SQL> drop FUNCTION sys.PLSQL_Zenith_Test_Sysdate;

CT-01001, Permissions were insufficient
SQL> CREATE OR REPLACE FUNCTION sys.PLSQL_Zenith_Test_Sysdate1 return varchar2
  2 IS
  3  cunt int := 0;
  4  Begin
  5  select count(*) into cunt from dual;
  6  dbe_output.print_line(cunt);
  7  IF SQL % FOUND
  8   then
  9  return cunt;
 10  end if;
 11  End PLSQL_Zenith_Test_Sysdate1;
 12 /

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop table PLSQL_T_PROC_1;

Succeed.

SQL> drop FUNCTION sys.PLSQL_Zenith_Test_Sysdate;

Succeed.

SQL> drop user zzy cascade;

Succeed.

SQL> -- TESTCASE: ROLE & SYSTEM PRIVILEGES
SQL> 
SQL> -- create users
SQL> create user user_priv_test_0 identified by Root12345;

Succeed.

SQL> create user user_priv_test_1 identified by Root12345;

Succeed.

SQL> create user user_priv_test_2 identified by Root12345;

Succeed.

SQL> create user user_priv_test_3 identified by Root12345;

Succeed.

SQL> 
SQL> -- create roles
SQL> create role role_priv_test_0 identified by Root12345;

Succeed.

SQL> create role role_priv_test_1 identified by Root12345;

Succeed.

SQL> create role role_priv_test_2 identified by Root12345;

Succeed.

SQL> create role role_priv_test_3 identified by Root12345;

Succeed.

SQL> create role role_priv_test_4 identified by Root12345;

Succeed.

SQL> create role role_priv_test_5 identified by Root12345;

Succeed.

SQL> create role role_priv_test_6 identified by Root12345;

Succeed.

SQL> 
SQL> -- duplicated name test
SQL> create user role_priv_test_0 identified by Root12345;

CT-00753, The object role ROLE_PRIV_TEST_0 already exists.
SQL> create user user_priv_test_0 identified by Root12345;

CT-00753, The object user USER_PRIV_TEST_0 already exists.
SQL> create role user_priv_test_0 identified by Root12345;

CT-00753, The object user USER_PRIV_TEST_0 already exists.
SQL> create role role_priv_test_0 identified by Root12345;

CT-00753, The object role ROLE_PRIV_TEST_0 already exists.
SQL> 
SQL> -- test: privileges test
SQL> create table user_priv_test_1.table_priv_test_1 (id int);

Succeed.

SQL> 
SQL> -- create session
SQL> grant create session to user_priv_test_0;

Succeed.

SQL> connect user_priv_test_0/Root12345@127.0.0.1:1611

connected.

SQL> 
SQL> -- create/drop user
SQL> create user user_priv_test_4 identified by Root12345;

CT-01001, Permissions were insufficient
SQL> drop user user_priv_test_4;

CT-01001, Permissions were insufficient
SQL> 
SQL> -- create/drop role
SQL> create role role_priv_test_7 identified by Root12345;

CT-01001, Permissions were insufficient
SQL> drop role role_priv_test_7;

CT-01001, Permissions were insufficient
SQL> 
SQL> -- alter system 
SQL> alter system kill session '999,0';

CT-01001, Permissions were insufficient
SQL> 
SQL> -- lock table
SQL> lock table user_priv_test_1.table_priv_test_1 in share mode;

CT-01001, Permissions were insufficient
SQL> 
SQL> -- create/drop table
SQL> create table table_priv_test_2 (id int);

CT-01001, Permissions were insufficient
SQL> drop table table_priv_test_2;

CT-00843, The table or view USER_PRIV_TEST_0.TABLE_PRIV_TEST_2 does not exist.
SQL> 
SQL> -- create/drop index
SQL> create index user_priv_test_1.IX_PRIV_TEST_1 ON user_priv_test_1.table_priv_test_1 (id);

CT-01001, Permissions were insufficient
SQL> drop index user_priv_test_1.IX_PRIV_TEST_1 ON user_priv_test_1.table_priv_test_1;

CT-01001, Permissions were insufficient
SQL> 
SQL> -- create/drop/alter sequence
SQL> create sequence PRIV_SEQ_0;

CT-01001, Permissions were insufficient
SQL> drop sequence PRIV_SEQ_0;

CT-00848, The sequence USER_PRIV_TEST_0.PRIV_SEQ_0 does not exist.
SQL> alter sequence PRIV_SEQ_0 start with 1;

CT-00848, The sequence USER_PRIV_TEST_0.PRIV_SEQ_0 does not exist.
SQL> 
SQL> -- create/drop view
SQL> create view PIRV_TEST_VIEW_0 as select * from SYS.SYS_INDEXES;

CT-01001, Permissions were insufficient
SQL> drop view PIRV_TEST_VIEW_0;

CT-00843, The table or view USER_PRIV_TEST_0.PIRV_TEST_VIEW_0 does not exist.
SQL> 
SQL> -- create/drop synonym
SQL> create public synonym PRIV_TEST_SYNONYM_1 for SYS.SYS_TABLES;

CT-01001, Permissions were insufficient
SQL> drop public synonym if exists PRIV_TEST_SYNONYM_1 FORCE;

CT-01001, Permissions were insufficient
SQL> 
SQL> -- TODO: flashback/truncate/purge
SQL> 
SQL> -- grant the privileges and check again
SQL> connect sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant create user, create role, create table to user_priv_test_0;

Succeed.

SQL> grant alter system to user_priv_test_0;

Succeed.

SQL> grant lock any table to user_priv_test_0;

Succeed.

SQL> grant drop any table to user_priv_test_0;

Succeed.

SQL> grant drop any index to user_priv_test_0;

Succeed.

SQL> grant drop user to user_priv_test_0;

Succeed.

SQL> grant create sequence to user_priv_test_0;

Succeed.

SQL> grant create view to user_priv_test_0;

Succeed.

SQL> grant create public synonym, drop public synonym to user_priv_test_0;

Succeed.

SQL> 
SQL> -- test again:
SQL> connect user_priv_test_0/Root12345@127.0.0.1:1611

connected.

SQL> 
SQL> -- create/drop user
SQL> create user user_priv_test_4 identified by Root12345;

Succeed.

SQL> drop user user_priv_test_4;

Succeed.

SQL> 
SQL> -- create/drop role
SQL> create role role_priv_test_7 identified by Root12345;

Succeed.

SQL> drop role role_priv_test_7;

Succeed.

SQL> 
SQL> -- alter system 
SQL> alter system kill session '999,0';

CT-00683, The session ID was missing or invalid
SQL> 
SQL> -- lock table
SQL> lock table user_priv_test_1.table_priv_test_1 in share mode;

Succeed.

SQL> 
SQL> -- create/drop table
SQL> create table table_priv_test_2 (id int);

Succeed.

SQL> drop table table_priv_test_2;

Succeed.

SQL> 
SQL> -- create/drop index
SQL> create index user_priv_test_1.IX_PRIV_TEST_1 ON user_priv_test_1.table_priv_test_1 (id);

CT-01001, Permissions were insufficient
SQL> drop index user_priv_test_1.IX_PRIV_TEST_1 ON user_priv_test_1.table_priv_test_1;

CT-00830, Index USER_PRIV_TEST_1.IX_PRIV_TEST_1 does not exist
SQL> 
SQL> -- create/drop/alter sequence
SQL> create sequence PRIV_SEQ_0;

Succeed.

SQL> alter sequence PRIV_SEQ_0 start with 1;

CT-00601, Sql syntax error: cannot alter starting sequence number 
SQL> drop sequence PRIV_SEQ_0;

Succeed.

SQL> 
SQL> -- create/drop view
SQL> create view PIRV_TEST_VIEW_0 as select * from SYS.SYS_INDEXES;

CT-01001, Permissions were insufficient
SQL> drop view PIRV_TEST_VIEW_0;

CT-00843, The table or view USER_PRIV_TEST_0.PIRV_TEST_VIEW_0 does not exist.
SQL> 
SQL> -- create/drop synonym
SQL> create public synonym PRIV_TEST_SYNONYM_1 for SYS.SYS_TABLES;

Succeed.

SQL> drop public synonym if exists PRIV_TEST_SYNONYM_1 FORCE;

Succeed.

SQL> 
SQL> -- grant role to user
SQL> connect sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant create any table to role_priv_test_1;

Succeed.

SQL> grant create any index to role_priv_test_1;

Succeed.

SQL> 
SQL> -- grant role to role (grant role circle check)
SQL> grant role_priv_test_1 to role_priv_test_3;

Succeed.

SQL> grant role_priv_test_2 to role_priv_test_3;

Succeed.

SQL> grant role_priv_test_3 to role_priv_test_4;

Succeed.

SQL> grant role_priv_test_3 to role_priv_test_5;

Succeed.

SQL> grant role_priv_test_3 to user_priv_test_1;

Succeed.

SQL> grant role_priv_test_5 to role_priv_test_6;

Succeed.

SQL> grant role_priv_test_1 to user_priv_test_3;

Succeed.

SQL> 
SQL> -- role circle check
SQL> grant role_priv_test_5 to role_priv_test_1;

CT-01003, Grant role in a circle
SQL> grant role_priv_test_5 to role_priv_test_5;

CT-01003, Grant role in a circle
SQL> 
SQL> -- check data:
SQL> select ID, NAME, DATA_SPACE#, TEMP_SPACE# from SYS_USERS order by ID;

ID           NAME                                                             DATA_SPACE#  TEMP_SPACE# 
------------ ---------------------------------------------------------------- ------------ ------------
0            SYS                                                              0            1           
1            PUBLIC                                                           0            1           
2            USER_PRIV_TEST_0                                                 3            1           
3            USER_PRIV_TEST_1                                                 3            1           
4            USER_PRIV_TEST_2                                                 3            1           
5            USER_PRIV_TEST_3                                                 3            1           

6 rows fetched.

SQL> select ID, OWNER_UID, NAME from SYS_ROLES order by ID;

ID           OWNER_UID    NAME                                                            
------------ ------------ ----------------------------------------------------------------
0            0            DBA                                                             
1            0            RESOURCE                                                        
2            0            CONNECT                                                         
3            0            STATISTICS                                                      
4            0            ROLE_PRIV_TEST_0                                                
5            0            ROLE_PRIV_TEST_1                                                
6            0            ROLE_PRIV_TEST_2                                                
7            0            ROLE_PRIV_TEST_3                                                
8            0            ROLE_PRIV_TEST_4                                                
9            0            ROLE_PRIV_TEST_5                                                
10           0            ROLE_PRIV_TEST_6                                                

11 rows fetched.

SQL> select * from SYS_PRIVS order by GRANTEE_ID, GRANTEE_TYPE, PRIVILEGE;

GRANTEE_ID   GRANTEE_TYPE PRIVILEGE    ADMIN_OPTION
------------ ------------ ------------ ------------
0            0            1            1           
0            0            2            1           
0            0            3            1           
0            0            4            1           
0            0            5            1           
0            0            6            1           
0            0            7            1           
0            0            8            1           
0            0            9            1           
0            0            10           1           
0            0            11           1           
0            0            12           1           
0            0            13           1           
0            0            14           1           
0            0            15           1           
0            0            16           1           
0            0            17           1           
0            0            18           1           
0            0            19           1           
0            0            20           1           
0            0            21           1           
0            0            22           1           
0            0            23           1           
0            0            24           1           
0            0            25           1           
0            0            26           1           
0            0            27           1           
0            0            28           1           
0            0            29           1           
0            0            30           1           
0            0            31           1           
0            0            32           1           
0            0            33           1           
0            0            34           1           
0            0            35           1           
0            0            36           1           
0            0            37           1           
0            0            38           1           
0            0            39           1           
0            0            40           1           
0            0            41           1           
0            0            42           1           
0            0            43           1           
0            0            44           1           
0            0            45           1           
0            0            46           1           
0            0            47           1           
0            0            48           1           
0            0            49           1           
0            0            50           1           
0            0            51           1           
0            0            52           1           
0            0            53           1           
0            0            54           1           
0            0            55           1           
0            0            56           1           
0            0            57           1           
0            0            58           1           
0            0            59           1           
0            0            60           1           
0            0            61           1           
0            0            62           1           
0            0            63           1           
0            0            64           1           
0            0            65           1           
0            0            66           1           
0            0            67           1           
0            0            68           1           
0            0            69           1           
0            0            70           1           
0            0            71           1           
0            0            72           1           
0            0            73           1           
0            0            74           1           
0            0            75           1           
0            0            76           1
0            0            77           1
0            0            78           1           
0            0            79           1 
0            0            80           1
0            0            81           1
0            0            82           1
0            0            83           1           
0            0            84           1           
0            0            85           1           
0            0            86           1
0            0            87           1
0            0            88           1                 
0            0            89           1           
0            0            90           1           
0            0            91           1           
0            0            92           1 
0            0            93           1           
0            0            94           1
0            0            95           1           
0            0            96           1           
0            0            97           1           
0            0            98           1           
0            0            99           1
0            0            100          1
0            0            101          1
0            0            102          1
0            0            103          1           
0            1            1            1           
0            1            2            1           
0            1            3            1           
0            1            4            1           
0            1            5            1           
0            1            6            1           
0            1            7            1           
0            1            8            1           
0            1            9            1           
0            1            10           1           
0            1            11           1           
0            1            12           1           
0            1            13           1           
0            1            14           1           
0            1            15           1           
0            1            16           1           
0            1            17           1           
0            1            18           1           
0            1            19           1           
0            1            20           1           
0            1            21           1           
0            1            22           1           
0            1            23           1           
0            1            24           1           
0            1            25           1           
0            1            26           1           
0            1            27           1           
0            1            28           1           
0            1            29           1           
0            1            30           1           
0            1            31           1           
0            1            32           1           
0            1            33           1           
0            1            34           1           
0            1            35           1           
0            1            36           1           
0            1            37           1           
0            1            38           1           
0            1            39           1           
0            1            40           1           
0            1            41           1           
0            1            42           1           
0            1            43           1           
0            1            44           1           
0            1            45           1           
0            1            46           1           
0            1            47           1           
0            1            48           1           
0            1            49           1           
0            1            50           1           
0            1            51           1           
0            1            52           1           
0            1            53           1           
0            1            54           1           
0            1            55           1           
0            1            56           1           
0            1            57           1           
0            1            58           1           
0            1            59           1           
0            1            60           1           
0            1            61           1           
0            1            62           1           
0            1            63           1           
0            1            64           1           
0            1            65           1           
0            1            66           1           
0            1            67           1           
0            1            68           1           
0            1            69           1           
0            1            70           1           
0            1            71           1           
0            1            72           1           
0            1            73           1           
0            1            74           1           
0            1            75           1           
0            1            76           1
0            1            77           1
0            1            78           1
0            1            79           1       
0            1            80           1 
0            1            81           1
0            1            82           1
0            1            83           1           
0            1            84           1           
0            1            85           1           
0            1            86           1
0            1            87           1
0            1            88           1               
0            1            89           1           
0            1            90           1           
0            1            91           1           
0            1            92           1 
0            1            93           1           
0            1            95           1           
0            1            96           1           
0            1            97           1           
0            1            98           1           
0            1            99           1
0            1            100          1           
0            1            101          1           
0            1            102          1           
0            1            103          1           
1            1            25           0           
1            1            29           0           
1            1            32           0           
1            1            34           0           
2            0            11           0
2            0            27           0                     
2            0            28           0           
2            0            29           0           
2            0            30           0           
2            0            32           0           
2            0            35           0           
2            0            36           0           
2            0            38           0           
2            0            44           0           
2            0            48           0           
2            0            50           0           
2            0            57           0           
2            1            30           0           
5            1            14           0           
5            1            19           0           

225 rows fetched.

SQL> select * from SYS_USER_ROLES order by GRANTEE_ID, GRANTEE_TYPE, GRANTED_ROLE_ID;

GRANTEE_ID   GRANTEE_TYPE GRANTED_ROLE_ID ADMIN_OPTION DEFAULT_ROLE
------------ ------------ --------------- ------------ ------------
0            1            3               0            0           
3            0            7               0            0           
5            0            5               0            0           
7            1            5               0            0           
7            1            6               0            0           
8            1            7               0            0           
9            1            7               0            0           
10           1            9               0            0           

8 rows fetched.

SQL> 
SQL> -- revoke role from role
SQL> revoke role_priv_test_5 from role_priv_test_6;

Succeed.

SQL> 
SQL> -- revoke role from user
SQL> revoke role_priv_test_1 from user_priv_test_3;

Succeed.

SQL> 
SQL> revoke create session from user_priv_test_0;

Succeed.

SQL> 
SQL> -- revoke system privileges from role
SQL> revoke create any table, create any index from role_priv_test_1;

Succeed.

SQL> 
SQL> -- check data
SQL> select ID, NAME, DATA_SPACE#, TEMP_SPACE# from SYS_USERS order by ID;

ID           NAME                                                             DATA_SPACE#  TEMP_SPACE# 
------------ ---------------------------------------------------------------- ------------ ------------
0            SYS                                                              0            1           
1            PUBLIC                                                           0            1           
2            USER_PRIV_TEST_0                                                 3            1           
3            USER_PRIV_TEST_1                                                 3            1           
4            USER_PRIV_TEST_2                                                 3            1           
5            USER_PRIV_TEST_3                                                 3            1           

6 rows fetched.

SQL> select ID, OWNER_UID, NAME from SYS_ROLES order by ID;

ID           OWNER_UID    NAME                                                            
------------ ------------ ----------------------------------------------------------------
0            0            DBA                                                             
1            0            RESOURCE                                                        
2            0            CONNECT                                                         
3            0            STATISTICS                                                      
4            0            ROLE_PRIV_TEST_0                                                
5            0            ROLE_PRIV_TEST_1                                                
6            0            ROLE_PRIV_TEST_2                                                
7            0            ROLE_PRIV_TEST_3                                                
8            0            ROLE_PRIV_TEST_4                                                
9            0            ROLE_PRIV_TEST_5                                                
10           0            ROLE_PRIV_TEST_6                                                

11 rows fetched.

SQL> select * from SYS_PRIVS order by GRANTEE_ID, GRANTEE_TYPE, PRIVILEGE;

GRANTEE_ID   GRANTEE_TYPE PRIVILEGE    ADMIN_OPTION
------------ ------------ ------------ ------------
0            0            1            1           
0            0            2            1           
0            0            3            1           
0            0            4            1           
0            0            5            1           
0            0            6            1           
0            0            7            1           
0            0            8            1           
0            0            9            1           
0            0            10           1           
0            0            11           1           
0            0            12           1           
0            0            13           1           
0            0            14           1           
0            0            15           1           
0            0            16           1           
0            0            17           1           
0            0            18           1           
0            0            19           1           
0            0            20           1           
0            0            21           1           
0            0            22           1           
0            0            23           1           
0            0            24           1           
0            0            25           1           
0            0            26           1           
0            0            27           1           
0            0            28           1           
0            0            29           1           
0            0            30           1           
0            0            31           1           
0            0            32           1           
0            0            33           1           
0            0            34           1           
0            0            35           1           
0            0            36           1           
0            0            37           1           
0            0            38           1           
0            0            39           1           
0            0            40           1           
0            0            41           1           
0            0            42           1           
0            0            43           1           
0            0            44           1           
0            0            45           1           
0            0            46           1           
0            0            47           1           
0            0            48           1           
0            0            49           1           
0            0            50           1           
0            0            51           1           
0            0            52           1           
0            0            53           1           
0            0            54           1           
0            0            55           1           
0            0            56           1           
0            0            57           1           
0            0            58           1           
0            0            59           1           
0            0            60           1           
0            0            61           1           
0            0            62           1           
0            0            63           1           
0            0            64           1           
0            0            65           1           
0            0            66           1           
0            0            67           1           
0            0            68           1           
0            0            69           1           
0            0            70           1           
0            0            71           1           
0            0            72           1           
0            0            73           1           
0            0            74           1           
0            0            75           1           
0            0            76           1
0            0            77           1
0            0            78           1           
0            0            79           1
0            0            80           1 
0            0            81           1
0            0            82           1
0            0            83           1           
0            0            84           1           
0            0            85           1           
0            0            86           1
0            0            87           1
0            0            88           1           
0            0            89           1           
0            0            90           1           
0            0            91           1           
0            0            92           1 
0            0            93           1          
0            0            94           1
0            0            95           1           
0            0            96           1           
0            0            97           1           
0            0            98           1           
0            0            99           1
0            0            100          1
0            0            101          1
0            0            102          1
0            0            103          1           
0            1            1            1           
0            1            2            1           
0            1            3            1           
0            1            4            1           
0            1            5            1           
0            1            6            1           
0            1            7            1           
0            1            8            1           
0            1            9            1           
0            1            10           1           
0            1            11           1           
0            1            12           1           
0            1            13           1           
0            1            14           1           
0            1            15           1           
0            1            16           1           
0            1            17           1           
0            1            18           1           
0            1            19           1           
0            1            20           1           
0            1            21           1           
0            1            22           1           
0            1            23           1           
0            1            24           1           
0            1            25           1           
0            1            26           1           
0            1            27           1           
0            1            28           1           
0            1            29           1           
0            1            30           1           
0            1            31           1           
0            1            32           1           
0            1            33           1           
0            1            34           1           
0            1            35           1           
0            1            36           1           
0            1            37           1           
0            1            38           1           
0            1            39           1           
0            1            40           1           
0            1            41           1           
0            1            42           1           
0            1            43           1           
0            1            44           1           
0            1            45           1           
0            1            46           1           
0            1            47           1           
0            1            48           1           
0            1            49           1           
0            1            50           1           
0            1            51           1           
0            1            52           1           
0            1            53           1           
0            1            54           1           
0            1            55           1           
0            1            56           1           
0            1            57           1           
0            1            58           1           
0            1            59           1           
0            1            60           1           
0            1            61           1           
0            1            62           1           
0            1            63           1           
0            1            64           1           
0            1            65           1           
0            1            66           1           
0            1            67           1           
0            1            68           1           
0            1            69           1           
0            1            70           1           
0            1            71           1           
0            1            72           1           
0            1            73           1           
0            1            74           1           
0            1            75           1           
0            1            76           1
0            1            77           1
0            1            78           1
0            1            79           1  
0            1            80           1     
0            1            81           1
0            1            82           1
0            1            83           1           
0            1            84           1           
0            1            85           1           
0            1            86           1
0            1            87           1
0            1            88           1           
0            1            89           1           
0            1            90           1           
0            1            91           1           
0            1            92           1  
0            1            93           1         
0            1            95           1           
0            1            96           1           
0            1            97           1           
0            1            98           1           
0            1            99           1
0            1            100          1           
0            1            101          1           
0            1            102          1           
0            1            103          1           
1            1            25           0           
1            1            29           0           
1            1            32           0           
1            1            34           0           
2            0            11           0
2            0            27           0                     
2            0            28           0           
2            0            29           0           
2            0            32           0           
2            0            35           0
2            0            36           0           
2            0            38           0           
2            0            44           0           
2            0            48           0           
2            0            50           0           
2            0            57           0                      
2            1            30           0           

222 rows fetched.

SQL> select * from SYS_USER_ROLES order by GRANTEE_ID, GRANTEE_TYPE, GRANTED_ROLE_ID;

GRANTEE_ID   GRANTEE_TYPE GRANTED_ROLE_ID ADMIN_OPTION DEFAULT_ROLE
------------ ------------ --------------- ------------ ------------
0            1            3               0            0           
3            0            7               0            0           
7            1            5               0            0           
7            1            6               0            0           
8            1            7               0            0           
9            1            7               0            0           

6 rows fetched.

SQL> 
SQL> drop role role_priv_test_3;

Succeed.

SQL> 
SQL> -- check data
SQL> select ID, NAME, DATA_SPACE#, TEMP_SPACE# from SYS_USERS order by ID;

ID           NAME                                                             DATA_SPACE#  TEMP_SPACE# 
------------ ---------------------------------------------------------------- ------------ ------------
0            SYS                                                              0            1           
1            PUBLIC                                                           0            1           
2            USER_PRIV_TEST_0                                                 3            1           
3            USER_PRIV_TEST_1                                                 3            1           
4            USER_PRIV_TEST_2                                                 3            1           
5            USER_PRIV_TEST_3                                                 3            1           

6 rows fetched.

SQL> select ID, OWNER_UID, NAME from SYS_ROLES order by ID;

ID           OWNER_UID    NAME                                                            
------------ ------------ ----------------------------------------------------------------
0            0            DBA                                                             
1            0            RESOURCE                                                        
2            0            CONNECT                                                         
3            0            STATISTICS                                                      
4            0            ROLE_PRIV_TEST_0                                                
5            0            ROLE_PRIV_TEST_1                                                
6            0            ROLE_PRIV_TEST_2                                                
8            0            ROLE_PRIV_TEST_4                                                
9            0            ROLE_PRIV_TEST_5                                                
10           0            ROLE_PRIV_TEST_6                                                

10 rows fetched.

SQL> select * from SYS_PRIVS order by GRANTEE_ID, GRANTEE_TYPE, PRIVILEGE;

GRANTEE_ID   GRANTEE_TYPE PRIVILEGE    ADMIN_OPTION
------------ ------------ ------------ ------------
0            0            1            1           
0            0            2            1           
0            0            3            1           
0            0            4            1           
0            0            5            1           
0            0            6            1           
0            0            7            1           
0            0            8            1           
0            0            9            1           
0            0            10           1           
0            0            11           1           
0            0            12           1           
0            0            13           1           
0            0            14           1           
0            0            15           1           
0            0            16           1           
0            0            17           1           
0            0            18           1           
0            0            19           1           
0            0            20           1           
0            0            21           1           
0            0            22           1           
0            0            23           1           
0            0            24           1           
0            0            25           1           
0            0            26           1           
0            0            27           1           
0            0            28           1           
0            0            29           1           
0            0            30           1           
0            0            31           1           
0            0            32           1           
0            0            33           1           
0            0            34           1           
0            0            35           1           
0            0            36           1           
0            0            37           1           
0            0            38           1           
0            0            39           1           
0            0            40           1           
0            0            41           1           
0            0            42           1           
0            0            43           1           
0            0            44           1           
0            0            45           1           
0            0            46           1           
0            0            47           1           
0            0            48           1           
0            0            49           1           
0            0            50           1           
0            0            51           1           
0            0            52           1           
0            0            53           1           
0            0            54           1           
0            0            55           1           
0            0            56           1           
0            0            57           1           
0            0            58           1           
0            0            59           1           
0            0            60           1           
0            0            61           1           
0            0            62           1           
0            0            63           1           
0            0            64           1           
0            0            65           1           
0            0            66           1           
0            0            67           1           
0            0            68           1           
0            0            69           1           
0            0            70           1           
0            0            71           1           
0            0            72           1           
0            0            73           1           
0            0            74           1           
0            0            75           1           
0            0            76           1
0            0            77           1
0            0            78           1
0            0            79           1
0            0            80           1
0            0            81           1
0            0            82           1           
0            0            83           1           
0            0            84           1           
0            0            85           1           
0            0            86           1
0            0            87           1
0            0            88           1           
0            0            89           1           
0            0            90           1           
0            0            91           1           
0            0            92           1 
0            0            93           1          
0            0            94           1
0            0            95           1           
0            0            96           1           
0            0            97           1           
0            0            98           1           
0            0            99           1
0            0            100          1
0            0            101          1
0            0            102          1
0            0            103          1           
0            1            1            1           
0            1            2            1           
0            1            3            1           
0            1            4            1           
0            1            5            1           
0            1            6            1           
0            1            7            1           
0            1            8            1           
0            1            9            1           
0            1            10           1           
0            1            11           1           
0            1            12           1           
0            1            13           1           
0            1            14           1           
0            1            15           1           
0            1            16           1           
0            1            17           1           
0            1            18           1           
0            1            19           1           
0            1            20           1           
0            1            21           1           
0            1            22           1           
0            1            23           1           
0            1            24           1           
0            1            25           1           
0            1            26           1           
0            1            27           1           
0            1            28           1           
0            1            29           1           
0            1            30           1           
0            1            31           1           
0            1            32           1           
0            1            33           1           
0            1            34           1           
0            1            35           1           
0            1            36           1           
0            1            37           1           
0            1            38           1           
0            1            39           1           
0            1            40           1           
0            1            41           1           
0            1            42           1           
0            1            43           1           
0            1            44           1           
0            1            45           1           
0            1            46           1           
0            1            47           1           
0            1            48           1           
0            1            49           1           
0            1            50           1           
0            1            51           1           
0            1            52           1           
0            1            53           1           
0            1            54           1           
0            1            55           1           
0            1            56           1           
0            1            57           1           
0            1            58           1           
0            1            59           1           
0            1            60           1           
0            1            61           1           
0            1            62           1           
0            1            63           1           
0            1            64           1           
0            1            65           1           
0            1            66           1           
0            1            67           1           
0            1            68           1           
0            1            69           1           
0            1            70           1           
0            1            71           1           
0            1            72           1           
0            1            73           1           
0            1            74           1           
0            1            75           1           
0            1            76           1
0            1            77           1
0            1            78           1           
0            1            79           1 
0            1            80           1 
0            1            81           1    
0            1            82           1     
0            1            83           1           
0            1            84           1           
0            1            85           1           
0            1            86           1
0            1            87           1
0            1            88           1           
0            1            89           1           
0            1            90           1           
0            1            91           1           
0            1            92           1 
0            1            93           1          
0            1            95           1           
0            1            96           1           
0            1            97           1           
0            1            98           1           
0            1            99           1
0            1            100          1           
0            1            101          1           
0            1            102          1           
0            1            103          1           
1            1            25           0           
1            1            29           0           
1            1            32           0           
1            1            34           0           
2            0            11           0
2            0            27           0                     
2            0            28           0           
2            0            29           0           
2            0            32           0           
2            0            35           0           
2            0            36           0           
2            0            38           0           
2            0            44           0           
2            0            48           0
2            0            50           0           
2            0            57           0                     
2            1            30           0           

222 rows fetched.

SQL> select * from SYS_USER_ROLES order by GRANTEE_ID, GRANTEE_TYPE, GRANTED_ROLE_ID;

GRANTEE_ID   GRANTEE_TYPE GRANTED_ROLE_ID ADMIN_OPTION DEFAULT_ROLE
------------ ------------ --------------- ------------ ------------
0            1            3               0            0           

1 rows fetched.

SQL> 
SQL> -- error check:
SQL> -- grant wrong privileges/role to user/role
SQL> grant privileges not exist to user_priv_test_3;

CT-00601, [1:7]Sql syntax error: invalid privilege or role name
SQL> grant privileges not exist to role_priv_test_4;

CT-00601, [1:7]Sql syntax error: invalid privilege or role name
SQL> 
SQL> -- grant privileges/role to wrong user/role
SQL> grant DROP ANY TABLE to user_not_exist;

CT-00601, [1:25]Sql syntax error: user or role 'USER_NOT_EXIST' does not exist
SQL> grant DROP ANY TABLE to role_not_exist;

CT-00601, [1:25]Sql syntax error: user or role 'ROLE_NOT_EXIST' does not exist
SQL> 
SQL> -- revoke wrong/not granted privileges/role from user/role
SQL> revoke DROP TABLESPACE from user_priv_test_3;

CT-01002, Privileges DROP TABLESPACE has not granted to USER_PRIV_TEST_3
SQL> revoke DROP PROFILE from role_priv_test_3;

CT-00601, [1:26]Sql syntax error: user or role 'ROLE_PRIV_TEST_3' does not exist
SQL> 
SQL> -- revoke privileges/role from wrong user/role
SQL> revoke DROP TABLESPACE from user_not_exist;

CT-00601, [1:29]Sql syntax error: user or role 'USER_NOT_EXIST' does not exist
SQL> revoke DROP PROFILE from role_not_exist;

CT-00601, [1:26]Sql syntax error: user or role 'ROLE_NOT_EXIST' does not exist
SQL> 
SQL> -- drop all users/roles
SQL> drop user USER_PRIV_TEST_0 cascade;

Succeed.

SQL> drop user USER_PRIV_TEST_1 cascade;

Succeed.

SQL> drop user USER_PRIV_TEST_2 cascade;

Succeed.

SQL> drop user USER_PRIV_TEST_3 cascade;

Succeed.

SQL> 
SQL> drop role ROLE_PRIV_TEST_0;

Succeed.

SQL> drop role ROLE_PRIV_TEST_1;

Succeed.

SQL> drop role ROLE_PRIV_TEST_2;

Succeed.

SQL> drop role ROLE_PRIV_TEST_3;

CT-00783, The role ROLE_PRIV_TEST_3 does not exist.
SQL> drop role ROLE_PRIV_TEST_4;

Succeed.

SQL> drop role ROLE_PRIV_TEST_5;

Succeed.

SQL> drop role ROLE_PRIV_TEST_6;

Succeed.

SQL> 
SQL> -- check data
SQL> select ID, NAME, DATA_SPACE#, TEMP_SPACE# from SYS_USERS order by ID;

ID           NAME                                                             DATA_SPACE#  TEMP_SPACE# 
------------ ---------------------------------------------------------------- ------------ ------------
0            SYS                                                              0            1           
1            PUBLIC                                                           0            1           

2 rows fetched.

SQL> select ID, OWNER_UID, NAME from SYS_ROLES order by ID;

ID           OWNER_UID    NAME                                                            
------------ ------------ ----------------------------------------------------------------
0            0            DBA                                                             
1            0            RESOURCE                                                        
2            0            CONNECT                                                         
3            0            STATISTICS                                                      

4 rows fetched.

SQL> select * from SYS_PRIVS order by GRANTEE_ID, GRANTEE_TYPE, PRIVILEGE;

GRANTEE_ID   GRANTEE_TYPE PRIVILEGE    ADMIN_OPTION
------------ ------------ ------------ ------------
0            0            1            1           
0            0            2            1           
0            0            3            1           
0            0            4            1           
0            0            5            1           
0            0            6            1           
0            0            7            1           
0            0            8            1           
0            0            9            1           
0            0            10           1           
0            0            11           1           
0            0            12           1           
0            0            13           1           
0            0            14           1           
0            0            15           1           
0            0            16           1           
0            0            17           1           
0            0            18           1           
0            0            19           1           
0            0            20           1           
0            0            21           1           
0            0            22           1           
0            0            23           1           
0            0            24           1           
0            0            25           1           
0            0            26           1           
0            0            27           1           
0            0            28           1           
0            0            29           1           
0            0            30           1           
0            0            31           1           
0            0            32           1           
0            0            33           1           
0            0            34           1           
0            0            35           1           
0            0            36           1           
0            0            37           1           
0            0            38           1           
0            0            39           1           
0            0            40           1           
0            0            41           1           
0            0            42           1           
0            0            43           1           
0            0            44           1           
0            0            45           1           
0            0            46           1           
0            0            47           1           
0            0            48           1           
0            0            49           1           
0            0            50           1           
0            0            51           1           
0            0            52           1           
0            0            53           1           
0            0            54           1           
0            0            55           1           
0            0            56           1           
0            0            57           1           
0            0            58           1           
0            0            59           1           
0            0            60           1           
0            0            61           1           
0            0            62           1           
0            0            63           1           
0            0            64           1           
0            0            65           1           
0            0            66           1           
0            0            67           1           
0            0            68           1           
0            0            69           1           
0            0            70           1           
0            0            71           1           
0            0            72           1           
0            0            73           1           
0            0            74           1           
0            0            75           1           
0            0            76           1
0            0            77           1
0            0            78           1
0            0            79           1 
0            0            80           1 
0            0            81           1
0            0            82           1   
0            0            83           1           
0            0            84           1           
0            0            85           1           
0            0            86           1
0            0            87           1
0            0            88           1           
0            0            89           1           
0            0            90           1           
0            0            91           1           
0            0            92           1 
0            0            93           1          
0            0            94           1
0            0            95           1           
0            0            96           1           
0            0            97           1           
0            0            98           1           
0            0            99           1
0            0            100          1
0            0            101          1
0            0            102          1
0            0            103          1           
0            1            1            1           
0            1            2            1           
0            1            3            1           
0            1            4            1           
0            1            5            1           
0            1            6            1           
0            1            7            1           
0            1            8            1           
0            1            9            1           
0            1            10           1           
0            1            11           1           
0            1            12           1           
0            1            13           1           
0            1            14           1           
0            1            15           1           
0            1            16           1           
0            1            17           1           
0            1            18           1           
0            1            19           1           
0            1            20           1           
0            1            21           1           
0            1            22           1           
0            1            23           1           
0            1            24           1           
0            1            25           1           
0            1            26           1           
0            1            27           1           
0            1            28           1           
0            1            29           1           
0            1            30           1           
0            1            31           1           
0            1            32           1           
0            1            33           1           
0            1            34           1           
0            1            35           1           
0            1            36           1           
0            1            37           1           
0            1            38           1           
0            1            39           1           
0            1            40           1           
0            1            41           1           
0            1            42           1           
0            1            43           1           
0            1            44           1           
0            1            45           1           
0            1            46           1           
0            1            47           1           
0            1            48           1           
0            1            49           1           
0            1            50           1           
0            1            51           1           
0            1            52           1           
0            1            53           1           
0            1            54           1           
0            1            55           1           
0            1            56           1           
0            1            57           1           
0            1            58           1           
0            1            59           1           
0            1            60           1           
0            1            61           1           
0            1            62           1           
0            1            63           1           
0            1            64           1           
0            1            65           1           
0            1            66           1           
0            1            67           1           
0            1            68           1           
0            1            69           1           
0            1            70           1           
0            1            71           1           
0            1            72           1           
0            1            73           1           
0            1            74           1           
0            1            75           1           
0            1            76           1
0            1            77           1
0            1            78           1
0            1            79           1
0            1            80           1
0            1            81           1 
0            1            82           1          
0            1            83           1           
0            1            84           1           
0            1            85           1           
0            1            86           1
0            1            87           1
0            1            88           1           
0            1            89           1           
0            1            90           1           
0            1            91           1           
0            1            92           1 
0            1            93           1          
0            1            95           1           
0            1            96           1           
0            1            97           1           
0            1            98           1           
0            1            99           1
0            1            100          1           
0            1            101          1           
0            1            102          1           
0            1            103          1           
1            1            25           0           
1            1            29           0           
1            1            32           0           
1            1            34           0           
2            1            30           0           

210 rows fetched.

SQL> select * from SYS_USER_ROLES order by GRANTEE_ID, GRANTEE_TYPE, GRANTED_ROLE_ID;

GRANTEE_ID   GRANTEE_TYPE GRANTED_ROLE_ID ADMIN_OPTION DEFAULT_ROLE
------------ ------------ --------------- ------------ ------------
0            1            3               0            0           

1 rows fetched.

SQL> 
SQL> --dba role
SQL> create user user_priv_test_5 identified by Root12345;

Succeed.

SQL> grant dba to user_priv_test_5;

Succeed.

SQL> select * from SYS_USER_ROLES order by GRANTEE_ID, GRANTEE_TYPE, GRANTED_ROLE_ID;

GRANTEE_ID   GRANTEE_TYPE GRANTED_ROLE_ID ADMIN_OPTION DEFAULT_ROLE
------------ ------------ --------------- ------------ ------------
0            1            3               0            0           
2            0            0               0            0           

2 rows fetched.

SQL> revoke dba from user_priv_test_5;

Succeed.

SQL> select * from SYS_USER_ROLES order by GRANTEE_ID, GRANTEE_TYPE, GRANTED_ROLE_ID;

GRANTEE_ID   GRANTEE_TYPE GRANTED_ROLE_ID ADMIN_OPTION DEFAULT_ROLE
------------ ------------ --------------- ------------ ------------
0            1            3               0            0           

1 rows fetched.

SQL> drop user user_priv_test_5 cascade;

Succeed.

SQL> 
SQL> -- grant all privileges
SQL> create user user_priv_test_6 identified by Root12345;

Succeed.

SQL> grant all privileges to user_priv_test_6;

Succeed.

SQL> grant all to user_priv_test_6;

Succeed.

SQL> select * from SYS_PRIVS order by GRANTEE_ID, GRANTEE_TYPE, PRIVILEGE;

GRANTEE_ID   GRANTEE_TYPE PRIVILEGE    ADMIN_OPTION
------------ ------------ ------------ ------------
0            0            1            1           
0            0            2            1           
0            0            3            1           
0            0            4            1           
0            0            5            1           
0            0            6            1           
0            0            7            1           
0            0            8            1           
0            0            9            1           
0            0            10           1           
0            0            11           1           
0            0            12           1           
0            0            13           1           
0            0            14           1           
0            0            15           1           
0            0            16           1           
0            0            17           1           
0            0            18           1           
0            0            19           1           
0            0            20           1           
0            0            21           1           
0            0            22           1           
0            0            23           1           
0            0            24           1           
0            0            25           1           
0            0            26           1           
0            0            27           1           
0            0            28           1           
0            0            29           1           
0            0            30           1           
0            0            31           1           
0            0            32           1           
0            0            33           1           
0            0            34           1           
0            0            35           1           
0            0            36           1           
0            0            37           1           
0            0            38           1           
0            0            39           1           
0            0            40           1           
0            0            41           1           
0            0            42           1           
0            0            43           1           
0            0            44           1           
0            0            45           1           
0            0            46           1           
0            0            47           1           
0            0            48           1           
0            0            49           1           
0            0            50           1           
0            0            51           1           
0            0            52           1           
0            0            53           1           
0            0            54           1           
0            0            55           1           
0            0            56           1           
0            0            57           1           
0            0            58           1           
0            0            59           1           
0            0            60           1           
0            0            61           1           
0            0            62           1           
0            0            63           1           
0            0            64           1           
0            0            65           1           
0            0            66           1           
0            0            67           1           
0            0            68           1           
0            0            69           1           
0            0            70           1           
0            0            71           1           
0            0            72           1           
0            0            73           1           
0            0            74           1           
0            0            75           1           
0            0            76           1
0            0            77           1
0            0            78           1
0            0            79           1
0            0            80           1 
0            0            81           1
0            0            82           1        
0            0            83           1           
0            0            84           1           
0            0            85           1           
0            0            86           1
0            0            87           1
0            0            88           1           
0            0            89           1           
0            0            90           1           
0            0            91           1           
0            0            92           1
0            0            93           1            
0            0            94           1
0            0            95           1           
0            0            96           1           
0            0            97           1           
0            0            98           1           
0            0            99           1
0            0            100          1
0            0            101          1
0            0            102          1
0            0            103          1           
0            1            1            1           
0            1            2            1           
0            1            3            1           
0            1            4            1           
0            1            5            1           
0            1            6            1           
0            1            7            1           
0            1            8            1           
0            1            9            1           
0            1            10           1           
0            1            11           1           
0            1            12           1           
0            1            13           1           
0            1            14           1           
0            1            15           1           
0            1            16           1           
0            1            17           1           
0            1            18           1           
0            1            19           1           
0            1            20           1           
0            1            21           1           
0            1            22           1           
0            1            23           1           
0            1            24           1           
0            1            25           1           
0            1            26           1           
0            1            27           1           
0            1            28           1           
0            1            29           1           
0            1            30           1           
0            1            31           1           
0            1            32           1           
0            1            33           1           
0            1            34           1           
0            1            35           1           
0            1            36           1           
0            1            37           1           
0            1            38           1           
0            1            39           1           
0            1            40           1           
0            1            41           1           
0            1            42           1           
0            1            43           1           
0            1            44           1           
0            1            45           1           
0            1            46           1           
0            1            47           1           
0            1            48           1           
0            1            49           1           
0            1            50           1           
0            1            51           1           
0            1            52           1           
0            1            53           1           
0            1            54           1           
0            1            55           1           
0            1            56           1           
0            1            57           1           
0            1            58           1           
0            1            59           1           
0            1            60           1           
0            1            61           1           
0            1            62           1           
0            1            63           1           
0            1            64           1           
0            1            65           1           
0            1            66           1           
0            1            67           1           
0            1            68           1           
0            1            69           1           
0            1            70           1           
0            1            71           1           
0            1            72           1           
0            1            73           1           
0            1            74           1           
0            1            75           1           
0            1            76           1
0            1            77           1
0            1            78           1
0            1            79           1
0            1            80           1
0            1            81           1
0            1            82           1        
0            1            83           1           
0            1            84           1           
0            1            85           1           
0            1            86           1
0            1            87           1
0            1            88           1           
0            1            89           1           
0            1            90           1           
0            1            91           1           
0            1            92           1 
0            1            93           1           
0            1            95           1           
0            1            96           1           
0            1            97           1           
0            1            98           1           
0            1            99           1
0            1            100          1           
0            1            101          1           
0            1            102          1           
0            1            103          1           
1            1            25           0           
1            1            29           0           
1            1            32           0           
1            1            34           0           
2            0            1            0           
2            0            2            0           
2            0            3            0           
2            0            4            0           
2            0            5            0           
2            0            6            0           
2            0            7            0           
2            0            8            0           
2            0            9            0           
2            0            10           0           
2            0            11           0           
2            0            12           0           
2            0            13           0           
2            0            14           0           
2            0            15           0           
2            0            16           0           
2            0            17           0           
2            0            18           0           
2            0            19           0           
2            0            20           0           
2            0            21           0           
2            0            22           0           
2            0            23           0           
2            0            24           0           
2            0            25           0           
2            0            26           0           
2            0            27           0           
2            0            28           0           
2            0            29           0           
2            0            30           0           
2            0            31           0           
2            0            32           0           
2            0            33           0           
2            0            34           0           
2            0            35           0           
2            0            36           0           
2            0            37           0           
2            0            38           0           
2            0            39           0           
2            0            40           0           
2            0            41           0           
2            0            42           0           
2            0            43           0           
2            0            44           0           
2            0            45           0           
2            0            46           0           
2            0            47           0           
2            0            48           0           
2            0            49           0           
2            0            50           0           
2            0            51           0           
2            0            52           0           
2            0            53           0           
2            0            54           0           
2            0            55           0           
2            0            56           0           
2            0            57           0           
2            0            58           0           
2            0            59           0           
2            0            60           0           
2            0            61           0           
2            0            62           0           
2            0            63           0           
2            0            64           0           
2            0            65           0           
2            0            66           0           
2            0            67           0           
2            0            68           0           
2            0            69           0           
2            0            70           0           
2            0            71           0           
2            0            72           0           
2            0            73           0           
2            0            74           0           
2            0            75           0           
2            0            76           0
2            0            77           0
2            0            78           0
2            0            79           0 
2            0            80           0   
2            0            81           0
2            0            82           0
2            0            83           0           
2            0            84           0           
2            0            85           0           
2            0            86           0
2            0            87           0
2            0            88           0               
2            0            89           0           
2            0            90           0           
2            0            91           0           
2            0            92           0 
2            0            93           0          
2            0            94           0
2            0            95           0           
2            0            96           0           
2            0            97           0           
2            0            98           0           
2            0            99           0
2            0            100          0           
2            0            101          0           
2            0            102          0           
2            0            103          0           
2            1            30           0           

313 rows fetched.

SQL> revoke create session, create table from user_priv_test_6;

Succeed.

SQL> select * from SYS_PRIVS order by GRANTEE_ID, GRANTEE_TYPE, PRIVILEGE;

GRANTEE_ID   GRANTEE_TYPE PRIVILEGE    ADMIN_OPTION
------------ ------------ ------------ ------------
0            0            1            1           
0            0            2            1           
0            0            3            1           
0            0            4            1           
0            0            5            1           
0            0            6            1           
0            0            7            1           
0            0            8            1           
0            0            9            1           
0            0            10           1           
0            0            11           1           
0            0            12           1           
0            0            13           1           
0            0            14           1           
0            0            15           1           
0            0            16           1           
0            0            17           1           
0            0            18           1           
0            0            19           1           
0            0            20           1           
0            0            21           1           
0            0            22           1           
0            0            23           1           
0            0            24           1           
0            0            25           1           
0            0            26           1           
0            0            27           1           
0            0            28           1           
0            0            29           1           
0            0            30           1           
0            0            31           1           
0            0            32           1           
0            0            33           1           
0            0            34           1           
0            0            35           1           
0            0            36           1           
0            0            37           1           
0            0            38           1           
0            0            39           1           
0            0            40           1           
0            0            41           1           
0            0            42           1           
0            0            43           1           
0            0            44           1           
0            0            45           1           
0            0            46           1           
0            0            47           1           
0            0            48           1           
0            0            49           1           
0            0            50           1           
0            0            51           1           
0            0            52           1           
0            0            53           1           
0            0            54           1           
0            0            55           1           
0            0            56           1           
0            0            57           1           
0            0            58           1           
0            0            59           1           
0            0            60           1           
0            0            61           1           
0            0            62           1           
0            0            63           1           
0            0            64           1           
0            0            65           1           
0            0            66           1           
0            0            67           1           
0            0            68           1           
0            0            69           1           
0            0            70           1           
0            0            71           1           
0            0            72           1           
0            0            73           1           
0            0            74           1           
0            0            75           1           
0            0            76           1
0            0            77           1
0            0            78           1
0            0            79           1  
0            0            80           1
0            0            81           1
0            0            82           1        
0            0            83           1           
0            0            84           1           
0            0            85           1           
0            0            86           1
0            0            87           1
0            0            88           1            
0            0            89           1           
0            0            90           1           
0            0            91           1           
0            0            92           1
0            0            93           1           
0            0            94           1
0            0            95           1           
0            0            96           1           
0            0            97           1           
0            0            98           1           
0            0            99           1
0            0            100          1
0            0            101          1
0            0            102          1
0            0            103          1           
0            1            1            1           
0            1            2            1           
0            1            3            1           
0            1            4            1           
0            1            5            1           
0            1            6            1           
0            1            7            1           
0            1            8            1           
0            1            9            1           
0            1            10           1           
0            1            11           1           
0            1            12           1           
0            1            13           1           
0            1            14           1           
0            1            15           1           
0            1            16           1           
0            1            17           1           
0            1            18           1           
0            1            19           1           
0            1            20           1           
0            1            21           1           
0            1            22           1           
0            1            23           1           
0            1            24           1           
0            1            25           1           
0            1            26           1           
0            1            27           1           
0            1            28           1           
0            1            29           1           
0            1            30           1           
0            1            31           1           
0            1            32           1           
0            1            33           1           
0            1            34           1           
0            1            35           1           
0            1            36           1           
0            1            37           1           
0            1            38           1           
0            1            39           1           
0            1            40           1           
0            1            41           1           
0            1            42           1           
0            1            43           1           
0            1            44           1           
0            1            45           1           
0            1            46           1           
0            1            47           1           
0            1            48           1           
0            1            49           1           
0            1            50           1           
0            1            51           1           
0            1            52           1           
0            1            53           1           
0            1            54           1           
0            1            55           1           
0            1            56           1           
0            1            57           1           
0            1            58           1           
0            1            59           1           
0            1            60           1           
0            1            61           1           
0            1            62           1           
0            1            63           1           
0            1            64           1           
0            1            65           1           
0            1            66           1           
0            1            67           1           
0            1            68           1           
0            1            69           1           
0            1            70           1           
0            1            71           1           
0            1            72           1           
0            1            73           1           
0            1            74           1           
0            1            75           1           
0            1            76           1
0            1            77           1
0            1            78           1
0            1            79           1 
0            1            80           1
0            1            81           1
0            1            82           1           
0            1            83           1           
0            1            84           1           
0            1            85           1           
0            1            86           1
0            1            87           1
0            1            88           1           
0            1            89           1           
0            1            90           1           
0            1            91           1           
0            1            92           1
0            1            93           1          
0            1            95           1           
0            1            96           1           
0            1            97           1           
0            1            98           1           
0            1            99           1           
0            1            100          1           
0            1            101          1           
0            1            102          1           
0            1            103          1           
1            1            25           0           
1            1            29           0           
1            1            32           0           
1            1            34           0           
2            0            1            0           
2            0            2            0           
2            0            3            0           
2            0            4            0           
2            0            5            0           
2            0            6            0           
2            0            7            0           
2            0            8            0           
2            0            9            0           
2            0            10           0           
2            0            11           0           
2            0            12           0           
2            0            13           0           
2            0            14           0           
2            0            15           0           
2            0            16           0           
2            0            17           0           
2            0            18           0           
2            0            19           0           
2            0            20           0           
2            0            21           0           
2            0            22           0           
2            0            23           0           
2            0            24           0           
2            0            25           0           
2            0            26           0           
2            0            27           0           
2            0            28           0           
2            0            29           0           
2            0            31           0           
2            0            33           0           
2            0            34           0           
2            0            35           0           
2            0            36           0           
2            0            37           0           
2            0            38           0           
2            0            39           0           
2            0            40           0           
2            0            41           0           
2            0            42           0           
2            0            43           0           
2            0            44           0           
2            0            45           0           
2            0            46           0           
2            0            47           0           
2            0            48           0           
2            0            49           0           
2            0            50           0           
2            0            51           0           
2            0            52           0           
2            0            53           0           
2            0            54           0           
2            0            55           0           
2            0            56           0           
2            0            57           0           
2            0            58           0           
2            0            59           0           
2            0            60           0           
2            0            61           0           
2            0            62           0           
2            0            63           0           
2            0            64           0           
2            0            65           0           
2            0            66           0           
2            0            67           0           
2            0            68           0           
2            0            69           0           
2            0            70           0           
2            0            71           0           
2            0            72           0           
2            0            73           0           
2            0            74           0           
2            0            75           0           
2            0            76           0
2            0            77           0
2            0            78           0
2            0            79           0 
2            0            80           0 
2            0            81           0
2            0            82           0            
2            0            83           0           
2            0            84           0           
2            0            85           0           
2            0            86           0
2            0            87           0
2            0            88           0           
2            0            89           0           
2            0            90           0           
2            0            91           0           
2            0            92           0
2            0            93           0           
2            0            94           0 
2            0            95           0           
2            0            96           0           
2            0            97           0           
2            0            98           0           
2            0            99           0
2            0            100          0           
2            0            101          0           
2            0            102          0           
2            0            103          0           
2            1            30           0           

311 rows fetched.

SQL> revoke all privileges from user_priv_test_6;

Succeed.

SQL> revoke all from user_priv_test_6;

Succeed.

SQL> select * from SYS_PRIVS order by GRANTEE_ID, GRANTEE_TYPE, PRIVILEGE;

GRANTEE_ID   GRANTEE_TYPE PRIVILEGE    ADMIN_OPTION
------------ ------------ ------------ ------------
0            0            1            1           
0            0            2            1           
0            0            3            1           
0            0            4            1           
0            0            5            1           
0            0            6            1           
0            0            7            1           
0            0            8            1           
0            0            9            1           
0            0            10           1           
0            0            11           1           
0            0            12           1           
0            0            13           1           
0            0            14           1           
0            0            15           1           
0            0            16           1           
0            0            17           1           
0            0            18           1           
0            0            19           1           
0            0            20           1           
0            0            21           1           
0            0            22           1           
0            0            23           1           
0            0            24           1           
0            0            25           1           
0            0            26           1           
0            0            27           1           
0            0            28           1           
0            0            29           1           
0            0            30           1           
0            0            31           1           
0            0            32           1           
0            0            33           1           
0            0            34           1           
0            0            35           1           
0            0            36           1           
0            0            37           1           
0            0            38           1           
0            0            39           1           
0            0            40           1           
0            0            41           1           
0            0            42           1           
0            0            43           1           
0            0            44           1           
0            0            45           1           
0            0            46           1           
0            0            47           1           
0            0            48           1           
0            0            49           1           
0            0            50           1           
0            0            51           1           
0            0            52           1           
0            0            53           1           
0            0            54           1           
0            0            55           1           
0            0            56           1           
0            0            57           1           
0            0            58           1           
0            0            59           1           
0            0            60           1           
0            0            61           1           
0            0            62           1           
0            0            63           1           
0            0            64           1           
0            0            65           1           
0            0            66           1           
0            0            67           1           
0            0            68           1           
0            0            69           1           
0            0            70           1           
0            0            71           1           
0            0            72           1           
0            0            73           1           
0            0            74           1           
0            0            75           1           
0            0            76           1
0            0            77           1
0            0            78           1
0            0            79           1  
0            0            80           1
0            0            81           1
0            0            82           1
0            0            83           1           
0            0            84           1           
0            0            85           1           
0            0            86           1
0            0            87           1
0            0            88           1            
0            0            89           1           
0            0            90           1           
0            0            91           1           
0            0            92           1
0            0            93           1           
0            0            94           1
0            0            95           1           
0            0            96           1           
0            0            97           1           
0            0            98           1           
0            0            99           1
0            0            100          1
0            0            101          1
0            0            102          1
0            0            103          1           
0            1            1            1           
0            1            2            1           
0            1            3            1           
0            1            4            1           
0            1            5            1           
0            1            6            1           
0            1            7            1           
0            1            8            1           
0            1            9            1           
0            1            10           1           
0            1            11           1           
0            1            12           1           
0            1            13           1           
0            1            14           1           
0            1            15           1           
0            1            16           1           
0            1            17           1           
0            1            18           1           
0            1            19           1           
0            1            20           1           
0            1            21           1           
0            1            22           1           
0            1            23           1           
0            1            24           1           
0            1            25           1           
0            1            26           1           
0            1            27           1           
0            1            28           1           
0            1            29           1           
0            1            30           1           
0            1            31           1           
0            1            32           1           
0            1            33           1           
0            1            34           1           
0            1            35           1           
0            1            36           1           
0            1            37           1           
0            1            38           1           
0            1            39           1           
0            1            40           1           
0            1            41           1           
0            1            42           1           
0            1            43           1           
0            1            44           1           
0            1            45           1           
0            1            46           1           
0            1            47           1           
0            1            48           1           
0            1            49           1           
0            1            50           1           
0            1            51           1           
0            1            52           1           
0            1            53           1           
0            1            54           1           
0            1            55           1           
0            1            56           1           
0            1            57           1           
0            1            58           1           
0            1            59           1           
0            1            60           1           
0            1            61           1           
0            1            62           1           
0            1            63           1           
0            1            64           1           
0            1            65           1           
0            1            66           1           
0            1            67           1           
0            1            68           1           
0            1            69           1           
0            1            70           1           
0            1            71           1           
0            1            72           1           
0            1            73           1           
0            1            74           1           
0            1            75           1           
0            1            76           1
0            1            77           1
0            1            78           1
0            1            79           1 
0            1            80           1
0            1            81           1
0            1            82           1
0            1            83           1           
0            1            84           1           
0            1            85           1           
0            1            86           1
0            1            87           1
0            1            88           1           
0            1            89           1           
0            1            90           1           
0            1            91           1           
0            1            92           1
0            1            93           1           
0            1            95           1           
0            1            96           1           
0            1            97           1           
0            1            98           1           
0            1            99           1
0            1            100          1           
0            1            101          1           
0            1            102          1           
0            1            103          1           
1            1            25           0           
1            1            29           0           
1            1            32           0           
1            1            34           0           
2            1            30           0           

210 rows fetched.

SQL> drop user user_priv_test_6 cascade;

Succeed.

SQL> 
SQL> -- test create role sql
SQL> create role ROLE_TEST_001 abc;

CT-00601, Sql syntax error: key word expected, but abc found
SQL> create role ROLE_TEST_001 not identified;

Succeed.

SQL> create role ROLE_TEST_002 identified by 'Root12345';

Succeed.

SQL> drop role ROLE_TEST_001;

Succeed.

SQL> drop role ROLE_TEST_002;

Succeed.

SQL> 
SQL> -- test exception routine
SQL> create user USER_TEST_001 identified by Root12345;

Succeed.

SQL> create user USER_TEST_002 identified by Root12345;

Succeed.

SQL> grant create table, create table to USER_TEST_001;

CT-00601, [1:21]Sql syntax error: duplicate privilege listed
SQL> grant all privileges, create table to USER_TEST_001;

CT-00601, [1:23]Sql syntax error: duplicate privilege listed
SQL> grant dba to USER_TEST_001, USER_TEST_001;

CT-00601, Sql syntax error: user or role USER_TEST_001 is already exists
SQL> grant to USER_TEST_001;

CT-00601, [1:7]Sql syntax error: missing or invalid privilege
SQL> grant dba to USER_TEST_001 with;

CT-00601, [1:32]Sql syntax error: ADMIN expected
SQL> grant dba to USER_TEST_001 with admin;

CT-00601, [1:38]Sql syntax error: OPTION expected
SQL> grant dba to USER_TEST_001 with admin option;

Succeed.

SQL> grant dba to USER_TEST_001 with admin option more;

CT-00601, [1:50]Sql syntax error: expected end but more found
SQL> grant create table, create any table to sys, USER_TEST_001 USER_TEST_002;

CT-00601, [1:73]Sql syntax error: , expected, but USER_TEST_002 found
SQL> grant create table, create any table to sys,,USER_TEST_001;

CT-00601, [1:45]Sql syntax error: grantee expected, but , found
SQL> grant create table, create any table to sys, USER_TEST_001;

Succeed.

SQL> grant create table, create any table to;

CT-00601, [1:40]Sql syntax error: grantee expected, but  found
SQL> revoke create any table from USER_TEST_001 USER_TEST_002;

CT-00601, [1:57]Sql syntax error: , expected, but USER_TEST_002 found
SQL> revoke create any table from USER_TEST_001,,USER_TEST_002;

CT-00601, [1:44]Sql syntax error: revokee expected, but , found
SQL> grant create any table to USER_TEST_002;

Succeed.

SQL> revoke create any table from USER_TEST_001, USER_TEST_002;

Succeed.

SQL> revoke create any table from ;

CT-00601, [1:30]Sql syntax error: revokee expected, but  found
SQL> revoke create any table from USER_TEST_001, USER_TEST_002 cascade;

CT-00601, [1:66]Sql syntax error: expected end but CASCADE found
SQL> 
SQL> revoke dba from USER_TEST_001;

Succeed.

SQL> grant create session to USER_TEST_001;

Succeed.

SQL> conn USER_TEST_001/Root12345@127.0.0.1:1611

connected.

SQL> create table USER_TEST_001.tab001 (id int);

Succeed.

SQL> lock table tab001 in share mode;

Succeed.

SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> 
SQL> grant create any index to USER_TEST_001;

Succeed.

SQL> grant create any index to USER_TEST_001;

Succeed.

SQL> grant create any index to USER_TEST_001 with admin option;

Succeed.

SQL> 
SQL> grant dba to USER_TEST_001;

Succeed.

SQL> grant dba to USER_TEST_001;

Succeed.

SQL> grant dba to USER_TEST_001 with admin option;

Succeed.

SQL> 
SQL> create role ROLE_TEST_001;

Succeed.

SQL> grant create any index to ROLE_TEST_001;

Succeed.

SQL> grant create any index to ROLE_TEST_001;

Succeed.

SQL> grant create any index to ROLE_TEST_001 with admin option;

Succeed.

SQL> 
SQL> create role ROLE_TEST_002;

Succeed.

SQL> grant ROLE_TEST_001 to ROLE_TEST_002;

Succeed.

SQL> grant ROLE_TEST_001 to ROLE_TEST_002;

Succeed.

SQL> grant ROLE_TEST_001 to ROLE_TEST_002 with admin option;

Succeed.

SQL> 
SQL> grant all privileges to ROLE_TEST_001;

Succeed.

SQL> revoke all privileges from ROLE_TEST_001;

Succeed.

SQL> 
SQL> grant all privileges to USER_TEST_001;

Succeed.

SQL> revoke all privileges from USER_TEST_001;

Succeed.

SQL> 
SQL> create role ROLE_TEST_003;

Succeed.

SQL> revoke ROLE_TEST_003 from USER_TEST_001;

CT-01007, Role ROLE_TEST_003 has not granted to USER_TEST_001
SQL> revoke ROLE_TEST_003 from ROLE_TEST_002;

CT-01007, Role ROLE_TEST_003 has not granted to ROLE_TEST_002
SQL> 
SQL> drop user USER_TEST_001 cascade;

Succeed.

SQL> drop user USER_TEST_002 cascade;

Succeed.

SQL> drop role ROLE_TEST_001;

Succeed.

SQL> drop role ROLE_TEST_002;

Succeed.

SQL> drop role ROLE_TEST_003;

Succeed.

SQL> 
SQL> create user USER_TEST_001 identified by Root12345;

Succeed.

SQL> create user USER_TEST_002 identified by Root12345;

Succeed.

SQL> create role ROLE_TEST_001;

Succeed.

SQL> create role ROLE_TEST_002;

Succeed.

SQL> 
SQL> grant create session to USER_TEST_001;

Succeed.

SQL> grant ROLE_TEST_002 to USER_TEST_001 with admin option;

Succeed.

SQL> 
SQL> -- check grant privilege
SQL> conn USER_TEST_001/Root12345@127.0.0.1:1611

connected.

SQL> grant create table to USER_TEST_002;

CT-01001, Permissions were insufficient
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant create table to USER_TEST_001 with admin option;

Succeed.

SQL> conn USER_TEST_001/Root12345@127.0.0.1:1611

connected.

SQL> grant create table to USER_TEST_002;

Succeed.

SQL> 
SQL> -- check drop role privilege
SQL> drop role ROLE_TEST_001;

CT-01001, Permissions were insufficient
SQL> drop role ROLE_TEST_002;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> select ID, OWNER_UID, NAME from SYS_ROLES order by ID;

ID           OWNER_UID    NAME                                                            
------------ ------------ ----------------------------------------------------------------
0            0            DBA                                                             
1            0            RESOURCE                                                        
2            0            CONNECT                                                         
3            0            STATISTICS                                                      
4            0            ROLE_TEST_001
5            0            ROLE_TEST_002                                                   

6 rows fetched.

SQL> 
SQL> drop user USER_TEST_001 cascade;

Succeed.

SQL> drop user USER_TEST_002 cascade;

Succeed.

SQL> drop role ROLE_TEST_001;

Succeed.

SQL> drop role ROLE_TEST_002;

Succeed.

SQL> 
SQL> -- object privilege test case
SQL> create user obj_test_user_001 identified by Root1234;

Succeed.

SQL> create user obj_test_user_002 identified by Root1234;

Succeed.

SQL> create user obj_test_user_003 identified by Root1234;

Succeed.

SQL> create user obj_test_user_004 identified by Root1234;

Succeed.

SQL> 
SQL> create role obj_test_role_001;

Succeed.

SQL> create role obj_test_role_002;

Succeed.

SQL> create role obj_test_role_003;

Succeed.

SQL> create role obj_test_role_004;

Succeed.

SQL> 
SQL> create table obj_test_user_001.tab_001 (id int);

Succeed.

SQL> insert into obj_test_user_001.tab_001 values (1);

1 rows affected.

SQL> 
SQL> create table obj_test_user_002.tab_002 (id int);

Succeed.

SQL> insert into obj_test_user_002.tab_002 values (2);

1 rows affected.

SQL> 
SQL> create table obj_test_user_003.tab_003 (id int);

Succeed.

SQL> insert into obj_test_user_003.tab_003 values (3);

1 rows affected.

SQL> 
SQL> grant create session to obj_test_user_001;

Succeed.

SQL> grant create session to obj_test_user_002;

Succeed.

SQL> grant create session to obj_test_user_003;

Succeed.

SQL> grant create session to obj_test_user_004;

Succeed.

SQL> -- 1. select on table/view/sequence to user
SQL> -- 1.1 table
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> select * from tab_002;

ID          
------------
2           

1 rows fetched.

SQL> select * from obj_test_user_001.tab_001;

CT-01001, Permissions were insufficient
SQL> select * from (select * from obj_test_user_001.tab_001);

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant select on obj_test_user_001.tab_001 to obj_test_user_002;

Succeed.

SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> select * from obj_test_user_001.tab_001;

ID          
------------
1           

1 rows fetched.

SQL> select * from (select * from obj_test_user_001.tab_001);

ID          
------------
1           

1 rows fetched.

SQL> 
SQL> conn obj_test_user_001/Root1234@127.0.0.1:1611

connected.

SQL> revoke select on tab_001 from obj_test_user_002;

Succeed.

SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> select * from obj_test_user_001.tab_001;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> 
SQL> --1.2 view
SQL> grant select on obj_test_user_003.tab_003 to obj_test_user_001;

Succeed.

SQL> create view obj_test_user_001.view_001 as select * from obj_test_user_003.tab_003;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> select * from obj_test_user_001.view_001;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant select on obj_test_user_001.view_001 to obj_test_user_002;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> select * from obj_test_user_001.view_001;

ID          
------------
3           

1 rows fetched.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> revoke select on obj_test_user_001.view_001 from obj_test_user_002;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> select * from obj_test_user_001.view_001;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant select on obj_test_user_001.view_001 to obj_test_user_002;

Succeed.

SQL> revoke select on obj_test_user_003.tab_003 from obj_test_user_001;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> select * from obj_test_user_001.view_001;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant read on obj_test_user_003.tab_003 to obj_test_user_001;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> select * from obj_test_user_001.view_001;

ID          
------------
3           

1 rows fetched.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> revoke select on obj_test_user_001.view_001 from obj_test_user_002;

Succeed.

SQL> revoke read on obj_test_user_003.tab_003 from obj_test_user_001;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> select * from obj_test_user_001.view_001;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> select * from obj_test_user_001.view_001;

CT-01001, Permissions were insufficient
SQL> 
SQL> grant read any table to obj_test_user_002;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> select * from obj_test_user_001.view_001;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> revoke read any table from obj_test_user_002;

Succeed.

SQL> grant read on obj_test_user_001.view_001 to obj_test_user_002;

Succeed.

SQL> create or replace public synonym USER_PUBLIC_VIEW for obj_test_user_001.view_001;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> select * from USER_PUBLIC_VIEW;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> revoke read on obj_test_user_001.view_001 from obj_test_user_002;

Succeed.

SQL> 
SQL> --1.3 sequence
SQL> create sequence obj_test_user_001.seq_001 start with 100;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> select obj_test_user_001.seq_001.nextval from dual;

CT-01001, Permissions were insufficient
SQL> select obj_test_user_001.seq_001.currval from dual;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn obj_test_user_001/Root1234@127.0.0.1:1611

connected.

SQL> grant select on obj_test_user_001.seq_001 to obj_test_user_002;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> select obj_test_user_001.seq_001.nextval from dual;

NEXTVAL             
--------------------
100                 

1 rows fetched.

SQL> select obj_test_user_001.seq_001.currval from dual;

CURRVAL             
--------------------
100                 

1 rows fetched.

SQL> 
SQL> conn obj_test_user_001/Root1234@127.0.0.1:1611

connected.

SQL> revoke select on obj_test_user_001.seq_001 from obj_test_user_002;

Succeed.

SQL> 
SQL> -- 2. insert on table
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant insert on obj_test_user_001.tab_001 to obj_test_user_002;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> insert into obj_test_user_001.tab_001 values (2);

1 rows affected.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> revoke insert on obj_test_user_001.tab_001 from obj_test_user_002;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> insert into obj_test_user_001.tab_001 values (3);

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant insert any table to obj_test_user_002;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> insert into obj_test_user_001.tab_001 values (3);

1 rows affected.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> revoke insert any table from obj_test_user_002;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> insert into obj_test_user_001.tab_001 values (3);

CT-01001, Permissions were insufficient
SQL> 
SQL> -- 3. update on table
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant update on obj_test_user_001.tab_001 to obj_test_user_002;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> update obj_test_user_001.tab_001 set id=12 where id=2;

0 rows affected.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> revoke update on obj_test_user_001.tab_001 from obj_test_user_002;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> update obj_test_user_001.tab_001 set id=13 where id=3;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant update any table to obj_test_user_002;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> update obj_test_user_001.tab_001 set id=11 where id=1;

1 rows affected.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> revoke update any table from obj_test_user_002;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> update obj_test_user_001.tab_001 set id=13 where id=3;

CT-01001, Permissions were insufficient
SQL> 
SQL> 
SQL> -- 4. delete on table
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant delete on obj_test_user_001.tab_001 to obj_test_user_002;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> delete from obj_test_user_001.tab_001 where id=12;

0 rows affected.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> revoke delete on obj_test_user_001.tab_001 from obj_test_user_002;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> delete from obj_test_user_001.tab_001 where id=13;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant delete any table to obj_test_user_002;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> delete from obj_test_user_001.tab_001 where id=13;

0 rows affected.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> revoke delete any table from obj_test_user_002;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> delete from obj_test_user_001.tab_001;

CT-01001, Permissions were insufficient
SQL> 
SQL> -- 5. merge on table
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant select on obj_test_user_003.tab_003 to obj_test_user_001;

Succeed.

SQL> grant update, insert on obj_test_user_002.tab_002 to obj_test_user_001;

Succeed.

SQL> 
SQL> conn obj_test_user_001/Root1234@127.0.0.1:1611

connected.

SQL> merge into obj_test_user_002.tab_002 using obj_test_user_001.tab_001 on (1=1) when matched then update set id=200 when not matched then insert (id) values (1000);

1 rows affected.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> revoke update, insert on obj_test_user_002.tab_002 from obj_test_user_001;

Succeed.

SQL> 
SQL> conn obj_test_user_001/Root1234@127.0.0.1:1611

connected.

SQL> merge into obj_test_user_002.tab_002 using obj_test_user_001.tab_001 on (1=1) when matched then update set id=200 when not matched then insert (id) values (1000);

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant update, insert on obj_test_user_002.tab_002 to obj_test_user_001;

Succeed.

SQL> revoke select on obj_test_user_003.tab_003 from obj_test_user_001;

Succeed.

SQL> 
SQL> conn obj_test_user_001/Root1234@127.0.0.1:1611

connected.

SQL> merge into obj_test_user_002.tab_002 using obj_test_user_001.tab_001 on (1=1) when matched then update set id=200 when not matched then insert (id) values (1000);

1 rows affected.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> revoke update, insert on obj_test_user_002.tab_002 from obj_test_user_001;

Succeed.

SQL> revoke select on obj_test_user_003.tab_003 from obj_test_user_001;

CT-01002, Privileges SELECT has not granted to OBJ_TEST_USER_001
SQL> 
SQL> -- 6. test grant/revoke operation
SQL> create table test_tab_sys_001 (id int);

Succeed.

SQL> create table test_tab_sys_002 (id int);

Succeed.

SQL> create view test_view_sys as select * from sys.test_tab_sys_001;

Succeed.

SQL> create sequence test_seq_sys_001 start with 1000;

Succeed.

SQL> 
SQL> grant select, update, insert, delete on test_tab_sys_001 to obj_test_role_001, obj_test_user_004;

Succeed.

SQL> grant select, update, insert, delete on test_tab_sys_002 to obj_test_role_001, obj_test_user_004;

Succeed.

SQL> grant select, alter on test_seq_sys_001 to obj_test_role_001, obj_test_user_004;

Succeed.

SQL> grant all privileges on test_view_sys to obj_test_role_001, obj_test_user_004;

Succeed.

SQL> 
SQL> grant obj_test_role_001 to obj_test_user_001, obj_test_role_002, obj_test_role_003;

Succeed.

SQL> grant obj_test_role_002 to obj_test_user_002, obj_test_role_004;

Succeed.

SQL> grant obj_test_role_003 to obj_test_user_003;

Succeed.

SQL> 
SQL> select * from DBA_TAB_PRIVS where GRANTEE like 'OBJ_TEST%' order by GRANTEE, OWNER, OBJECT_NAME, OBJECT_TYPE, PRIVILEGE;

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_SEQ_SYS_001                                                 SEQUENCE    ALTER                NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_SEQ_SYS_001                                                 SEQUENCE    SELECT               NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_TAB_SYS_001                                                 TABLE       DELETE               NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_TAB_SYS_001                                                 TABLE       INSERT               NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_TAB_SYS_001                                                 TABLE       SELECT               NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_TAB_SYS_001                                                 TABLE       UPDATE               NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_TAB_SYS_002                                                 TABLE       DELETE               NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_TAB_SYS_002                                                 TABLE       INSERT               NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_TAB_SYS_002                                                 TABLE       SELECT               NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_TAB_SYS_002                                                 TABLE       UPDATE               NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        DELETE               NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        INSERT               NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        READ                 NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        REFERENCES           NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        SELECT               NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        UPDATE               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_SEQ_SYS_001                                                 SEQUENCE    ALTER                NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_SEQ_SYS_001                                                 SEQUENCE    SELECT               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_TAB_SYS_001                                                 TABLE       DELETE               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_TAB_SYS_001                                                 TABLE       INSERT               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_TAB_SYS_001                                                 TABLE       SELECT               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_TAB_SYS_001                                                 TABLE       UPDATE               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_TAB_SYS_002                                                 TABLE       DELETE               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_TAB_SYS_002                                                 TABLE       INSERT               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_TAB_SYS_002                                                 TABLE       SELECT               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_TAB_SYS_002                                                 TABLE       UPDATE               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        DELETE               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        INSERT               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        READ                 NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        REFERENCES           NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        SELECT               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        UPDATE               NO       

32 rows fetched.

SQL> select * from DBA_ROLE_PRIVS order by GRANTEE, GRANTED_ROLE;

GRANTEE                                                          GRANTED_ROLE                                                     ADMIN_OPTION
---------------------------------------------------------------- ---------------------------------------------------------------- ------------
DBA                                                              STATISTICS                                                       NO          
OBJ_TEST_ROLE_002                                                OBJ_TEST_ROLE_001                                                NO          
OBJ_TEST_ROLE_003                                                OBJ_TEST_ROLE_001                                                NO          
OBJ_TEST_ROLE_004                                                OBJ_TEST_ROLE_002                                                NO          
OBJ_TEST_USER_001                                                OBJ_TEST_ROLE_001                                                NO          
OBJ_TEST_USER_002                                                OBJ_TEST_ROLE_002                                                NO          
OBJ_TEST_USER_003                                                OBJ_TEST_ROLE_003                                                NO          

7 rows fetched.

SQL> 
SQL> conn obj_test_user_004/Root1234@127.0.0.1:1611

connected.

SQL> select * from USER_TAB_PRIVS order by GRANTEE, OWNER, OBJECT_NAME, OBJECT_TYPE, PRIVILEGE;

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------
OBJ_TEST_USER_004                                                SYS                                                              TEST_SEQ_SYS_001                                                 SEQUENCE    ALTER                NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_SEQ_SYS_001                                                 SEQUENCE    SELECT               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_TAB_SYS_001                                                 TABLE       DELETE               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_TAB_SYS_001                                                 TABLE       INSERT               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_TAB_SYS_001                                                 TABLE       SELECT               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_TAB_SYS_001                                                 TABLE       UPDATE               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_TAB_SYS_002                                                 TABLE       DELETE               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_TAB_SYS_002                                                 TABLE       INSERT               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_TAB_SYS_002                                                 TABLE       SELECT               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_TAB_SYS_002                                                 TABLE       UPDATE               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        DELETE               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        INSERT               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        READ                 NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        REFERENCES           NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        SELECT               NO       
OBJ_TEST_USER_004                                                SYS                                                              TEST_VIEW_SYS                                                    VIEW        UPDATE               NO       

16 rows fetched.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> insert into sys.test_tab_sys_001 values (10000);

1 rows affected.

SQL> select * from sys.test_tab_sys_001;

ID          
------------
10000       

1 rows fetched.

SQL> select * from sys.test_view_sys;

ID          
------------
10000       

1 rows fetched.

SQL> update sys.test_tab_sys_001 set id=20000;

1 rows affected.

SQL> delete from sys.test_tab_sys_001;

1 rows affected.

SQL> select sys.test_seq_sys_001.currval from dual;

CT-00804, Invalid sequence because sequence CURRVAL is not defined in this session
SQL> select sys.test_seq_sys_001.nextval from dual;

NEXTVAL             
--------------------
1000                

1 rows fetched.

SQL> alter sequence sys.test_seq_sys_001 increment by 2;

Succeed.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> revoke select, update, insert, delete on test_tab_sys_001 from obj_test_role_001;

Succeed.

SQL> revoke all privileges on test_tab_sys_001 from obj_test_role_001;

Succeed.

SQL> revoke select on test_view_sys from obj_test_role_001;

Succeed.

SQL> revoke all privileges on test_view_sys from obj_test_role_001;

Succeed.

SQL> revoke select, alter on test_seq_sys_001 from obj_test_role_001;

Succeed.

SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> insert into sys.test_tab_sys_001 values (10000);

CT-01001, Permissions were insufficient
SQL> select * from sys.test_tab_sys_001;

CT-01001, Permissions were insufficient
SQL> select * from sys.test_view_sys;

CT-01001, Permissions were insufficient
SQL> update sys.test_tab_sys_001 set id=20000;

CT-01001, Permissions were insufficient
SQL> delete from sys.test_tab_sys_001;

CT-01001, Permissions were insufficient
SQL> select sys.test_seq_sys_001.currval from dual;

CT-01001, Permissions were insufficient
SQL> select sys.test_seq_sys_001.nextval from dual;

CT-01001, Permissions were insufficient
SQL> alter sequence sys.test_seq_sys_001 increment by 2;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> drop user obj_test_user_004 cascade;

Succeed.

SQL> drop role obj_test_role_003;

Succeed.

SQL> 
SQL> select * from DBA_TAB_PRIVS where GRANTEE like 'OBJ_TEST%' order by GRANTEE, OWNER, OBJECT_NAME, OBJECT_TYPE, PRIVILEGE;

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_TAB_SYS_002                                                 TABLE       DELETE               NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_TAB_SYS_002                                                 TABLE       INSERT               NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_TAB_SYS_002                                                 TABLE       SELECT               NO       
OBJ_TEST_ROLE_001                                                SYS                                                              TEST_TAB_SYS_002                                                 TABLE       UPDATE               NO       

4 rows fetched.

SQL> select * from DBA_ROLE_PRIVS order by GRANTEE, GRANTED_ROLE;

GRANTEE                                                          GRANTED_ROLE                                                     ADMIN_OPTION
---------------------------------------------------------------- ---------------------------------------------------------------- ------------
DBA                                                              STATISTICS                                                       NO          
OBJ_TEST_ROLE_002                                                OBJ_TEST_ROLE_001                                                NO          
OBJ_TEST_ROLE_004                                                OBJ_TEST_ROLE_002                                                NO          
OBJ_TEST_USER_001                                                OBJ_TEST_ROLE_001                                                NO          
OBJ_TEST_USER_002                                                OBJ_TEST_ROLE_002                                                NO          

5 rows fetched.

SQL> 
SQL> drop table test_tab_sys_001 purge;

Succeed.

SQL> drop table test_tab_sys_002;

Succeed.

SQL> drop view test_view_sys;

Succeed.

SQL> drop sequence test_seq_sys_001;

Succeed.

SQL> 
SQL> select * from DBA_TAB_PRIVS where GRANTEE like 'OBJ_TEST%' order by GRANTEE, OWNER, OBJECT_NAME, OBJECT_TYPE, PRIVILEGE;

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------

0 rows fetched.

SQL> select * from DBA_ROLE_PRIVS order by GRANTEE, GRANTED_ROLE;

GRANTEE                                                          GRANTED_ROLE                                                     ADMIN_OPTION
---------------------------------------------------------------- ---------------------------------------------------------------- ------------
DBA                                                              STATISTICS                                                       NO          
OBJ_TEST_ROLE_002                                                OBJ_TEST_ROLE_001                                                NO          
OBJ_TEST_ROLE_004                                                OBJ_TEST_ROLE_002                                                NO          
OBJ_TEST_USER_001                                                OBJ_TEST_ROLE_001                                                NO          
OBJ_TEST_USER_002                                                OBJ_TEST_ROLE_002                                                NO          

5 rows fetched.

SQL> 
SQL> -- 7. privileges to grant/revoke operation
SQL> --7.1 grant owned object to others
SQL> create table obj_test_user_001.grant_test_tab_001 (id int);

Succeed.

SQL> create table obj_test_user_002.grant_test_tab_002 (id int);

Succeed.

SQL> 
SQL> conn obj_test_user_001/Root1234@127.0.0.1:1611

connected.

SQL> grant select on obj_test_user_001.grant_test_tab_001 to obj_test_user_003;

Succeed.

SQL> 
SQL> --7.2 has grant any object privilege ?
SQL> grant select on obj_test_user_002.grant_test_tab_002 to obj_test_user_003;

CT-01001, Permissions were insufficient
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant grant any object privilege to obj_test_user_001;

Succeed.

SQL> 
SQL> conn obj_test_user_001/Root1234@127.0.0.1:1611

connected.

SQL> grant select on obj_test_user_002.grant_test_tab_002 to obj_test_user_003;

Succeed.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> revoke grant any object privilege from obj_test_user_001;

Succeed.

SQL> 
SQL> --7.3 has granted object privilege with grant option ?
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> grant select on obj_test_user_002.grant_test_tab_002 to obj_test_user_001 with grant option;

Succeed.

SQL> 
SQL> conn obj_test_user_001/Root1234@127.0.0.1:1611

connected.

SQL> grant select on obj_test_user_002.grant_test_tab_002 to obj_test_user_003;

Succeed.

SQL> 
SQL> --7.4 check grant/revoke all privileges 
SQL> grant all privileges on obj_test_user_002.grant_test_tab_002 to obj_test_user_003;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn obj_test_user_002/Root1234@127.0.0.1:1611

connected.

SQL> grant all privileges on obj_test_user_002.grant_test_tab_002 to obj_test_user_001 with grant option;

Succeed.

SQL> 
SQL> conn obj_test_user_001/Root1234@127.0.0.1:1611

connected.

SQL> grant all privileges on obj_test_user_002.grant_test_tab_002 to obj_test_user_003;

Succeed.

SQL> 
SQL> -- 8. check alter password privilege
SQL> alter user obj_test_user_002 identified by root_new_1234 replace Root1234;

CT-01001, Permissions were insufficient
SQL> alter user obj_test_user_001 identified by root_new_1234 replace Root1234;

Succeed.

SQL> 
SQL> -- 9. check alter user to other's user
SQL> conn obj_test_user_001/root_new_1234@127.0.0.1:1611

connected.

SQL> alter user obj_test_user_002 identified by root_new_1234 replace Root1234;

CT-01001, Permissions were insufficient
SQL> alter user obj_test_user_002 PASSWORD EXPIRE;

CT-01001, Permissions were insufficient
SQL> alter user obj_test_user_002 ACCOUNT  LOCK;

CT-01001, Permissions were insufficient
SQL> alter user obj_test_user_002 ACCOUNT  UNLOCK;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> alter user obj_test_user_002 identified by root_new_1234 replace Root1234;

Succeed.

SQL> alter user obj_test_user_002 identified by Root1234 replace root_new_1234;

Succeed.

SQL> alter user obj_test_user_002 ACCOUNT  LOCK;

Succeed.

SQL> alter user obj_test_user_002 ACCOUNT  UNLOCK;

Succeed.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> drop user if exists obj_test_user_001 cascade;

Succeed.

SQL> drop user if exists obj_test_user_002 cascade;

Succeed.

SQL> drop user if exists obj_test_user_003 cascade;

Succeed.

SQL> drop user if exists obj_test_user_004 cascade;

Succeed.

SQL> 
SQL> drop role obj_test_role_001;

Succeed.

SQL> drop role obj_test_role_002;

Succeed.

SQL> drop role obj_test_role_003;

CT-00783, The role OBJ_TEST_ROLE_003 does not exist.
SQL> drop role obj_test_role_004;

Succeed.

SQL> 
SQL> select * from DBA_TAB_PRIVS where GRANTEE like 'OBJ_TEST%' order by GRANTEE, OWNER, OBJECT_NAME, OBJECT_TYPE, PRIVILEGE;

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------

0 rows fetched.

SQL> select * from DBA_ROLE_PRIVS order by GRANTEE, GRANTED_ROLE;

GRANTEE                                                          GRANTED_ROLE                                                     ADMIN_OPTION
---------------------------------------------------------------- ---------------------------------------------------------------- ------------
DBA                                                              STATISTICS                                                       NO          

1 rows fetched.

SQL> 
SQL> -- trigger & procedure
SQL> 
SQL> --1. user A create a trigger T (in schema A) on table C (C in Schema A) : CREATE TRIGGER
SQL> drop user if exists user_a cascade;

Succeed.

SQL> drop user if exists user_b cascade;

Succeed.

SQL> drop user if exists user_1 cascade;

Succeed.

SQL> drop user if exists user_2 cascade;

Succeed.

SQL> 
SQL> create user user_a identified by Root1234;

Succeed.

SQL> grant create session to user_a;

Succeed.

SQL> grant create table to user_a;

Succeed.

SQL> connect user_a/Root1234@127.0.0.1:1611

connected.

SQL> create table tbl_a (f1 int, f2 varchar(30));

Succeed.

SQL> 
SQL> -- create trigger failed: need create trigger privilege
SQL> create or replace trigger tr_a
  2     before insert
  3     on tbl_a
  4     for each row
  5     begin
  6         select 1 into :new.f2 from dual;
  7     end;
  8 /

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> grant create trigger to user_a;

Succeed.

SQL> connect user_a/Root1234@127.0.0.1:1611

connected.

SQL> 
SQL> create or replace trigger tr_a
  2     before insert
  3     on tbl_a
  4     for each row
  5     begin
  6         select 1 into :new.f2 from dual;
  7     end;
  8 /

Succeed.

SQL> 
SQL> 
SQL> --2. user A create a trigger T (in schema A) on table C (C in Schema B) : CREATE ANY TRIGGER
SQL> conn / as sysdba

connected.

SQL> create user user_b identified by Root1234;

Succeed.

SQL> create table user_b.tbl_b (f1 int, f2 varchar(30));

Succeed.

SQL> connect user_a/Root1234@127.0.0.1:1611

connected.

SQL> 
SQL> -- create trigger failed: need create any trigger privilege
SQL> create or replace trigger tr_a_02
  2     before insert
  3     on user_b.tbl_b
  4     for each row
  5     begin
  6         select 1 into :new.f2 from dual;
  7     end;
  8 /

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> grant create any trigger to user_a;

Succeed.

SQL> 
SQL> connect user_a/Root1234@127.0.0.1:1611

connected.

SQL> 
SQL> -- create trigger succeed
SQL> create or replace trigger tr_a_02
  2     before insert
  3     on user_b.tbl_b
  4     for each row
  5     begin
  6         select 1 into :new.f2 from dual;
  7     end;
  8 /

Succeed.

SQL> 
SQL> -- 3. user A create a trigger T (in schema B) on table C (C in Schema A) : CREATE ANY TRIGGER
SQL> conn / as sysdba

connected.

SQL> revoke create any trigger from user_a;

Succeed.

SQL> 
SQL> connect user_a/Root1234@127.0.0.1:1611

connected.

SQL> 
SQL> -- create trigger failed: need create any trigger privilege
SQL> create or replace trigger user_b.tr_b_01
  2     before insert
  3     on user_a.tbl_a
  4     for each row
  5     begin
  6         select 1 into :new.f2 from dual;
  7     end;
  8 /

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> grant create any trigger to user_a;

Succeed.

SQL> 
SQL> connect user_a/Root1234@127.0.0.1:1611

connected.

SQL> -- create trigger succeed
SQL> create or replace trigger user_b.tr_b_01
  2     before insert
  3     on user_a.tbl_a
  4     for each row
  5     begin
  6         select 1 into :new.f2 from dual;
  7     end;
  8 /

Succeed.

SQL> 
SQL> -- 4. user A create a trigger T (in schema B) on table C (C in Schema B) : CREATE ANY TRIGGER
SQL> conn / as sysdba

connected.

SQL> revoke create any trigger from user_a;

Succeed.

SQL> 
SQL> connect user_a/Root1234@127.0.0.1:1611

connected.

SQL> 
SQL> -- create trigger failed: need create any trigger privilege
SQL> create or replace trigger user_b.tr_b_01
  2     before insert
  3     on user_b.tbl_b
  4     for each row
  5     begin
  6         select 1 into :new.f2 from dual;
  7     end;
  8 /

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> grant create any trigger to user_a;

Succeed.

SQL> 
SQL> connect user_a/Root1234@127.0.0.1:1611

connected.

SQL> 
SQL> -- create trigger succeed
SQL> create or replace trigger user_b.tr_b_02
  2     before insert
  3     on user_b.tbl_b
  4     for each row
  5     begin
  6         select 1 into :new.f2 from dual;
  7     end;
  8 /

Succeed.

SQL> 
SQL> -- failed, invalid name
SQL> create or replace trigger user_b.a@432^%*~!<>
  2     before insert
  3     on user_b.tbl_b
  4     for each row
  5     begin
  6         select 1 into :new.f2 from dual;
  7     end;
  8 /

CT-00916, [1:27]PL/SQL:syntax error(Can not using this sepecial char '!' as object name)
SQL> 
SQL> -- 5 procedure
SQL> connect / as sysdba

connected.

SQL> create user user1 identified by Root1234;

Succeed.

SQL> grant create session, create table to user1;

Succeed.

SQL> connect user1/Root1234@127.0.0.1:1611

connected.

SQL> 
SQL> -- failed
SQL> create or replace procedure pro_a
  2 as
  3 	v_tblName varchar2(30);
  4 begin
  5 	v_tblName := 'abc';
  6 	dbe_output.print_line(to_char(sysdate,'yyyy-mm-dd HH24:MI:SS') || '>>process table:' || v_tblName || ' end');
  7 end;
  8 /

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> grant create procedure to user1;

Succeed.

SQL> connect user1/Root1234@127.0.0.1:1611

connected.

SQL> -- succeed
SQL> create or replace procedure pro_a
  2 as
  3 	v_tblName varchar2(30);
  4 begin
  5 	v_tblName := 'abc';
  6 	dbe_output.print_line(to_char(sysdate,'yyyy-mm-dd HH24:MI:SS') || '>>process table:' || v_tblName || ' end');
  7 end;
  8 /

Succeed.

SQL> 
SQL> conn / as sysdba

connected.

SQL> revoke create procedure from user1;

Succeed.

SQL> connect user1/Root1234@127.0.0.1:1611

connected.

SQL> -- failed
SQL> create or replace procedure pro_a
  2 as
  3 	v_tblName varchar2(30);
  4 begin
  5 	v_tblName := 'abc';
  6 	dbe_output.print_line(to_char(sysdate,'yyyy-mm-dd HH24:MI:SS') || '>>process table:' || v_tblName || ' end');
  7 end;
  8 /

CT-01001, Permissions were insufficient
SQL> 
SQL> -- create any procedure
SQL> connect / as sysdba

connected.

SQL> create user user2 identified by Root1234;

Succeed.

SQL> conn user1/Root1234@127.0.0.1:1611

connected.

SQL> 
SQL> -- failed
SQL> create or replace procedure user2.pro_a
  2 as
  3 	v_tblName varchar2(30);
  4 begin
  5 	v_tblName := 'abc';
  6 	dbe_output.print_line(to_char(sysdate,'yyyy-mm-dd HH24:MI:SS') || '>>process table:' || v_tblName || ' end');
  7 end;
  8 /

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> grant create procedure to user1;

Succeed.

SQL> conn user1/Root1234@127.0.0.1:1611

connected.

SQL> -- failed
SQL> create or replace procedure user2.pro_a
  2 as
  3 	v_tblName varchar2(30);
  4 begin
  5 	v_tblName := 'abc';
  6 	dbe_output.print_line(to_char(sysdate,'yyyy-mm-dd HH24:MI:SS') || '>>process table:' || v_tblName || ' end');
  7 end;
  8 /

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> grant create any procedure to user1;

Succeed.

SQL> conn user1/Root1234@127.0.0.1:1611

connected.

SQL> -- succeed
SQL> create or replace procedure user2.pro_a
  2 as
  3 	v_tblName varchar2(30);
  4 begin
  5 	v_tblName := 'abc';
  6 	dbe_output.print_line(to_char(sysdate,'yyyy-mm-dd HH24:MI:SS') || '>>process table:' || v_tblName || ' end');
  7 end;
  8 /

Succeed.

SQL> 
SQL> conn / as sysdba

connected.

SQL> revoke create any procedure from user1;

Succeed.

SQL> conn user1/Root1234@127.0.0.1:1611

connected.

SQL> -- failed
SQL> create or replace procedure user2.pro_a
  2 as
  3 	v_tblName varchar2(30);
  4 begin
  5 	v_tblName := 'abc';
  6 	dbe_output.print_line(to_char(sysdate,'yyyy-mm-dd HH24:MI:SS') || '>>process table:' || v_tblName || ' end');
  7 end;
  8 /

CT-01001, Permissions were insufficient
SQL> 
SQL> -- check drop procedure privileges
SQL> drop procedure pro_a; -- succeed

Succeed.

SQL> drop procedure user2.pro_a; -- failed

CT-01001, Permissions were insufficient
SQL> 
SQL> connect / as sysdba

connected.

SQL> grant drop any procedure to user1;

Succeed.

SQL> drop procedure user2.pro_a; -- succeed

Succeed.

SQL> 
SQL> -- check drop trigger privileges
SQL> connect user_a/Root1234@127.0.0.1:1611

connected.

SQL> drop trigger user_a.tr_a;    -- succeed

Succeed.

SQL> drop trigger user_a.tr_a_02; -- succeed

Succeed.

SQL> drop trigger user_b.tr_b_01; -- failed

CT-01001, Permissions were insufficient
SQL> 
SQL> connect / as sysdba

connected.

SQL> grant drop any trigger to user_a;

Succeed.

SQL> connect user_a/Root1234@127.0.0.1:1611

connected.

SQL> drop trigger user_b.tr_b_01; -- succeed

Succeed.

SQL> 
SQL> conn / as sysdba

connected.

SQL> drop user user1 cascade;

Succeed.

SQL> drop user user2 cascade;

Succeed.

SQL> drop user user_a cascade;

Succeed.

SQL> drop user user_b cascade;

Succeed.

SQL> 
SQL> -- check with grant option
SQL> -- 1. create user and table
SQL> create user user1 identified by 'cantian_234';

Succeed.

SQL> create user user2 identified by 'cantian_234';

Succeed.

SQL> create user user3 identified by 'cantian_234';

Succeed.

SQL> grant create session, create table to user1, user2, user3;

Succeed.

SQL> 
SQL> connect user1/cantian_234@127.0.0.1:1611

connected.

SQL> drop table if exists all_type_tb;

Succeed.

SQL> create table all_type_tb(id int, c_varchar varchar(10));

Succeed.

SQL> insert into all_type_tb values(1,'xian');

1 rows affected.

SQL> commit;

Succeed.

SQL> 
SQL> -- 2. grant to user2 without grant option
SQL> connect user1/cantian_234@127.0.0.1:1611

connected.

SQL> grant select on user1.all_type_tb to user2;

Succeed.

SQL> 
SQL> -- 3. grant to user2 with grant option
SQL> connect user1/cantian_234@127.0.0.1:1611

connected.

SQL> grant select on user1.all_type_tb to user2 with grant option;

Succeed.

SQL> 
SQL> -- 4. grant to user3, expect succeed.
SQL> connect user2/cantian_234@127.0.0.1:1611

connected.

SQL> grant select on user1.all_type_tb to user3;

Succeed.

SQL> 
SQL> connect / as sysdba

connected.

SQL> drop user user1 cascade;

Succeed.

SQL> drop user user2 cascade;

Succeed.

SQL> drop user user3 cascade;

Succeed.

SQL> 
SQL> -- check whether the privilege type is allowed for the object
SQL> connect sys/Huawei@123@127.0.0.1:1611

connected.

SQL> create user user1 identified by 'cantian_234';

Succeed.

SQL> create user user2 identified by 'cantian_234';

Succeed.

SQL> grant create session, create sequence, create view, create table to user1, user2;

Succeed.

SQL> 
SQL> connect user1/cantian_234@127.0.0.1:1611

connected.

SQL> 
SQL> drop table if exists all_type_tb purge;

Succeed.

SQL> create table all_type_tb (
  2   id int,
  3   c_varchar varchar(10)
  4 );

Succeed.

SQL> 
SQL> drop view if exists all_type_tb_v;

Succeed.

SQL> create view all_type_tb_v as select * from dual;

Succeed.

SQL> 
SQL> create sequence WGO_SEQ MINVALUE 1 MAXVALUE 9223372036854775807;

Succeed.

SQL> 
SQL> -- execute is not allowed for table
SQL> grant execute on all_type_tb to user2 with grant option;

CT-00601, [1:7]Sql syntax error: EXECUTE privilege not allowed for tables
SQL> 
SQL> -- execute/alter/index is not allowed for view
SQL> grant execute on all_type_tb_v to user2 with grant option;

CT-00601, [1:7]Sql syntax error: EXECUTE privilege not allowed for views
SQL> grant alter   on all_type_tb_v to user2 with grant option;

CT-00601, [1:7]Sql syntax error: ALTER privilege not allowed for views
SQL> grant index   on all_type_tb_v to user2 with grant option;

CT-00601, [1:7]Sql syntax error: INDEX privilege not allowed for views
SQL> 
SQL> -- execute/index/update/delete/read/references is not allowed for sequence
SQL> grant execute on user1.WGO_SEQ to user2 with grant option;

CT-00601, [1:7]Sql syntax error: EXECUTE privilege not allowed for sequences
SQL> grant index on user1.WGO_SEQ to user2 with grant option;

CT-00601, [1:7]Sql syntax error: INDEX privilege not allowed for sequences
SQL> grant update on user1.WGO_SEQ to user2 with grant option;

CT-00601, [1:7]Sql syntax error: UPDATE privilege not allowed for sequences
SQL> grant delete on user1.WGO_SEQ to user2 with grant option;

CT-00601, [1:7]Sql syntax error: DELETE privilege not allowed for sequences
SQL> grant read on user1.WGO_SEQ to user2 with grant option;

CT-00601, [1:7]Sql syntax error: READ privilege not allowed for sequences
SQL> grant references on user1.WGO_SEQ to user2 with grant option;

CT-00601, [1:7]Sql syntax error: REFERENCES privilege not allowed for sequences
SQL> 
SQL> connect sys/Huawei@123@127.0.0.1:1611

connected.

SQL> drop user user1 cascade;

Succeed.

SQL> drop user user2 cascade;

Succeed.

SQL> 
SQL> -- check grant role to user/role
SQL> create user user1 identified by cantian_234;

Succeed.

SQL> create user user2 identified by cantian_234;

Succeed.

SQL> grant create session, create sequence, create table to user1, user2;

Succeed.

SQL> 
SQL> connect user1/cantian_234@127.0.0.1:1611

connected.

SQL> create sequence WGO_SEQ MINVALUE 1 MAXVALUE 9223372036854775807;

Succeed.

SQL> create table t_001 (id int);

Succeed.

SQL> grant select, alter on user1.WGO_SEQ to user2 with grant option;

Succeed.

SQL> grant select, insert on t_001 to user2;

Succeed.

SQL> insert into t_001 values (100);

1 rows affected.

SQL> 
SQL> connect user2/cantian_234@127.0.0.1:1611

connected.

SQL> select user1.WGO_SEQ.nextval from dual;

NEXTVAL             
--------------------
1                   

1 rows fetched.

SQL> insert into user1.t_001 values (200);

1 rows affected.

SQL> select * from user1.t_001;

ID          
------------
200         

1 rows fetched.

SQL> 
SQL> connect sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant connect, resource to public;

Succeed.

SQL> 
SQL> connect user2/cantian_234@127.0.0.1:1611

connected.

SQL> select user1.WGO_SEQ.nextval from dual;

NEXTVAL             
--------------------
2                   

1 rows fetched.

SQL> insert into user1.t_001 values (200);

1 rows affected.

SQL> select * from user1.t_001;

ID          
------------
200         

1 rows fetched.

SQL> 
SQL> connect user1/cantian_234@127.0.0.1:1611

connected.

SQL> drop sequence WGO_SEQ;

Succeed.

SQL> 
SQL> connect sys/Huawei@123@127.0.0.1:1611

connected.

SQL> create role role_001;

Succeed.

SQL> grant delete on user1.t_001 to user2;

Succeed.

SQL> grant role_001 to user2;

Succeed.

SQL> 
SQL> connect user2/cantian_234@127.0.0.1:1611

connected.

SQL> delete from user1.t_001;

0 rows affected.

SQL> select * from user1.t_001;

ID          
------------

0 rows fetched.

SQL> 
SQL> connect sys/Huawei@123@127.0.0.1:1611

connected.

SQL> drop user user1 cascade;

Succeed.

SQL> drop user user2 cascade;

Succeed.

SQL> drop role role_001;

Succeed.

SQL> revoke connect, resource from public;

Succeed.

SQL> 
SQL> -- grant execute on user1.procedure/function/package to user2;
SQL> create user user_a identified by Root1234;

Succeed.

SQL> create user user_b identified by Root1234;

Succeed.

SQL> 
SQL> grant connect, create procedure, create table to user_a;

Succeed.

SQL> grant connect, create table to user_b;

Succeed.

SQL> 
SQL> conn user_a/Root1234@127.0.0.1:1611

connected.

SQL> CREATE OR REPLACE FUNCTION Zenith_Test_Sysdate return varchar2
  2 IS
  3  cunt int := 0;
  4  Begin
  5  select count(*) into cunt from dual;
  6  dbe_output.print_line(cunt);
  7  IF SQL % FOUND
  8   then
  9  return cunt;
 10  end if;
 11  End;
 12 /

Succeed.

SQL> 
SQL> CREATE OR REPLACE PROCEDURE Zenith_Test_004(param1 out varchar2)
  2 IS
  3     tmp varchar2(20) :='12345678';
  4 begin
  5  param1:=param1||tmp;
  6 end Zenith_Test_004;
  7 /

Succeed.

SQL> 
SQL> -- grant invalid privilege on procedure/function, failed.
SQL> grant select on Zenith_Test_Sysdate to user_b;

CT-00601, [1:7]Sql syntax error: SELECT privilege not allowed for function
SQL> grant insert on Zenith_Test_Sysdate to user_b;

CT-00601, [1:7]Sql syntax error: INSERT privilege not allowed for function
SQL> grant update on Zenith_Test_Sysdate to user_b;

CT-00601, [1:7]Sql syntax error: UPDATE privilege not allowed for function
SQL> grant delete on Zenith_Test_Sysdate to user_b;

CT-00601, [1:7]Sql syntax error: DELETE privilege not allowed for function
SQL> grant references on Zenith_Test_Sysdate to user_b;

CT-00601, [1:7]Sql syntax error: REFERENCES privilege not allowed for function
SQL> grant index on Zenith_Test_Sysdate to user_b;

CT-00601, [1:7]Sql syntax error: INDEX privilege not allowed for function
SQL> grant read on Zenith_Test_Sysdate to user_b;

CT-00601, [1:7]Sql syntax error: READ privilege not allowed for function
SQL> 
SQL> grant select on Zenith_Test_004 to user_b;

CT-00601, [1:7]Sql syntax error: SELECT privilege not allowed for procedure
SQL> grant insert on Zenith_Test_004 to user_b;

CT-00601, [1:7]Sql syntax error: INSERT privilege not allowed for procedure
SQL> grant update on Zenith_Test_004 to user_b;

CT-00601, [1:7]Sql syntax error: UPDATE privilege not allowed for procedure
SQL> grant delete on Zenith_Test_004 to user_b;

CT-00601, [1:7]Sql syntax error: DELETE privilege not allowed for procedure
SQL> grant references on Zenith_Test_004 to user_b;

CT-00601, [1:7]Sql syntax error: REFERENCES privilege not allowed for procedure
SQL> grant index on Zenith_Test_004 to user_b;

CT-00601, [1:7]Sql syntax error: INDEX privilege not allowed for procedure
SQL> grant read on Zenith_Test_004 to user_b;

CT-00601, [1:7]Sql syntax error: READ privilege not allowed for procedure
SQL> 
SQL> -- grant execute to user
SQL> grant execute on Zenith_Test_Sysdate to user_b;  -- succeed

Succeed.

SQL> grant all on Zenith_Test_004 to user_b;  -- succeed

Succeed.

SQL> 
SQL> conn user_b/Root1234@127.0.0.1:1611

connected.

SQL> select * from user_tab_privs order by OBJECT_NAME; -- 2 rows

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------
USER_B                                                           USER_A                                                           ZENITH_TEST_004                                                  PROCEDURE   EXECUTE              NO       
USER_B                                                           USER_A                                                           ZENITH_TEST_SYSDATE                                              PROCEDURE   EXECUTE              NO       

2 rows fetched.

SQL> 
SQL> select user_a.Zenith_Test_Sysdate() from dual;

USER_A.ZENITH_TEST_SYSDATE()                                    
----------------------------------------------------------------
1                                                               

1 rows fetched.

SQL> 
SQL> Declare
  2     v_char1 char(9) :='A';
  3 begin
  4     user_a.Zenith_Test_004(v_char1);
  5     dbe_output.print_line('OUT PUT RESULT:'||v_char1);
  6 end;
  7 /

PL/SQL procedure successfully completed.

SQL> 
SQL> conn user_a/Root1234@127.0.0.1:1611

connected.

SQL> revoke execute on Zenith_Test_Sysdate from user_b; -- succeed

Succeed.

SQL> revoke all on Zenith_Test_004 from user_b;  -- succeed

Succeed.

SQL> 
SQL> conn user_b/Root1234@127.0.0.1:1611

connected.

SQL> select * from user_tab_privs order by OBJECT_NAME; -- 0 rows

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------

0 rows fetched.

SQL> -- no privilege
SQL> select user_a.Zenith_Test_Sysdate() from dual;

CT-01001, Permissions were insufficient
SQL> 
SQL> Declare
  2     v_char1 char(9) :='A';
  3 begin
  4     user_a.Zenith_Test_004(v_char1);
  5     dbe_output.print_line('OUT PUT RESULT:'||v_char1);
  6 end;
  7 /

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> 
SQL> -- test truncate table privilege
SQL> drop table if exists user_b.test_truncate_tab;

Succeed.

SQL> create table user_b.test_truncate_tab(f1 int, f2 varchar2(30));

Succeed.

SQL> create synonym user_a.truncate_tab_syn for user_b.test_truncate_tab;

Succeed.

SQL> insert into user_b.test_truncate_tab values (1, 'wangzherongyao');

1 rows affected.

SQL> 
SQL> conn user_a/Root1234@127.0.0.1:1611

connected.

SQL> truncate table truncate_tab_syn; -- no privilege

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> grant drop any table to user_a;

Succeed.

SQL> 
SQL> conn user_a/Root1234@127.0.0.1:1611

connected.

SQL> truncate table truncate_tab_syn; -- succeed

CT-00843, The table or view USER_A.TRUNCATE_TAB_SYN does not exist.
SQL> 
SQL> conn / as sysdba

connected.

SQL> select * from user_b.test_truncate_tab; -- 0 rows

F1           F2                            
------------ ------------------------------

0 rows fetched.

SQL> 
SQL> conn user_a/Root1234@127.0.0.1:1611

connected.

SQL> create or replace procedure sp1
  2 as
  3 begin
  4  dbe_output.print_line('test');
  5 end;
  6 /

Succeed.

SQL> 
SQL> exec sp1;

PL/SQL procedure successfully completed.

SQL> grant all on sp1 to user_b;

Succeed.

SQL> 
SQL> conn user_b/Root1234@127.0.0.1:1611

connected.

SQL> select * from user_tab_privs;

GRANTEE                                                          OWNER                                                            OBJECT_NAME                                                      OBJECT_TYPE PRIVILEGE            GRANTABLE
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------- -------------------- ---------
USER_B                                                           USER_A                                                           SP1                                                              PROCEDURE   EXECUTE              NO       

1 rows fetched.

SQL> exec sp1;  -- error

CT-00944, PL/SQL(USER_B.ANONYMOUS BLOCK) terminated with compiling errors
[1:2] PLC-00828 procedure USER_B.SP1 does not exist

SQL> exec user_a.sp1;

PL/SQL procedure successfully completed.

SQL> 
SQL> conn user_a/Root1234@127.0.0.1:1611

connected.

SQL> create table user_a_tab(id int not null);

Succeed.

SQL> create table user_a_tab_1(id int not null);

Succeed.

SQL> alter table user_a_tab add constraint pk_1 primary key (id);

Succeed.

SQL> alter table user_a_tab_1 add constraint fk_2 foreign key (id) references user_a.user_a_tab(id); -- succeed

Succeed.

SQL> 
SQL> conn user_b/Root1234@127.0.0.1:1611

connected.

SQL> create table user_b_tab(id int not null);

Succeed.

SQL> create table user_b_tab_1(id int not null);

Succeed.

SQL> alter table user_b_tab_1 add constraint pk_2 primary key (id);

Succeed.

SQL> alter table user_b_tab add constraint fk_1 foreign key (id) references user_a.user_a_tab(id); -- failed

CT-01001, Permissions were insufficient
SQL> 
SQL> conn user_a/Root1234@127.0.0.1:1611

connected.

SQL> grant references on user_a_tab to user_b;

Succeed.

SQL> 
SQL> conn user_b/Root1234@127.0.0.1:1611

connected.

SQL> alter table user_b_tab add constraint fk_1 foreign key (id) references user_a.user_a_tab(id); -- succeed

Succeed.

SQL> 
SQL> conn / as sysdba

connected.

SQL> alter table user_a.user_a_tab_1 add constraint fk_3 foreign key (id) references user_b.user_b_tab_1(id); -- failed, user_a has no references privilege on user_b.user_b_tab_1

CT-01001, Permissions were insufficient
SQL> 
SQL> drop user user_a cascade;

Succeed.

SQL> drop user user_b cascade;

Succeed.

SQL> 
SQL> create user whf identified by Whf00174302;

Succeed.

SQL> create or replace procedure whf.ccc(a int, b int)
  2 as
  3 begin
  4 null;
  5 end;
  6 /

Succeed.

SQL> drop user whf cascade;

Succeed.

SQL> 
SQL> create user whf identified by Whf00174302;

Succeed.

SQL> create or replace procedure whf.ccc(a int, b int)
  2 as
  3 begin
  4 null;
  5 end;
  6 /

Succeed.

SQL> drop user whf cascade;

Succeed.

SQL> 
SQL> -- test grant/revoke privilege from self.
SQL> drop user if exists c_00218870 cascade;

Succeed.

SQL> create user c_00218870 identified by Root1234;

Succeed.

SQL> create table c_00218870.tab_001 (f1 int);

Succeed.

SQL> grant connect, create table to c_00218870 with admin option;

Succeed.

SQL> 
SQL> grant delete on c_00218870.tab_001 to c_00218870;  -- succeed

Succeed.

SQL> revoke delete on c_00218870.tab_001 from c_00218870; -- failed

CT-01010, [1:52]Object permissions cannot be revoked from object holders
SQL> 
SQL> conn c_00218870/Root1234@127.0.0.1:1611

connected.

SQL> --revoke object privilege
SQL> grant delete on c_00218870.tab_001 to c_00218870;  -- succeed

Succeed.

SQL> revoke delete on c_00218870.tab_001 from c_00218870; -- failed

CT-01005, [1:52]Users cannot grant permissions to or revoke permissions from themselves
SQL> revoke all privileges on c_00218870.tab_001 from c_00218870; -- failed

CT-01005, [1:60]Users cannot grant permissions to or revoke permissions from themselves
SQL> 
SQL> --revoke system privilege
SQL> revoke create table from c_00218870; -- succeed

Succeed.

SQL> create table tab_002 (f1 int);  -- failed

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> drop user c_00218870 cascade;

Succeed.

SQL> 
SQL> -- test: check drop any index / drop any sequence privilege
SQL> create user session_schema_001 identified by Cantian_234;

Succeed.

SQL> grant create session, alter session to session_schema_001;

Succeed.

SQL> 
SQL> -- create table
SQL> drop table if exists test_001 purge;

Succeed.

SQL> create table test_001(i int);

Succeed.

SQL> create index test_001_index on test_001(i);

Succeed.

SQL> insert into test_001 values(1);

1 rows affected.

SQL> 
SQL> -- create sequence
SQL> drop sequence if exists seq_001;

Succeed.

SQL> create sequence seq_001 start with 1000;

Succeed.

SQL> 
SQL> conn session_schema_001/Cantian_234@127.0.0.1:1611

connected.

SQL> alter session set current_schema=sys;

Succeed.

SQL> 
SQL> drop index  test_001_index on test_001; -- no privilege

CT-01001, Permissions were insufficient
SQL> drop sequence seq_001;      -- no privilege

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> grant drop any index, drop any sequence to session_schema_001;

Succeed.

SQL> 
SQL> conn session_schema_001/Cantian_234@127.0.0.1:1611

connected.

SQL> alter session set current_schema=sys;

Succeed.

SQL> drop index  test_001_index on test_001; 

CT-01001, Permissions were insufficient
SQL> drop sequence seq_001;      

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> drop table test_001 purge;

Succeed.

SQL> 
SQL> -- test : synonym
SQL> drop table if exists test_schema_001 purge;

Succeed.

SQL> create table test_schema_001(i int);

Succeed.

SQL> insert into test_schema_001 values(1);

1 rows affected.

SQL> 
SQL> create or replace public synonym test_schema_sy for test_schema_001;

Succeed.

SQL> grant select on test_schema_sy to session_schema_001; -- succeed

Succeed.

SQL> 
SQL> conn session_schema_001/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from sys.test_schema_001;  -- 1 row

I           
------------
1           

1 rows fetched.

SQL> 
SQL> conn / as sysdba

connected.

SQL> drop table test_schema_001 purge;

Succeed.

SQL> drop public synonym test_schema_sy force;

Succeed.

SQL> 
SQL> -- test : add/enable check constraint
SQL> grant create any table, alter any table to session_schema_001;

Succeed.

SQL> 
SQL> conn session_schema_001/Cantian_234@127.0.0.1:1611

connected.

SQL> alter session set current_schema=sys;

Succeed.

SQL> create table test_zlj(i int);

CT-01001, Permissions were insufficient
SQL> alter table test_zlj add constraint test_zlj_con check(i<10); 

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> drop table test_zlj purge;

CT-00843, The table or view SYS.TEST_ZLJ does not exist.
SQL> drop user session_schema_001 cascade;

Succeed.

SQL> 
SQL> -- test : can not revoke system privilege from SYS and DBA
SQL> revoke create session from sys; -- failed

CT-01004, Can not revoke privilege from SYS
SQL> revoke create session from DBA; -- failed

CT-01004, Can not revoke privilege from DBA
SQL> create user user_priv_revoke identified by Root1234;

Succeed.

SQL> grant all to user_priv_revoke;

Succeed.

SQL> conn user_priv_revoke/Root1234@127.0.0.1:1611

connected.

SQL> revoke create session from sys; -- failed

CT-01004, Can not revoke privilege from SYS
SQL> revoke create session from DBA; -- failed

CT-01004, Can not revoke privilege from DBA
SQL> create table tab_001 (f1 int);

Succeed.

SQL> grant all on tab_001 to sys;

Succeed.

SQL> revoke all on tab_001 from sys;

Succeed.

SQL> revoke select on tab_001 from sys;

CT-01002, Privileges SELECT has not granted to SYS
SQL> 
SQL> conn / as sysdba

connected.

SQL> 
SQL> 
SQL> --test : cascading recycling of permissions
SQL> connect sys/Huawei@123@127.0.0.1:1611

connected.

SQL> drop user if exists myuser_crp1;

Succeed.

SQL> drop user if exists myuser_crp2;

Succeed.

SQL> drop user if exists myuser_crp3;

Succeed.

SQL> drop table if exists mytable_crp;

Succeed.

SQL> create  user myuser_crp1 identified by Mypwd123;

Succeed.

SQL> create  user myuser_crp2 identified by Mypwd123;

Succeed.

SQL> create  user myuser_crp3 identified by Mypwd123;

Succeed.

SQL> grant create session to myuser_crp1,myuser_crp2,myuser_crp3;

Succeed.

SQL> create table mytable_crp(id int);

Succeed.

SQL> grant select,insert on mytable_crp to myuser_crp1 with grant option;

Succeed.

SQL> conn myuser_crp1/Mypwd123@127.0.0.1:1611

connected.

SQL> select * from sys.mytable_crp;

ID          
------------

0 rows fetched.

SQL> grant select,insert on sys.mytable_crp to myuser_crp2 with grant option;

Succeed.

SQL> conn myuser_crp2/Mypwd123@127.0.0.1:1611

connected.

SQL> select * from sys.mytable_crp;

ID          
------------

0 rows fetched.

SQL> grant select,insert on sys.mytable_crp to myuser_crp3;

Succeed.

SQL> connect sys/Huawei@123@127.0.0.1:1611

connected.

SQL> revoke select on sys.mytable_crp from myuser_crp1;

Succeed.

SQL> conn myuser_crp1/Mypwd123@127.0.0.1:1611

connected.

SQL> select * from sys.mytable_crp;

CT-01001, Permissions were insufficient
SQL> conn myuser_crp2/Mypwd123@127.0.0.1:1611

connected.

SQL> select * from sys.mytable_crp;

CT-01001, Permissions were insufficient
SQL> conn myuser_crp3/Mypwd123@127.0.0.1:1611

connected.

SQL> select * from sys.mytable_crp;

CT-01001, Permissions were insufficient
SQL> connect sys/Huawei@123@127.0.0.1:1611

connected.

SQL> drop user myuser_crp1;

Succeed.

SQL> conn myuser_crp2/Mypwd123@127.0.0.1:1611

connected.

SQL> insert into sys.mytable_crp values(1);

CT-01001, Permissions were insufficient
SQL> conn myuser_crp3/Mypwd123@127.0.0.1:1611

connected.

SQL> insert into sys.mytable_crp values(1);

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop table mytable_crp;

Succeed.

SQL> drop user myuser_crp2;

Succeed.

SQL> drop user myuser_crp3;

Succeed.

SQL> 
SQL> -- test : if add new privilege items.
SQL> -- WARNING: if you add a new privilege in sys_privs_id, you should also add it for the views. otherwise 'UNKOWN' will be presented.
SQL> -- DBA_SYS_PRIVS
SQL> -- ALL_USER_SYS_PRIVS
SQL> -- ROLE_SYS_PRIVS
SQL> -- USER_SYS_PRIVS
SQL> select count(*) from dba_sys_privs where privilege='UNKOWN'; -- expect 0 row

COUNT(*)            
--------------------
0                   

1 rows fetched.

SQL> grant UNDER ANY VIEW, UNLIMITED TABLESPACE, UPDATE ANY TABLE to user_priv_revoke; -- expect succeed

Succeed.

SQL> drop user user_priv_revoke cascade;

Succeed.

SQL> 
SQL> -- test : user granted DBA role can alter user's password
SQL> create user alter_passwd_user_1 identified by Cantian_234;

Succeed.

SQL> create user alter_passwd_user_2 identified by Cantian_234;

Succeed.

SQL> 
SQL> grant create session to alter_passwd_user_1;

Succeed.

SQL> grant create session to alter_passwd_user_2;

Succeed.

SQL> conn alter_passwd_user_1/Cantian_234@127.0.0.1:1611

connected.

SQL> alter user alter_passwd_user_2 identified by Cantian_123 replace Cantian_234; -- failed, insufficient privilege

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> grant dba to alter_passwd_user_1;

Succeed.

SQL> 
SQL> conn alter_passwd_user_1/Cantian_234@127.0.0.1:1611

connected.

SQL> alter user alter_passwd_user_2 identified by Cantian_123 replace Cantian_234; -- succeed

Succeed.

SQL> 
SQL> -- succeed
SQL> conn alter_passwd_user_2/Cantian_123@127.0.0.1:1611

connected.

SQL> 
SQL> conn / as sysdba

connected.

SQL> revoke dba from alter_passwd_user_1;

Succeed.

SQL> conn alter_passwd_user_1/Cantian_234@127.0.0.1:1611

connected.

SQL> alter user alter_passwd_user_2 identified by Cantian_123 replace Cantian_234; -- failed, insufficient privilege

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> drop user alter_passwd_user_2;

Succeed.

SQL> drop user alter_passwd_user_1;

Succeed.

SQL> 
SQL> --DTS2018110601533
SQL> conn / as sysdba

connected.

SQL> create user DTS2018110601533 identified by 'Changeme_123';

Succeed.

SQL> grant create session to DTS2018110601533;

Succeed.

SQL> grant create any table to DTS2018110601533;

Succeed.

SQL> conn DTS2018110601533/Changeme_123@127.0.0.1:1611

connected.

SQL> create table test2018110601533(result VARCHAR(2048));

Succeed.

SQL> insert into test2018110601533 values('zhangsan');

1 rows affected.

SQL> truncate table test2018110601533;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user DTS2018110601533 cascade;

Succeed.

SQL> 
SQL> --DTS2018110106116
SQL> create user DTS2018110106116 identified by 'Changeme_123';

Succeed.

SQL> grant create session, on commit refresh, create table to DTS2018110106116;

Succeed.

SQL> select * from dba_sys_privs where grantee = 'DTS2018110106116' order by privilege;

GRANTEE                                                          PRIVILEGE                    ADMIN_OPTION
---------------------------------------------------------------- ---------------------------- ------------
DTS2018110106116                                                 CREATE SESSION               NO          
DTS2018110106116                                                 CREATE TABLE                 NO          
DTS2018110106116                                                 ON COMMIT REFRESH            NO          

3 rows fetched.

SQL> revoke create session, on commit refresh, create table from DTS2018110106116;

Succeed.

SQL> select * from dba_sys_privs where grantee = 'DTS2018110106116' order by privilege;

GRANTEE                                                          PRIVILEGE                    ADMIN_OPTION
---------------------------------------------------------------- ---------------------------- ------------

0 rows fetched.

SQL> grant abc on commit refresh to DTS2018110106116; -- failed

CT-00601, [1:7]Sql syntax error: invalid privilege or role name
SQL> grant on commit refrexxx to DTS2018110106116; -- failed

CT-00601, [1:7]Sql syntax error: missing or invalid privilege
SQL> grant on commit refresh abc to DTS2018110106116; -- failed

CT-00601, [1:7]Sql syntax error: invalid privilege or role name
SQL> grant on commit refresh to DTS2018110106116; -- succeed

Succeed.

SQL> revoke on commit refresh from DTS2018110106116; -- succeed

Succeed.

SQL> grant select on sys.SYS_TABLES to DTS2018110106116; -- succeed

Succeed.

SQL> revoke select on sys.SYS_TABLES from DTS2018110106116; -- succeed

Succeed.

SQL> drop user DTS2018110106116;

Succeed.

SQL> 
SQL> --DTS2018111203122
SQL> create user DTS2018111203122 identified by Changeme_123;

Succeed.

SQL> grant create session to DTS2018111203122;

Succeed.

SQL> grant select, update, insert, alter, delete on sys.SYS_PROFILE to DTS2018111203122 with grant option;

Succeed.

SQL> conn DTS2018111203122/Changeme_123@127.0.0.1:1611

connected.

SQL> revoke select, update, insert, alter, delete on sys.SYS_PROFILE from sys; -- failed

CT-01010, [1:73]Object permissions cannot be revoked from object holders
SQL> grant select, update, insert, alter, delete on sys.SYS_PROFILE to sys; -- succeed

Succeed.

SQL> revoke select, update, insert, alter, delete on sys.SYS_PROFILE from sys; -- failed

CT-01010, [1:73]Object permissions cannot be revoked from object holders
SQL> conn / as sysdba

connected.

SQL> drop user DTS2018111203122;

Succeed.

SQL> 
SQL> -- test: create view. DTS2018120606854
SQL> create user test_cr_view_001 identified by Root1234;

Succeed.

SQL> create user test_cr_view_002 identified by Root1234;

Succeed.

SQL> grant create view, create session to test_cr_view_001, test_cr_view_002;

Succeed.

SQL> grant select any table to test_cr_view_002;

Succeed.

SQL> 
SQL> create table test_cr_view_002.tab_001(f1 int);

Succeed.

SQL> grant select on sys.SYS_TABLES to test_cr_view_002;

Succeed.

SQL> create view test_cr_view_002.view_001 as select * from sys.SYS_TABLES;

Succeed.

SQL> grant SELECT on test_cr_view_002.view_001 to test_cr_view_001;

Succeed.

SQL> revoke select any table from test_cr_view_002;

Succeed.

SQL> revoke select on sys.SYS_TABLES from test_cr_view_002;

Succeed.

SQL> conn test_cr_view_001/Root1234@127.0.0.1:1611

connected.

SQL> -- should has the privilege to create a view based on SYS's public objects
SQL> create or replace view sysobjects as
  2 select object_name as name, object_name as id, CREATED as crdate, owner,
  3 case object_type when 'TABLE' then 'U'
  4                  when 'VIEW' then 'V'
  5                  when 'TRIGGER' then 'TR'
  6                  when 'PROCEDURE' then 'P'
  7                  else 'D' end as type
  8 from all_objects where instr(',SEQUENCE,PROCEDURE,TRIGGER,TABLE,VIEW,FUNCTION,',','||object_type||',')>0
  9 /

Succeed.

SQL> 
SQL> -- no privilege, because test_cr_view_001 has no SELECT privilege of test_cr_view_002.tab_001
SQL> create view test_no_pri_001 as select * from test_cr_view_002.tab_001;

CT-01001, Permissions were insufficient
SQL> 
SQL> -- no privilege, because test_cr_view_002 has no SELECT privilege of SYS.SYS_TABLES
SQL> create view test_no_pri_002 as select * from test_cr_view_002.view_001;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> drop user test_cr_view_001 cascade;

Succeed.

SQL> drop user test_cr_view_002 cascade;

Succeed.

SQL> 
SQL> -- DTS2018120406187
SQL> drop role DBA;

CT-00815, role DBA is system role, can not drop
SQL> 
SQL> -- 	DTS2018120309726
SQL> drop user if exists user1;

Succeed.

SQL> drop user if exists user2;

Succeed.

SQL> create user user1 identified by Changeme_123;

Succeed.

SQL> create user user2 identified by Changeme_123;

Succeed.

SQL> create table user1.tab_001(f1 int);

Succeed.

SQL> 
SQL> grant select on user1.tab_001 to user2;

Succeed.

SQL> grant create session to user1.user2;

CT-00601, [1:30]Sql syntax error: , expected, but . found
SQL> conn user1/Changeme_123@127.0.0.1:1611

CT-01006, The user lacks create session privilege

SQL> conn user2/Changeme_123@127.0.0.1:1611

CT-01006, The user lacks create session privilege

SQL> 
SQL> conn / as sysdba

connected.

SQL> grant create session to user1, user2;

Succeed.

SQL> revoke create session from user1.user2;

CT-00601, [1:33]Sql syntax error: , expected, but . found
SQL> revoke create session from user1, user2;

Succeed.

SQL> revoke select on user1.tab_001 from user2;

Succeed.

SQL> drop user user1 cascade;

Succeed.

SQL> drop user user2 cascade;

Succeed.

SQL> 
SQL> -- DTS2018120309012
SQL> create user " ";

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create user " " identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create user "123&" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create user "123|" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create user "123;" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create user "123`" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create user "123$" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create user "123&" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create user "123>" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create user "123<" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create user "123\"" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: text is not completed
SQL> create user "123'" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create user "123!" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> 
SQL> create role " ";

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create role " " identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create role "123&" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create role "123|" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create role "123;" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create role "123`" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create role "123$" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create role "123&" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create role "123>" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create role "123<" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create role "123\"" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: text is not completed
SQL> create role "123'" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> create role "123!" identified by Cantian_123;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> create user cjb01 identified by cao102_cao;

Succeed.

SQL> create user cjb02 identified by cao102_cao;

Succeed.

SQL> grant connect to cjb01;

Succeed.

SQL> grant connect to cjb02;

Succeed.

SQL> grant create any table to cjb01;

Succeed.

SQL> grant create any table to cjb02;

Succeed.

SQL> conn cjb01/cao102_cao@127.0.0.1:1611

connected.

SQL> create table cjb02.test (id int);

Succeed.

SQL> create table sys.test01 (id int);

CT-01001, Permissions were insufficient
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> create table cjb02.test1 (id int); 

Succeed.

SQL> create user cjb001 identified by hello_123;

Succeed.

SQL> grant connect to cjb001;

Succeed.

SQL> grant create table to cjb001;

Succeed.

SQL> grant create any view to cjb001;

Succeed.

SQL> grant drop any table to cjb001;

Succeed.

SQL> conn cjb001/hello_123@127.0.0.1:1611

connected.

SQL> create table bigbao(id int);

Succeed.

SQL> insert into bigbao values (1);

1 rows affected.

SQL> commit;

Succeed.

SQL> create or replace view sys.DBA_TABLES as select * from bigbao;

CT-01001, Permissions were insufficient
SQL> drop view SYS.USER_TAB_PARTITIONS ;

CT-01001, Permissions were insufficient
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> drop user cjb001 cascade;

Succeed.

SQL> drop user cjb01 cascade;

Succeed.

SQL> drop user cjb02 cascade;

Succeed.

SQL> 
SQL> -- DTS2018122010672
SQL> create user user11220_1 identified by Cantian_234;

Succeed.

SQL> grant create session,create table to user11220_1;

Succeed.

SQL> create user user11220_2 identified by Cantian_234;

Succeed.

SQL> create user user11220_3 identified by Cantian_234;

Succeed.

SQL> grant create session to user11220_2, user11220_3;

Succeed.

SQL> 
SQL> conn user11220_1/Cantian_234@127.0.0.1:1611

connected.

SQL> create table user11220_1_1(ID int);

Succeed.

SQL> grant select on user11220_1_1 to user11220_2, user11220_3;

Succeed.

SQL> 
SQL> conn user11220_2/Cantian_234@127.0.0.1:1611

connected.

SQL> select ID from user11220_1.user11220_1_1;

ID          
------------

0 rows fetched.

SQL> 
SQL> conn user11220_1/Cantian_234@127.0.0.1:1611

connected.

SQL> alter table user11220_1_1 rename to user11220_1_abcd;

Succeed.

SQL> 
SQL> -- has privilege
SQL> conn user11220_2/Cantian_234@127.0.0.1:1611

connected.

SQL> select ID from user11220_1.user11220_1_abcd;

ID          
------------

0 rows fetched.

SQL> 
SQL> -- has privilege
SQL> conn user11220_3/Cantian_234@127.0.0.1:1611

connected.

SQL> select ID from user11220_1.user11220_1_abcd;

ID          
------------

0 rows fetched.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> drop user user11220_1 cascade;

Succeed.

SQL> drop user user11220_2 cascade;

Succeed.

SQL> drop user user11220_3 cascade;

Succeed.

SQL> 
SQL> -- DTS2019010504482	
SQL> drop user if exists FVT_Security_Penetration_Testing_150_1 cascade;

Succeed.

SQL> create user FVT_Security_Penetration_Testing_150_1 identified by Cantian_234;

Succeed.

SQL> 
SQL> drop user if exists FVT_Security_Penetration_Testing_150_2 cascade;

Succeed.

SQL> create user FVT_Security_Penetration_Testing_150_2 identified by Cantian_234;

Succeed.

SQL> 
SQL> grant all to FVT_Security_Penetration_Testing_150_1;

Succeed.

SQL> grant connect to FVT_Security_Penetration_Testing_150_2;

Succeed.

SQL> grant CREATE TABLE to FVT_Security_Penetration_Testing_150_2;

Succeed.

SQL> grant CREATE VIEW to FVT_Security_Penetration_Testing_150_2;

Succeed.

SQL> 
SQL> conn FVT_Security_Penetration_Testing_150_1/Cantian_234@127.0.0.1:1611

connected.

SQL> DROP TABLE IF EXISTS FVT_Security_Penetration_Testing_150_table1;

Succeed.

SQL> CREATE TABLE FVT_Security_Penetration_Testing_150_table1(staff_id INT PRIMARY KEY, privilege_name VARCHAR(64) NOT NULL, privilege_description VARCHAR(64), privilege_approver VARCHAR(10));

Succeed.

SQL> -- expect succeed
SQL> CREATE OR REPLACE VIEW FVT_Security_Penetration_Testing_150_view1 AS SELECT staff_id, privilege_name from FVT_Security_Penetration_Testing_150_table1;

Succeed.

SQL> 
SQL> conn FVT_Security_Penetration_Testing_150_2/Cantian_234@127.0.0.1:1611

connected.

SQL> -- expect failed
SQL> CREATE TABLE FVT_Security_Penetration_Testing_150_table2 as select * from FVT_Security_Penetration_Testing_150_1.FVT_Security_Penetration_Testing_150_view1;

CT-01001, Permissions were insufficient
SQL> DROP TABLE IF EXISTS FVT_Security_Penetration_Testing_150_table2;

Succeed.

SQL> CREATE TABLE FVT_Security_Penetration_Testing_150_table2 as select * from FVT_Security_Penetration_Testing_150_1.FVT_Security_Penetration_Testing_150_table1;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> drop user FVT_Security_Penetration_Testing_150_1 cascade;

Succeed.

SQL> drop user FVT_Security_Penetration_Testing_150_2 cascade;

Succeed.

SQL> 
SQL> --DTS2019010802802,DTS2019011504629
SQL> select * from ROLE_SYS_PRIVS order by ROLE, PRIVILEGE;

ROLE                                                             PRIVILEGE                    ADMIN_OPTION
---------------------------------------------------------------- ---------------------------- ------------
CONNECT                                                          CREATE SESSION               NO          
DBA                                                              ALTER ANY INDEX              YES         
DBA                                                              ALTER ANY MATERIALIZED VIEW  YES         
DBA                                                              ALTER ANY PROCEDURE          YES         
DBA                                                              ALTER ANY ROLE               YES         
DBA                                                              ALTER ANY SEQUENCE           YES         
DBA                                                              ALTER ANY TABLE              YES         
DBA                                                              ALTER ANY TRIGGER            YES         
DBA                                                              ALTER DATABASE               YES         
DBA                                                              ALTER DATABASE LINK          YES         
DBA                                                              ALTER NODE                   YES         
DBA                                                              ALTER PROFILE                YES         
DBA                                                              ALTER SESSION                YES         
DBA                                                              ALTER SYSTEM                 YES         
DBA                                                              ALTER TABLESPACE             YES         
DBA                                                              ALTER TENANT                 YES         
DBA                                                              ALTER USER                   YES         
DBA                                                              ANALYZE ANY                  YES         
DBA                                                              COMMENT ANY TABLE            YES
DBA                                                              CREATE ANY DIRECTORY         YES 
DBA                                                              CREATE ANY DISTRIBUTE RULE   YES        
DBA                                                              CREATE ANY INDEX             YES         
DBA                                                              CREATE ANY LIBRARY           YES         
DBA                                                              CREATE ANY MATERIALIZED VIEW YES         
DBA                                                              CREATE ANY PROCEDURE         YES         
DBA                                                              CREATE ANY SEQUENCE          YES         
DBA                                                              CREATE ANY SQL MAP           YES
DBA                                                              CREATE ANY SYNONYM           YES         
DBA                                                              CREATE ANY TABLE             YES         
DBA                                                              CREATE ANY TRIGGER           YES         
DBA                                                              CREATE ANY TYPE              YES         
DBA                                                              CREATE ANY VIEW              YES
DBA                                                              CREATE CTRLFILE              YES         
DBA                                                              CREATE DATABASE              YES         
DBA                                                              CREATE DATABASE LINK         YES         
DBA                                                              CREATE DISTRIBUTE RULE       YES         
DBA                                                              CREATE LIBRARY               YES         
DBA                                                              CREATE MATERIALIZED VIEW     YES         
DBA                                                              CREATE NODE                  YES         
DBA                                                              CREATE PROCEDURE             YES         
DBA                                                              CREATE PROFILE               YES         
DBA                                                              CREATE PUBLIC SYNONYM        YES         
DBA                                                              CREATE ROLE                  YES         
DBA                                                              CREATE SEQUENCE              YES         
DBA                                                              CREATE SESSION               YES         
DBA                                                              CREATE SYNONYM               YES         
DBA                                                              CREATE TABLE                 YES         
DBA                                                              CREATE TABLESPACE            YES         
DBA                                                              CREATE TENANT                YES         
DBA                                                              CREATE TRIGGER               YES         
DBA                                                              CREATE TYPE                  YES         
DBA                                                              CREATE USER                  YES         
DBA                                                              CREATE VIEW                  YES         
DBA                                                              DELETE ANY TABLE             YES
DBA                                                              DROP ANY DIRECTORY           YES
DBA                                                              DROP ANY DISTRIBUTE RULE     YES         
DBA                                                              DROP ANY INDEX               YES         
DBA                                                              DROP ANY LIBRARY             YES         
DBA                                                              DROP ANY MATERIALIZED VIEW   YES         
DBA                                                              DROP ANY PROCEDURE           YES         
DBA                                                              DROP ANY ROLE                YES         
DBA                                                              DROP ANY SEQUENCE            YES         
DBA                                                              DROP ANY SQL MAP             YES
DBA                                                              DROP ANY SYNONYM             YES         
DBA                                                              DROP ANY TABLE               YES         
DBA                                                              DROP ANY TRIGGER             YES         
DBA                                                              DROP ANY TYPE                YES         
DBA                                                              DROP ANY VIEW                YES         
DBA                                                              DROP DATABASE LINK           YES         
DBA                                                              DROP NODE                    YES         
DBA                                                              DROP PROFILE                 YES         
DBA                                                              DROP PUBLIC SYNONYM          YES         
DBA                                                              DROP TABLESPACE              YES         
DBA                                                              DROP TENANT                  YES         
DBA                                                              DROP USER                    YES         
DBA                                                              EXECUTE ANY LIBRARY          YES         
DBA                                                              EXECUTE ANY PROCEDURE        YES         
DBA                                                              EXECUTE ANY TYPE             YES
DBA                                                              EXEMPT ACCESS POLICY         YES         
DBA                                                              EXEMPT REDACTION POLICY            YES        
DBA                                                              FLASHBACK ANY TABLE          YES         
DBA                                                              FLASHBACK ARCHIVE ADMINISTER YES         
DBA                                                              FORCE ANY TRANSACTION        YES
DBA                                                              GLOBAL QUERY REWRITE         YES         
DBA                                                              GRANT ANY OBJECT PRIVILEGE   YES         
DBA                                                              GRANT ANY PRIVILEGE          YES         
DBA                                                              GRANT ANY ROLE               YES         
DBA                                                              INSERT ANY TABLE             YES         
DBA                                                              LOCK ANY TABLE               YES         
DBA                                                              MANAGE TABLESPACE            YES         
DBA                                                              ON COMMIT REFRESH            YES         
DBA                                                              PURGE DBA_RECYCLEBIN         YES         
DBA                                                              READ ANY TABLE               YES         
DBA                                                              SELECT ANY DICTIONARY        YES
DBA                                                              SELECT ANY SEQUENCE          YES         
DBA                                                              SELECT ANY TABLE             YES         
DBA                                                              SYSBACKUP                    YES         
DBA                                                              SYSDBA                       YES         
DBA                                                              SYSOPER                      YES               
DBA                                                              UNDER ANY VIEW               YES         
DBA                                                              UNLIMITED TABLESPACE         YES         
DBA                                                              UPDATE ANY TABLE             YES         
DBA                                                              USE ANY TABLESPACE           YES         
RESOURCE                                                         CREATE PROCEDURE             NO          
RESOURCE                                                         CREATE SEQUENCE              NO          
RESOURCE                                                         CREATE TABLE                 NO          
RESOURCE                                                         CREATE TRIGGER               NO          

107 rows fetched.

SQL> create user DTS2019010802802 identified by Root1234;

Succeed.

SQL> grant connect to DTS2019010802802;

Succeed.

SQL> grant select on DBA_SYS_PRIVS to DTS2019010802802;

Succeed.

SQL> create role role_test_0001;

Succeed.

SQL> grant create table to role_test_0001;

Succeed.

SQL> 
SQL> conn DTS2019010802802/Root1234@127.0.0.1:1611

connected.

SQL> select * from ROLE_SYS_PRIVS order by ROLE, PRIVILEGE; -- connect only

ROLE                                                             PRIVILEGE                    ADMIN_OPTION
---------------------------------------------------------------- ---------------------------- ------------
CONNECT                                                          CREATE SESSION               NO          

1 rows fetched.

SQL> select * from DBA_SYS_PRIVS where grantee = 'ROLE_TEST_0001'; -- 1 row, include ROLE_TEST_0001

GRANTEE                                                          PRIVILEGE                    ADMIN_OPTION
---------------------------------------------------------------- ---------------------------- ------------
ROLE_TEST_0001                                                   CREATE TABLE                 NO          

1 rows fetched.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant dba to DTS2019010802802;

Succeed.

SQL> conn DTS2019010802802/Root1234@127.0.0.1:1611

connected.

SQL> select * from ROLE_SYS_PRIVS order by ROLE, PRIVILEGE; -- all roles;

ROLE                                                             PRIVILEGE                    ADMIN_OPTION
---------------------------------------------------------------- ---------------------------- ------------
CONNECT                                                          CREATE SESSION               NO          
DBA                                                              ALTER ANY INDEX              YES         
DBA                                                              ALTER ANY MATERIALIZED VIEW  YES         
DBA                                                              ALTER ANY PROCEDURE          YES         
DBA                                                              ALTER ANY ROLE               YES         
DBA                                                              ALTER ANY SEQUENCE           YES         
DBA                                                              ALTER ANY TABLE              YES         
DBA                                                              ALTER ANY TRIGGER            YES         
DBA                                                              ALTER DATABASE               YES         
DBA                                                              ALTER DATABASE LINK          YES         
DBA                                                              ALTER NODE                   YES         
DBA                                                              ALTER PROFILE                YES         
DBA                                                              ALTER SESSION                YES         
DBA                                                              ALTER SYSTEM                 YES         
DBA                                                              ALTER TABLESPACE             YES         
DBA                                                              ALTER TENANT                 YES         
DBA                                                              ALTER USER                   YES         
DBA                                                              ANALYZE ANY                  YES         
DBA                                                              COMMENT ANY TABLE            YES
DBA                                                              CREATE ANY DIRECTORY         YES
DBA                                                              CREATE ANY DISTRIBUTE RULE   YES         
DBA                                                              CREATE ANY INDEX             YES         
DBA                                                              CREATE ANY LIBRARY           YES         
DBA                                                              CREATE ANY MATERIALIZED VIEW YES         
DBA                                                              CREATE ANY PROCEDURE         YES         
DBA                                                              CREATE ANY SEQUENCE          YES         
DBA                                                              CREATE ANY SQL MAP           YES
DBA                                                              CREATE ANY SYNONYM           YES         
DBA                                                              CREATE ANY TABLE             YES         
DBA                                                              CREATE ANY TRIGGER           YES         
DBA                                                              CREATE ANY TYPE              YES         
DBA                                                              CREATE ANY VIEW              YES
DBA                                                              CREATE CTRLFILE              YES         
DBA                                                              CREATE DATABASE              YES         
DBA                                                              CREATE DATABASE LINK         YES         
DBA                                                              CREATE DISTRIBUTE RULE       YES         
DBA                                                              CREATE LIBRARY               YES         
DBA                                                              CREATE MATERIALIZED VIEW     YES         
DBA                                                              CREATE NODE                  YES         
DBA                                                              CREATE PROCEDURE             YES         
DBA                                                              CREATE PROFILE               YES         
DBA                                                              CREATE PUBLIC SYNONYM        YES         
DBA                                                              CREATE ROLE                  YES         
DBA                                                              CREATE SEQUENCE              YES         
DBA                                                              CREATE SESSION               YES         
DBA                                                              CREATE SYNONYM               YES         
DBA                                                              CREATE TABLE                 YES         
DBA                                                              CREATE TABLESPACE            YES         
DBA                                                              CREATE TENANT                YES         
DBA                                                              CREATE TRIGGER               YES         
DBA                                                              CREATE TYPE                  YES         
DBA                                                              CREATE USER                  YES         
DBA                                                              CREATE VIEW                  YES         
DBA                                                              DELETE ANY TABLE             YES
DBA                                                              DROP ANY DIRECTORY           YES
DBA                                                              DROP ANY DISTRIBUTE RULE     YES         
DBA                                                              DROP ANY INDEX               YES         
DBA                                                              DROP ANY LIBRARY             YES         
DBA                                                              DROP ANY MATERIALIZED VIEW   YES         
DBA                                                              DROP ANY PROCEDURE           YES         
DBA                                                              DROP ANY ROLE                YES         
DBA                                                              DROP ANY SEQUENCE            YES         
DBA                                                              DROP ANY SQL MAP             YES
DBA                                                              DROP ANY SYNONYM             YES         
DBA                                                              DROP ANY TABLE               YES         
DBA                                                              DROP ANY TRIGGER             YES         
DBA                                                              DROP ANY TYPE                YES         
DBA                                                              DROP ANY VIEW                YES         
DBA                                                              DROP DATABASE LINK           YES         
DBA                                                              DROP NODE                    YES         
DBA                                                              DROP PROFILE                 YES         
DBA                                                              DROP PUBLIC SYNONYM          YES         
DBA                                                              DROP TABLESPACE              YES         
DBA                                                              DROP TENANT                  YES         
DBA                                                              DROP USER                    YES         
DBA                                                              EXECUTE ANY LIBRARY          YES         
DBA                                                              EXECUTE ANY PROCEDURE        YES         
DBA                                                              EXECUTE ANY TYPE             YES
DBA                                                              EXEMPT ACCESS POLICY         YES         
DBA                                                              EXEMPT REDACTION POLICY            YES         
DBA                                                              FLASHBACK ANY TABLE          YES         
DBA                                                              FLASHBACK ARCHIVE ADMINISTER YES         
DBA                                                              FORCE ANY TRANSACTION        YES
DBA                                                              GLOBAL QUERY REWRITE         YES         
DBA                                                              GRANT ANY OBJECT PRIVILEGE   YES         
DBA                                                              GRANT ANY PRIVILEGE          YES         
DBA                                                              GRANT ANY ROLE               YES         
DBA                                                              INSERT ANY TABLE             YES         
DBA                                                              LOCK ANY TABLE               YES         
DBA                                                              MANAGE TABLESPACE            YES         
DBA                                                              ON COMMIT REFRESH            YES         
DBA                                                              PURGE DBA_RECYCLEBIN         YES         
DBA                                                              READ ANY TABLE               YES         
DBA                                                              SELECT ANY DICTIONARY        YES
DBA                                                              SELECT ANY SEQUENCE          YES         
DBA                                                              SELECT ANY TABLE             YES         
DBA                                                              SYSBACKUP                    YES         
DBA                                                              SYSDBA                       YES         
DBA                                                              SYSOPER                      YES             
DBA                                                              UNDER ANY VIEW               YES         
DBA                                                              UNLIMITED TABLESPACE         YES         
DBA                                                              UPDATE ANY TABLE             YES         
DBA                                                              USE ANY TABLESPACE           YES         
RESOURCE                                                         CREATE PROCEDURE             NO          
RESOURCE                                                         CREATE SEQUENCE              NO          
RESOURCE                                                         CREATE TABLE                 NO          
RESOURCE                                                         CREATE TRIGGER               NO          
ROLE_TEST_0001                                                   CREATE TABLE                 NO          

108 rows fetched.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> drop user DTS2019010802802;

Succeed.

SQL> drop role role_test_0001;

Succeed.

SQL> 
SQL> -- ST1224-530 : system package privilege check
SQL> create user package_check identified by Root1234;

Succeed.

SQL> grant create session to package_check;

Succeed.

SQL> grant resource to package_check;

Succeed.

SQL> 
SQL> conn package_check/Root1234@127.0.0.1:1611

connected.

SQL> 
SQL> -- create job procedure
SQL> create or replace procedure job_package_check_t
  2 as
  3   cnt int;
  4 begin
  5  select count(1) into cnt from dual;
  6  commit;
  7 end job_package_check_t;
  8 /

Succeed.

SQL> 
SQL> -- submit the job, expect failed, no privileges
SQL> declare
  2  jobno number;
  3 begin
  4  DBE_TASK.SUBMIT(jobno,'begin job_package_check_t();end;', sysdate, 'sysdate+0.5/24/60');
  5  commit;
  6 end;
  7 /

CT-00944, PL/SQL(PACKAGE_CHECK.ANONYMOUS BLOCK) terminated with compiling errors
[4:2] PLC-01001 Permissions were insufficient

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> grant execute on DBE_TASK to package_check;

Succeed.

SQL> 
SQL> conn package_check/Root1234@127.0.0.1:1611

connected.

SQL> 
SQL> -- submit the job, expect succeed
SQL> declare
  2  jobno number;
  3 begin
  4  DBE_TASK.SUBMIT(jobno,'begin job_package_check_t();end;', sysdate + 1/24, 'sysdate+0.5/24/60');
  5  commit;
  6 end;
  7 /

PL/SQL procedure successfully completed.

SQL> 
SQL> -- common user has privilege to execute DBE_OUTPUT package function.
SQL> exec dbe_output.print_line('abc');

PL/SQL procedure successfully completed.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> revoke execute on DBE_TASK from package_check;

Succeed.

SQL> grant dba to package_check;

Succeed.

SQL> 
SQL> conn package_check/Root1234@127.0.0.1:1611

connected.

SQL> 
SQL> declare
  2  jobno int;
  3 begin
  4  select job into jobno from all_jobs where what='begin job_package_check_t();end;';
  5 --expect success 
  6  DBE_TASK.CANCEL(jobno);
  7  commit;
  8 end;
  9 /

PL/SQL procedure successfully completed.

SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> drop user package_check cascade;

Succeed.

SQL> 
SQL> -- DTS2019040109911
SQL> create user FVT_Security_User_privilege_146_1 identified by Cantian_234;

Succeed.

SQL> grant create session,CREATE ANY TABLE,create any PROCEDURE to FVT_Security_User_privilege_146_1;

Succeed.

SQL> 
SQL> create user FVT_Security_User_privilege_146_2 identified by Cantian_234;

Succeed.

SQL> grant create session,EXECUTE ANY PROCEDURE to FVT_Security_User_privilege_146_2;

Succeed.

SQL> 
SQL> conn FVT_Security_User_privilege_146_1/Cantian_234@127.0.0.1:1611

connected.

SQL> create table FVT_Security_User_privilege_146_1(ID int,name varchar(50));

Succeed.

SQL> create table FVT_Security_User_privilege_146_2.FVT_Security_User_privilege_146_2(ID int,name varchar(50));

Succeed.

SQL> create or replace procedure procedure_FVT_Security_User_privilege_146_1 is
  2     v_sql varchar(1023);
  3 begin
  4     v_sql := 'insert into FVT_Security_User_privilege_146_1 values(100,''xiaoming'')';
  5     execute immediate v_sql;
  6     commit;
  7 end procedure_FVT_Security_User_privilege_146_1;
  8 /

Succeed.

SQL> 
SQL> create or replace procedure procedure_FVT_Security_User_privilege_146_1_1  is
  2 begin
  3     insert into FVT_Security_User_privilege_146_1 values(100,'xiaoxiao');
  4     commit;
  5 end procedure_FVT_Security_User_privilege_146_1_1;
  6 /

Succeed.

SQL> 
SQL> conn FVT_Security_User_privilege_146_2/Cantian_234@127.0.0.1:1611

connected.

SQL> exec FVT_Security_User_privilege_146_1.procedure_FVT_Security_User_privilege_146_1;

CT-00932, [1:2] PL/SQL(FVT_SECURITY_USER_PRIVILEGE_146_2.ANONYMOUS BLOCK) terminated with execute errors
[5:5] PL/SQL(FVT_SECURITY_USER_PRIVILEGE_146_1.PROCEDURE_FVT_SECURITY_USER_PRIVILEGE_146_1) terminated with execute errors
[5:5] CT-01001, Permissions were insufficient

SQL> exec FVT_Security_User_privilege_146_1.procedure_FVT_Security_User_privilege_146_1_1;

CT-01001, Permissions were insufficient
SQL> 
SQL> conn sys/Huawei@123@127.0.0.1:1611

connected.

SQL> drop user FVT_Security_User_privilege_146_1 cascade;

Succeed.

SQL> drop user FVT_Security_User_privilege_146_2 cascade;

Succeed.

SQL> 
SQL> -- DTS2019041012706
SQL> create user grant_max_user identified by Root1234;

Succeed.

SQL> create role grant_max_role;

Succeed.

SQL> 
SQL> declare
  2     tab_cnt int;
  3     v_sql varchar(1023);
  4 begin
  5     for tab_cnt in 1 .. 2049 loop
  6         v_sql := 'drop table if exists table_' || tab_cnt;
  7         execute immediate v_sql;
  8         v_sql := 'create table table_' || tab_cnt || '(f1 int)';
  9         execute immediate v_sql;
 10     end loop;
 11 end;
 12 /

PL/SQL procedure successfully completed.

SQL> 
SQL> declare
  2     grant_num int;
  3     v_sql varchar(1023);
  4 begin
  5     for grant_num in 1 .. 2049 loop
  6         v_sql := 'grant all on table_' || grant_num || ' to grant_max_user';
  7         execute immediate v_sql;
  8     end loop;
  9 end;
 10 /

PL/SQL procedure successfully completed.

SQL> 
SQL> declare
  2     grant_num int;
  3     v_sql varchar(1023);
  4 begin
  5     for grant_num in 1 .. 2049 loop
  6         v_sql := 'grant all on table_' || grant_num || ' to grant_max_role';
  7         execute immediate v_sql;
  8     end loop;
  9 end;
 10 /

PL/SQL procedure successfully completed.

SQL> 
SQL> declare
  2     tab_cnt int;
  3     v_sql varchar(1023);
  4 begin
  5     for tab_cnt in 1 .. 2049 loop
  6         v_sql := 'drop table table_' || tab_cnt;
  7         execute immediate v_sql;
  8     end loop;
  9 end;
 10 /

PL/SQL procedure successfully completed.

SQL> 
SQL> drop user grant_max_user cascade;

Succeed.

SQL> drop role grant_max_role;

Succeed.

SQL> 
SQL> --DTSxxx
SQL> conn / as sysdba

connected.

SQL> CREATE USER FVT_Security_User_privilege_235 IDENTIFIED BY Cantian_235;

Succeed.

SQL> GRANT create session TO FVT_Security_User_privilege_235;

Succeed.

SQL> create global temporary table sys_table_FVT_Security_User_privilege_235(id int, name varchar(2048));

Succeed.

SQL> grant all on sys_table_FVT_Security_User_privilege_235 to FVT_Security_User_privilege_235;

Succeed.

SQL> 
SQL> conn FVT_Security_User_privilege_235/Cantian_235@127.0.0.1:1611

connected.

SQL> create index index_FVT_Security_User_privilege_235 ON sys.sys_table_FVT_Security_User_privilege_235(name ASC) ONLINE;

CT-00130, Operation create index online is not supported on temporary table
SQL> alter table sys.sys_table_FVT_Security_User_privilege_235 add constraint pk_FVT_Security_User_privilege_235 primary key(name);

Succeed.

SQL> 
SQL> conn / as sysdba

connected.

SQL> grant DBA TO FVT_Security_User_privilege_235;

Succeed.

SQL> conn FVT_Security_User_privilege_235/Cantian_235@127.0.0.1:1611

connected.

SQL> create index index_FVT_Security_User_privilege_235 ON sys.sys_table_FVT_Security_User_privilege_235(name ASC) ONLINE;

CT-00130, Operation create index online is not supported on temporary table
SQL> alter table sys.sys_table_FVT_Security_User_privilege_235 add constraint pk_FVT_Security_User_privilege_235 primary key(name);

CT-00753, The object constraint PK_FVT_SECURITY_USER_PRIVILEGE_235 already exists.
SQL> 
SQL> --
SQL> conn / as sysdba

connected.

SQL> CREATE USER FVT_Security_User_privilege_236_1 IDENTIFIED BY Cantian_234;

Succeed.

SQL> GRANT create session TO FVT_Security_User_privilege_236_1;

Succeed.

SQL> create table table_sys_FVT_Security_User_privilege_236(id int, name varchar(2048));

Succeed.

SQL> grant all on table_sys_FVT_Security_User_privilege_236 to FVT_Security_User_privilege_236_1;

Succeed.

SQL> 
SQL> conn FVT_Security_User_privilege_236_1/Cantian_234@127.0.0.1:1611

connected.

SQL> create index index_FVT_Security_User_privilege_236_1 ON sys.table_sys_FVT_Security_User_privilege_236(name ASC) ONLINE;

Succeed.

SQL> alter table sys.table_sys_FVT_Security_User_privilege_236 MODIFY(name CONSTRAINT namefeikong NOT NULL);

Succeed.

SQL> 
SQL> conn / as sysdba

connected.

SQL> grant DBA to FVT_Security_User_privilege_236_1;

Succeed.

SQL> 
SQL> conn FVT_Security_User_privilege_236_1/Cantian_234@127.0.0.1:1611

connected.

SQL> create index index_FVT_Security_User_privilege_236_1 ON sys.table_sys_FVT_Security_User_privilege_236(name ASC) ONLINE;

CT-00726, The column has been indexed by INDEX_FVT_SECURITY_USER_PRIVILEGE_236_1.
SQL> create index index_FVT_Security_User_privilege_236_2 ON sys.table_sys_FVT_Security_User_privilege_236(id ASC) ONLINE;

Succeed.

SQL> alter table sys.table_sys_FVT_Security_User_privilege_236 MODIFY(name CONSTRAINT namefeikong NOT NULL);

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user FVT_Security_User_privilege_235 cascade;

Succeed.

SQL> drop user FVT_Security_User_privilege_236_1 cascade;

Succeed.

SQL> 
SQL> --DTS2019051407967
SQL> conn / as sysdba

connected.

SQL> create user u_replace identified by Cantian_234;

Succeed.

SQL> grant create session,create table to u_replace;

Succeed.

SQL> create user u_replace1 identified by Cantian_234;

Succeed.

SQL> grant create session,create table to u_replace1;

Succeed.

SQL> grant insert any table to u_replace1;

Succeed.

SQL> grant delete any table to u_replace1;

Succeed.

SQL> 
SQL> conn u_replace/Cantian_234@127.0.0.1:1611

connected.

SQL> create table tbl_rep_008(
  2 id int ,
  3 col_char1 varchar(30),
  4 col_char2 varchar(40),
  5 col_char3 varchar(40)
  6 );

Succeed.

SQL> alter table tbl_rep_008 add constraint pk_001 primary key(id ,col_char1);

Succeed.

SQL> 
SQL> conn u_replace1/Cantian_234@127.0.0.1:1611

connected.

SQL> replace into u_replace.tbl_rep_008 set id = 1,col_char1 ='a',col_char2='b',col_char3='ABCDEFG';

1 rows affected.

SQL> insert into u_replace.tbl_rep_008 values(1,2,3,4);

1 rows affected.

SQL> 
SQL> conn / as sysdba

connected.

SQL> drop user u_replace cascade;

Succeed.

SQL> drop user u_replace1 cascade;

Succeed.

SQL> 
SQL> conn / as sysdba

connected.

SQL> create user test_dv identified by test_1234;

Succeed.

SQL> grant create session to test_dv;

Succeed.

SQL> connect test_dv/test_1234@127.0.0.1:1611

connected.

SQL> select * from V$FREE_SPACE;

CT-01001, Permissions were insufficient
SQL> select * from V$HA_SYNC_INFO;

CT-01001, Permissions were insufficient
SQL> select * from V$HBA;

CT-01001, Permissions were insufficient
SQL> select * from V$INSTANCE;

CT-01001, Permissions were insufficient
SQL> select * from V$JOBS_RUNNING;

CT-01001, Permissions were insufficient
SQL> select * from DV_FREE_SPACE;

CT-01001, Permissions were insufficient
SQL> select * from DV_HA_SYNC_INFO;

CT-01001, Permissions were insufficient
SQL> select * from DV_HBA;

CT-01001, Permissions were insufficient
SQL> select * from DV_INSTANCE;

CT-01001, Permissions were insufficient
SQL> select * from DV_RUNNING_JOBS;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop user test_dv cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop table if exists test_t_001;

Succeed.

SQL> drop user if exists cao;

Succeed.

SQL> create user cao identified by cao102_cao;

Succeed.

SQL> grant connect to cao;

Succeed.

SQL> create table test_t_001(id int);

Succeed.

SQL> conn cao/cao102_cao@127.0.0.1:1611

connected.

SQL> select * from sys.test_t_001;

CT-01001, Permissions were insufficient
SQL> select * from sys.test_t_002;

CT-01001, [1:15]Permissions were insufficient
SQL> select * from test_t_001;

CT-00843, [1:15]The table or view CAO.TEST_T_001 does not exist.
SQL> conn / as sysdba

connected.

SQL> drop table if exists test_t_001;

Succeed.

SQL> drop user if exists cao cascade;

Succeed.

SQL>
SQL> -- DTS2019082010529
SQL> create user li_user1 identified by cantian_123;

Succeed.

SQL> grant create session to li_user1;

Succeed.

SQL> grant dba to li_user1;

Succeed.

SQL> conn li_user1/cantian_123@127.0.0.1:1611

connected.

SQL> alter system set ENABLE_SYS_REMOTE_LOGIN = true;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop user li_user1;

Succeed.

SQL>
SQL> -- DTS2019090612564
SQL> create user z_user1 identified by Cantian_234;

Succeed.

SQL> grant connect to z_user1;

Succeed.

SQL> grant dba to z_user1;

Succeed.

SQL> create table z_user1.references_t1 (id int, name varchar(20) unique);

Succeed.

SQL> create table references_t1(id int,name varchar(20) references  z_user1.references_t1(name));

CT-01001, Permissions were insufficient
SQL> conn z_user1/Cantian_234@127.0.0.1:1611

connected.

SQL> grant references on z_user1.references_t1 to sys;

Succeed.

SQL> conn / as sysdba

connected.

SQL> create table references_t1(id int,name varchar(20) references  z_user1.references_t1(name));

Succeed.

SQL> drop table references_t1;

Succeed.

SQL> conn z_user1/Cantian_234@127.0.0.1:1611

connected.

SQL> revoke references on z_user1.references_t1 from sys;

Succeed.

SQL> conn / as sysdba

connected.

SQL> create table references_t1(id int,name varchar(20) references  z_user1.references_t1(name));

CT-01001, Permissions were insufficient
SQL> drop user z_user1 cascade;

Succeed.

SQL>
SQL> -- DTS2019092113391
SQL> create user test_user1 identified by Cantian_234;

Succeed.

SQL> create user test_user2 identified by Cantian_234;

Succeed.

SQL> grant dba to test_user1;

Succeed.

SQL> grant connect to test_user2;

Succeed.

SQL> create table test_user1.t1(id int);

Succeed.

SQL> create procedure test_user1.t1
  2 IS
  3 BEGIN
  4 	dbe_output.print_line('Hello');
  5 END;
  6 /

Succeed.

SQL> grant execute on test_user1.t1 to test_user2;

CT-00601, [1:7]Sql syntax error: EXECUTE privilege not allowed for tables
SQL> grant execute on procedure test_user1.t1 to test_user2;

Succeed.

SQL> revoke execute on test_user1.t1 from test_user2;

CT-00601, [1:8]Sql syntax error: EXECUTE privilege not allowed for tables
SQL> revoke execute on procedure test_user1.t1 from test_user2;

Succeed.

SQL> drop user test_user1 cascade;

Succeed.

SQL> drop user test_user2 cascade;

Succeed.

SQL>
SQL> -- DTS2019102503576
SQL> create table test_read_any_table(id int);

Succeed.

SQL> create user user_test_read_any_table identified by Cantian_234;

Succeed.

SQL> grant connect,read any table to user_test_read_any_table;

Succeed.

SQL> conn user_test_read_any_table/Cantian_234@127.0.0.1:1611

connected.

SQL> select username,privilege from user_sys_privs;

USERNAME                                                         PRIVILEGE
---------------------------------------------------------------- ----------------------------
USER_TEST_READ_ANY_TABLE                                         READ ANY TABLE

1 rows fetched.

SQL> select owner,table_name from all_tables where table_name = 'TEST_READ_ANY_TABLE';

OWNER                                                            TABLE_NAME
---------------------------------------------------------------- ----------------------------------------------------------------
SYS                                                              TEST_READ_ANY_TABLE

1 rows fetched.

SQL> conn / as sysdba

connected.

SQL> drop user user_test_read_any_table cascade;

Succeed.

SQL> drop table test_read_any_table;

Succeed.

SQL>
SQL> -- DTS2019082201839
SQL> create user ch_u1 identified by cantian_123;
   
Succeed.                                                                                                          
   
SQL> grant create session to ch_u1;                                                                               
   
Succeed.                                                                                                          
    
SQL> grant alter system to ch_u1;                                                                                 
   
Succeed.                                                                                                          
 
SQL> conn ch_u1/cantian_123@127.0.0.1:1611
  
connected.                                                                                                        

SQL> alter system set _SYS_PASSWORD='mHmNxBvw7Uu7LtSvrUIy8NY9womwIuJG9vAlMl0+zNifU7x5TnIz5UOqmkozbTyW' scope=both;
   
CT-01001, Permissions were insufficient                                                                           
SQL> conn / as sysdba                                                                                             
  
connected.                                                                                                        
  
SQL> create user ch_u2 identified by cantian_123;
  
Succeed.  

SQL> grant dba to ch_u2;

Succeed.

SQL> conn ch_u2/cantian_123@127.0.0.1:1611

connected.

SQL> alter system set _SYS_PASSWORD='mHmNxBvw7Uu7LtSvrUIy8NY9womwIuJG9vAlMl0+zNifU7x5TnIz5UOqmkozbTyW' scope=both;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba

connected.

SQL> drop user ch_u1;

Succeed.

SQL> drop user ch_u2;

Succeed.

SQL> CONN / AS  SYSDBA

connected.

SQL> DROP USER IF EXISTS "   TABUSER";

CT-00601, [1:21]Sql syntax error: invalid variant/object name was found
SQL> DROP USER IF EXISTS `   TABUSER1`;

CT-00601, [1:21]Sql syntax error: invalid variant/object name was found
SQL> CREATE USER "   TABUSER" IDENTIFIED BY  GUASS_234;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> CREATE USER `   TABUSER1` IDENTIFIED BY  GUASS_234;

CT-00601, [1:13]Sql syntax error: invalid variant/object name was found
SQL> GRANT CONNECT TO "   TABUSER", `   TABUSER1`;

CT-00601, [1:18]Sql syntax error: user or role '   TABUSER' does not exist
SQL> SELECT * FROM ADM_ROLE_PRIVS WHERE GRANTEE = 'TABUSER';

GRANTEE                                                          GRANTED_ROLE                                                     ADMIN_OPTION
---------------------------------------------------------------- ---------------------------------------------------------------- ------------

0 rows fetched.

SQL> SELECT * FROM ADM_ROLE_PRIVS WHERE GRANTEE = 'TABUSER1';

GRANTEE                                                          GRANTED_ROLE                                                     ADMIN_OPTION
---------------------------------------------------------------- ---------------------------------------------------------------- ------------

0 rows fetched.

SQL> REVOKE CONNECT FROM "   TABUSER", `   TABUSER1`;

CT-00601, [1:21]Sql syntax error: user or role '   TABUSER' does not exist
SQL> SELECT * FROM ADM_ROLE_PRIVS WHERE GRANTEE = 'TABUSER';

GRANTEE                                                          GRANTED_ROLE                                                     ADMIN_OPTION
---------------------------------------------------------------- ---------------------------------------------------------------- ------------

0 rows fetched.

SQL> SELECT * FROM ADM_ROLE_PRIVS WHERE GRANTEE = 'TABUSER1';

GRANTEE                                                          GRANTED_ROLE                                                     ADMIN_OPTION
---------------------------------------------------------------- ---------------------------------------------------------------- ------------

0 rows fetched.

SQL> DROP USER IF EXISTS "   TABUSER";

CT-00601, [1:21]Sql syntax error: invalid variant/object name was found
SQL> DROP USER IF EXISTS `   TABUSER1`;

CT-00601, [1:21]Sql syntax error: invalid variant/object name was found
SQL> conn / as sysdba

connected.

SQL> begin
  2 FOR i IN 1..3000 LOOP
  3 EXECUTE IMMEDIATE 'drop table if exists t225' || i;
  4 EXECUTE IMMEDIATE 'create   table t225'||i|| '(id int)' ;
  5 end loop;
  6 end;
  7 /

PL/SQL procedure successfully completed.

SQL> drop user if exists PRIV_EXTEND_USER1 cascade;

Succeed.

SQL> create user PRIV_EXTEND_USER1 identified by Cantian_234;

Succeed.

SQL> CREATE OR REPLACE PROCEDURE obj_privs_extend_test1(param1 in int)
  2 IS
  3 begin
  4  FOR i IN 1..param1 LOOP
  5  EXECUTE IMMEDIATE 'grant  SELECT,INSERT,DELETE,UPDATE,INDEX,ALTER,REFERENCES on t225'||i|| ' to PRIV_EXTEND_USER1';
  6  END LOOP;
  7 end obj_privs_extend_test1;
  8 /

Succeed.

SQL> CREATE OR REPLACE PROCEDURE revoke_obj_privs_extend_test1(param1 in int)
  2 IS
  3 begin
  4  FOR i IN 1..param1 LOOP
  5  EXECUTE IMMEDIATE 'revoke  SELECT,INSERT,DELETE,UPDATE,INDEX,ALTER,REFERENCES on t225'||i|| ' from PRIV_EXTEND_USER1';
  6  END LOOP;
  7 end revoke_obj_privs_extend_test1;
  8 /

Succeed.

SQL> call obj_privs_extend_test1(3000);

PL/SQL procedure successfully completed.

SQL> select count(*) from SYS_OBJECT_PRIVS,SYS_USERS where SYS_USERS.ID = SYS_OBJECT_PRIVS.GRANTEE and SYS_USERS.NAME='PRIV_EXTEND_USER1';

COUNT(*)
--------------------
21000

1 rows fetched.

SQL> call revoke_obj_privs_extend_test1(2000);

PL/SQL procedure successfully completed.

SQL> select count(*) from SYS_OBJECT_PRIVS,SYS_USERS where SYS_USERS.ID = SYS_OBJECT_PRIVS.GRANTEE and SYS_USERS.NAME='PRIV_EXTEND_USER1';

COUNT(*)
--------------------
7000

1 rows fetched.

SQL> drop user PRIV_EXTEND_USER1 cascade;

Succeed.

SQL> select count(*) from SYS_OBJECT_PRIVS,SYS_USERS where SYS_USERS.ID = SYS_OBJECT_PRIVS.GRANTEE and SYS_USERS.NAME='PRIV_EXTEND_USER1';

COUNT(*)
--------------------
0

1 rows fetched.

SQL> create user PRIV_EXTEND_USER1 identified by Cantian_234;

Succeed.

SQL> select count(*) from SYS_OBJECT_PRIVS,SYS_USERS where SYS_USERS.ID = SYS_OBJECT_PRIVS.GRANTEE and SYS_USERS.NAME='PRIV_EXTEND_USER1';

COUNT(*)
--------------------
0

1 rows fetched.

SQL> drop user PRIV_EXTEND_USER1 cascade;

Succeed.

SQL> begin
  2 FOR i IN 1..3000 LOOP
  3 EXECUTE IMMEDIATE 'drop table t225'||i ;
  4 end loop;
  5 end;
  6 /

PL/SQL procedure successfully completed.

SQL> conn / as sysdba

connected.

SQL> drop table if exists ADM_DEPENDENCIES_024_Tab_02;

Succeed.

SQL> drop synonym if exists ADM_DEPENDENCIES_024_Syn_02;

Succeed.

SQL> create table  ADM_DEPENDENCIES_024_Tab_02(id  int,name varchar(100),ctime date);

Succeed.

SQL> create synonym ADM_DEPENDENCIES_024_Syn_02 for ADM_DEPENDENCIES_024_Tab_02;

Succeed.

SQL> drop table ADM_DEPENDENCIES_024_Tab_02;

Succeed.

SQL> drop user if exists MY_DEPENDENCIES_035_Usr_01 cascade;

Succeed.

SQL> create user MY_DEPENDENCIES_035_Usr_01 identified by Cantian_234;

Succeed.

SQL> grant create session,create view to MY_DEPENDENCIES_035_Usr_01;

Succeed.

SQL> connect  MY_DEPENDENCIES_035_Usr_01/Cantian_234@127.0.0.1:1611

connected.

SQL> create view MY_DEPENDENCIES_035_View_01 as select * from my_dependencies where name in (select a.OBJECT_NAME from  my_objects  a left outer join db_objects b on a.OBJECT_ID = b.OBJECT_ID);

Succeed.

SQL> select NAME, REFERENCED_NAME from MY_DEPENDENCIES_035_View_01 where name ='MY_DEPENDENCIES_035_VIEW_01' order by REFERENCED_NAME;

NAME                                                             REFERENCED_NAME                                        
---------------------------------------------------------------- ----------------------------------------------------------------
MY_DEPENDENCIES_035_VIEW_01                                      DB_OBJECTS                                             
MY_DEPENDENCIES_035_VIEW_01                                      MY_DEPENDENCIES                                        
MY_DEPENDENCIES_035_VIEW_01                                      MY_OBJECTS                                             

3 rows fetched.

SQL> conn / as sysdba

connected.

SQL> drop table if exists ADM_DEPENDENCIES_024_Tab_02;

Succeed.

SQL> drop synonym if exists ADM_DEPENDENCIES_024_Syn_02;

Succeed.

SQL> drop user if exists MY_DEPENDENCIES_035_Usr_01 cascade;

Succeed.

SQL> conn / as sysdba

connected.

SQL> drop user if exists  hello_user cascade;

Succeed.

SQL> drop user if exists  test_user cascade;

Succeed.

SQL> drop user if exists  test_user1 cascade;

Succeed.

SQL> create user hello_user identified by Cantian_234;

Succeed.

SQL> create user test_user identified by Cantian_234;

Succeed.

SQL> create user test_user1 identified by Cantian_234;

Succeed.

SQL> grant dba to hello_user;

Succeed.

SQL> grant connect to test_user;

Succeed.

SQL> grant connect to test_user1;

Succeed.

SQL> conn hello_user/Cantian_234@127.0.0.1:1611

connected.

SQL> create table object1 (id int);

Succeed.

SQL> CREATE OR REPLACE PROCEDURE object1()
  2 IS
  3     tmp varchar2(20) :='12345678';
  4 Begin
  5     dbe_output.print_line('OUT PUT RESULT:'||tmp);
  6 end object1;
  7 /

Succeed.

SQL> grant select on table object1 to test_user with grant option;

Succeed.

SQL> grant execute on PROCEDURE object1 to test_user with grant option;

Succeed.

SQL> conn test_user/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from hello_user.object1;

ID
------------

0 rows fetched.

SQL> call hello_user.object1;

PL/SQL procedure successfully completed.

SQL> grant select on table hello_user.object1 to test_user1 with grant option;

Succeed.

SQL> grant execute on PROCEDURE hello_user.object1 to test_user1 with grant option;

Succeed.

SQL> conn test_user1/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from hello_user.object1;

ID
------------

0 rows fetched.

SQL> call hello_user.object1;

PL/SQL procedure successfully completed.

SQL> conn hello_user/Cantian_234@127.0.0.1:1611

connected.

SQL> alter table object1 rename to new_object1;

Succeed.

SQL> conn test_user/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from hello_user.new_object1;

ID
------------

0 rows fetched.

SQL> call hello_user.object1;

PL/SQL procedure successfully completed.

SQL> conn test_user1/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from hello_user.new_object1;

ID
------------

0 rows fetched.

SQL> call hello_user.object1;

PL/SQL procedure successfully completed.

SQL> conn hello_user/Cantian_234@127.0.0.1:1611

connected.

SQL> revoke select on table new_object1 from test_user;

Succeed.

SQL> conn test_user1/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from hello_user.new_object1;

CT-01001, Permissions were insufficient
SQL> call hello_user.object1;

PL/SQL procedure successfully completed.

SQL> conn test_user/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from hello_user.new_object1;

CT-01001, Permissions were insufficient
SQL> call hello_user.object1;

PL/SQL procedure successfully completed.

SQL> conn hello_user/Cantian_234@127.0.0.1:1611

connected.

SQL> revoke execute on PROCEDURE object1 from test_user;

Succeed.

SQL> conn test_user/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from hello_user.new_object1;

CT-01001, Permissions were insufficient
SQL> call hello_user.object1;

CT-01001, Permissions were insufficient
SQL> conn test_user1/Cantian_234@127.0.0.1:1611

connected.

SQL> select * from hello_user.new_object1;

CT-01001, Permissions were insufficient
SQL> call hello_user.object1;

CT-01001, Permissions were insufficient
SQL> conn / as sysdba 

connected.

SQL> drop user if exists  hello_user cascade;

Succeed.

SQL> drop user if exists  test_user cascade;

Succeed.

SQL> drop user if exists  test_user1 cascade;

Succeed.

SQL> 
SQL> CONN / AS SYSDBA

connected.

SQL> DROP USER IF EXISTS GRANT_TEST1;

Succeed.

SQL> CREATE USER GRANT_TEST1 IDENTIFIED BY Cantian_123456;

Succeed.

SQL> GRANT CONNECT TO GRANT_TEST1;

Succeed.

SQL> DROP TABLE IF EXISTS GRANT_T1;

Succeed.

SQL> DROP TABLE IF EXISTS GRANT_T2;

Succeed.

SQL> CREATE TABLE GRANT_T1(C1 INT);

Succeed.

SQL> CREATE TABLE GRANT_T2(C1 INT);

Succeed.

SQL> INSERT INTO GRANT_T1 VALUES(1);

1 rows affected.

SQL> INSERT INTO GRANT_T2 VALUES(2);

1 rows affected.

SQL> COMMIT;

Succeed.

SQL> 
SQL> CONN GRANT_TEST1/Cantian_123456@127.0.0.1:1611

connected.

SQL> SELECT * FROM SYS.GRANT_T1;

CT-01001, Permissions were insufficient
SQL> 
SQL> CONN / AS SYSDBA

connected.

SQL> CREATE OR REPLACE PUBLIC SYNONYM GRANT_SYN1 FOR GRANT_T1;

Succeed.

SQL> CREATE OR REPLACE PUBLIC SYNONYM GRANT_SYN2 FOR GRANT_T2;

Succeed.

SQL> DROP USER IF EXISTS USER_NOT_EXIST;

Succeed.

SQL> GRANT SELECT ON USER_NOT_EXIST.GRANT_SYN1 TO GRANT_TEST1;

CT-00828, object USER_NOT_EXIST.GRANT_SYN1 does not exist
SQL> GRANT SELECT ON "PUBLIC".GRANT_SYN2 TO GRANT_TEST1;

Succeed.

SQL> CONN GRANT_TEST1/Cantian_123456@127.0.0.1:1611

connected.

SQL> SELECT * FROM SYS.GRANT_T1;

CT-01001, Permissions were insufficient
SQL> SELECT * FROM SYS.GRANT_T2;

C1          
------------
2           

1 rows fetched.

SQL> 
SQL> CONN / AS SYSDBA

connected.

SQL> GRANT SELECT ON GRANT_SYN1 TO GRANT_TEST1;

Succeed.

SQL> CONN GRANT_TEST1/Cantian_123456@127.0.0.1:1611

connected.

SQL> SELECT * FROM SYS.GRANT_T1;

C1          
------------
1           

1 rows fetched.

SQL> 
SQL> CONN / AS SYSDBA

connected.

SQL> DROP USER GRANT_TEST1 CASCADE;

Succeed.

SQL> DROP TABLE GRANT_T1;

Succeed.

SQL> DROP TABLE GRANT_T2;

Succeed.

SQL> DROP PUBLIC SYNONYM GRANT_SYN1;

Succeed.

SQL> DROP PUBLIC SYNONYM GRANT_SYN2;

Succeed.

SQL> 
SQL> --DTS20210507048OSDP1N00 START
SQL> --1.check priv before execute trigger
SQL> CONN / AS SYSDBA

connected.

SQL> DROP USER IF EXISTS DTS20210507048OSDP1N00_U1 CASCADE;

Succeed.

SQL> DROP USER IF EXISTS DTS20210507048OSDP1N00_U2 CASCADE;

Succeed.

SQL> CREATE USER DTS20210507048OSDP1N00_U1 IDENTIFIED BY Cantian_234;

Succeed.

SQL> CREATE USER DTS20210507048OSDP1N00_U2 IDENTIFIED BY Cantian_234;

Succeed.

SQL> GRANT CONNECT TO DTS20210507048OSDP1N00_U1;

Succeed.

SQL> CREATE TABLE DTS20210507048OSDP1N00_U1.T1(C1 INT);

Succeed.

SQL> CREATE OR REPLACE PROCEDURE DTS20210507048OSDP1N00_U2.PROC1(V1 INT) IS
  2 BEGIN
  3  NULL;
  4 END;
  5 /

Succeed.

SQL> GRANT EXECUTE ON DTS20210507048OSDP1N00_U2.PROC1 TO DTS20210507048OSDP1N00_U1;

Succeed.

SQL> CREATE OR REPLACE TRIGGER DTS20210507048OSDP1N00_U1.TRIG1 AFTER INSERT ON DTS20210507048OSDP1N00_U1.T1 IS
  2 BEGIN
  3  DTS20210507048OSDP1N00_U2.PROC1(1);
  4 END;
  5 /

Succeed.

SQL> CREATE TABLE DTS20210507048OSDP1N00_U1.T2(C1 INT);

Succeed.

SQL> CREATE TABLE DTS20210507048OSDP1N00_U2.T2(C1 INT);

Succeed.

SQL> GRANT INSERT ON DTS20210507048OSDP1N00_U2.T2 TO DTS20210507048OSDP1N00_U1;

Succeed.

SQL> CREATE OR REPLACE TRIGGER DTS20210507048OSDP1N00_U1.TRIG2 AFTER INSERT ON DTS20210507048OSDP1N00_U1.T2 IS
  2 BEGIN
  3  INSERT INTO DTS20210507048OSDP1N00_U2.T2 VALUES(1);
  4 END;
  5 /

Succeed.

SQL> INSERT INTO DTS20210507048OSDP1N00_U1.T1 VALUES(1);

1 rows affected.

SQL> INSERT INTO DTS20210507048OSDP1N00_U1.T2 VALUES(1);

1 rows affected.

SQL> COMMIT;

Succeed.

SQL> REVOKE EXECUTE ON DTS20210507048OSDP1N00_U2.PROC1 FROM DTS20210507048OSDP1N00_U1;

Succeed.

SQL> REVOKE INSERT ON DTS20210507048OSDP1N00_U2.T2 FROM DTS20210507048OSDP1N00_U1;

Succeed.

SQL> CONN DTS20210507048OSDP1N00_U1/Cantian_234@127.0.0.1:1611

connected.

SQL> INSERT INTO T1 VALUES(1);--expected:CT-01001, Permissions were insufficient

CT-01001, Permissions were insufficient
SQL> UPDATE T1 SET C1=2;

1 rows affected.

SQL> DELETE FROM T1;--succeed

1 rows affected.

SQL> COMMIT;

Succeed.

SQL> INSERT INTO T2 VALUES(1);--expected:CT-01001, Permissions were insufficient

CT-01001, Permissions were insufficient
SQL> 
SQL> --2.check priv after pl open dc in execute.such as open package body dc
SQL> CONN / AS SYSDBA

connected.

SQL> CREATE OR REPLACE PROCEDURE DTS20210507048OSDP1N00_U2.PROC1(V1 INT) IS
  2 BEGIN
  3  NULL;
  4 END;
  5 /

Succeed.

SQL> GRANT EXECUTE ON DTS20210507048OSDP1N00_U2.PROC1 TO DTS20210507048OSDP1N00_U1;

Succeed.

SQL> CREATE OR REPLACE PACKAGE DTS20210507048OSDP1N00_U1.PKG1 IS
  2  PROCEDURE P1(V1 INT);
  3 END;
  4 /

Succeed.

SQL> CREATE OR REPLACE PACKAGE BODY DTS20210507048OSDP1N00_U1.PKG1 IS
  2  PROCEDURE P1(V1 INT) IS
  3  BEGIN
  4   DTS20210507048OSDP1N00_U2.PROC1(V1);
  5  END;
  6 END;
  7 /

Succeed.

SQL> CALL DTS20210507048OSDP1N00_U1.PKG1.P1(1);

PL/SQL procedure successfully completed.

SQL> REVOKE EXECUTE ON DTS20210507048OSDP1N00_U2.PROC1 FROM DTS20210507048OSDP1N00_U1;

Succeed.

SQL> CONN DTS20210507048OSDP1N00_U1/Cantian_234@127.0.0.1:1611

connected.

SQL> CALL DTS20210507048OSDP1N00_U1.PKG1.P1(1);--expected:CT-01001, Permissions were insufficient

CT-00932, [1:2] PL/SQL(DTS20210507048OSDP1N00_U1.ANONYMOUS BLOCK) terminated with execute errors
[1:2] CT-01001, Permissions were insufficient

SQL> 
SQL> 
SQL> CONN / AS SYSDBA

connected.

SQL> DROP USER IF EXISTS DTS20210507048OSDP1N00_U1 CASCADE;

Succeed.

SQL> DROP USER IF EXISTS DTS20210507048OSDP1N00_U2 CASCADE;

Succeed.

SQL> --DTS20210507048OSDP1N00 END
SQL> 
SQL> --SERIAL_LASTVAL
SQL> DROP TABLE IF EXISTS TABLE_LAST;

Succeed.

SQL> CREATE TABLE TABLE_LAST (staff_id INT AUTO_INCREMENT  primary key ,section_id INT,max_salary NUMBER(10,2)) AUTO_INCREMENT 1000;

Succeed.

SQL> SELECT SERIAL_LASTVAL('SYS','TABLE_LAST');

SERIAL_LASTVAL('SYS','TABLE_LAST')
----------------------------------
1000                              

1 rows fetched.

SQL> 
SQL> drop user if exists USER_LAST cascade;

Succeed.

SQL> create user USER_LAST identified by Anti2850;

Succeed.

SQL> grant connect to USER_LAST;

Succeed.

SQL> conn USER_LAST/Anti2850@127.0.0.1:1611

connected.

SQL> select SERIAL_LASTVAL('SYS','TABLE_LAST'); --error

CT-01001, Permissions were insufficient
SQL> select SERIAL_LASTVAL('SYS','USER$'); --error

CT-01001, Permissions were insufficient
SQL> select SERIAL_LASTVAL('USER1','USER$'); --error

CT-01001, Permissions were insufficient
SQL> select SERIAL_LASTVAL('USER_LAST','USER_1');

CT-00843, The table or view USER_LAST.USER_1 does not exist.
SQL> 
SQL> conn / as sysdba

connected.

SQL> grant select on sys.TABLE_LAST to USER_LAST;

Succeed.

SQL> conn USER_LAST/Anti2850@127.0.0.1:1611

connected.

SQL> select SERIAL_LASTVAL('SYS','TABLE_LAST');

SERIAL_LASTVAL('SYS','TABLE_LAST')
----------------------------------
1000                              

1 rows fetched.

SQL> select SERIAL_LASTVAL('SYS','USER_T'); --error

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> revoke select on sys.TABLE_LAST from USER_LAST;

Succeed.

SQL> conn USER_LAST/Anti2850@127.0.0.1:1611

connected.

SQL> select SERIAL_LASTVAL('SYS','TABLE_LAST'); --error

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> grant select any table to USER_LAST;

Succeed.

SQL> conn USER_LAST/Anti2850@127.0.0.1:1611

connected.

SQL> select SERIAL_LASTVAL('SYS','TABLE_LAST');

SERIAL_LASTVAL('SYS','TABLE_LAST')
----------------------------------
1000                              

1 rows fetched.

SQL> select SERIAL_LASTVAL('SYS','USER_T'); --error

CT-00843, The table or view SYS.USER_T does not exist.
SQL> 
SQL> conn / as sysdba

connected.

SQL> revoke select any table from USER_LAST;

Succeed.

SQL> conn USER_LAST/Anti2850@127.0.0.1:1611

connected.

SQL> select SERIAL_LASTVAL('SYS','TABLE_LAST');  --error

CT-01001, Permissions were insufficient
SQL> 
SQL> conn / as sysdba

connected.

SQL> CREATE TABLE USER_LAST.TABLE_LAST1 (staff_id INT AUTO_INCREMENT  primary key ,section_id INT,max_salary NUMBER(10,2)) AUTO_INCREMENT 1100;

Succeed.

SQL> CREATE TABLE USER_LAST.TABLE_LAST2 (staff_id INT);

Succeed.

SQL> conn USER_LAST/Anti2850@127.0.0.1:1611

connected.

SQL> select SERIAL_LASTVAL('USER_LAST','TABLE_LAST1');

SERIAL_LASTVAL('USER_LAST','TABLE_LAST1')
-----------------------------------------
1100                                     

1 rows fetched.

SQL> select SERIAL_LASTVAL('USER_LAST','TABLE_LAST2');

CT-00866, The table has no auto increment column
SQL> select SERIAL_LASTVAL('USER_LAST','TABLE_LAST3');

CT-00843, The table or view USER_LAST.TABLE_LAST3 does not exist.
SQL> 
SQL> CONN / AS SYSDBA

connected.

SQL> DROP USER IF EXISTS USER_LAST CASCADE;

Succeed.

SQL> DROP TABLE IF EXISTS TABLE_LAST;

Succeed.

SQL> --SERIAL_LASTVAL END
SQL> --20210830
SQL> drop tenant if exists tent_1 cascade;

Succeed.

SQL> CREATE TENANT tent_1  TABLESPACES (users);

Succeed.

SQL> alter session set tenant=tent_1;

Succeed.

SQL> drop user if exists tpcc_1 cascade;

Succeed.

SQL> create user tpcc_1 identified by Cantian_234;

Succeed.

SQL> grant create session to tpcc_1;

Succeed.

SQL> grant create table to tpcc_1;

Succeed.

SQL> grant DROP ANY TABLE to tpcc_1;

Succeed.

SQL> grant EXECUTE ON DBE_SPM to tpcc_1;

Succeed.

SQL> grant INSERT ANY TABLE to tpcc_1;

Succeed.

SQL> grant select on DV_SQL_PLAN to tpcc_1;

Succeed.

SQL> grant select on DV_SQLS to tpcc_1;

Succeed.

SQL> drop table if exists T_SPM_1;

Succeed.

SQL> CREATE TABLE T_SPM_1(ID INT PRIMARY KEY, C_NUMBER NUMBER, C_CHAR CHAR(10), C_VCHAR VARCHAR(200));

Succeed.

SQL> INSERT INTO T_SPM_1 VALUES(1, 1000, 'TEST', 'TEST');

1 rows affected.

SQL> drop tenant if exists tent_2 cascade;

Succeed.

SQL> CREATE TENANT tent_2  TABLESPACES (users);

Succeed.

SQL> alter session set tenant=tent_2;

Succeed.

SQL> drop user if exists tpcc_2 cascade;

Succeed.

SQL> create user tpcc_2 identified by Cantian_234;

Succeed.

SQL> grant create session to tpcc_2;

Succeed.

SQL> grant create table to tpcc_2;

Succeed.

SQL> grant DROP ANY TABLE to tpcc_2;

Succeed.

SQL> grant EXECUTE ON DBE_SPM to tpcc_2;

Succeed.

SQL> grant INSERT ANY TABLE to tpcc_2;

Succeed.

SQL> grant select on DV_SQL_PLAN to tpcc_2;

Succeed.

SQL> grant select on DV_SQLS to tpcc_2;

Succeed.

SQL> alter session set tenant=tent_2;

Succeed.

SQL> grant select on tpcc_1.T_SPM_1 to tpcc_2;

CT-00828, object TENT_2$TPCC_1.T_SPM_1 does not exist



