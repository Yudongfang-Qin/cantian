

SQL> DROP TABLE IF EXISTS TRANS_RECORD;

Succeed.

SQL> CREATE TABLE TRANS_RECORD
  2 (
  3 	SEQ_NO bigint,
  4 	SEQ_FLAG int,
  5 	TR_API_ID varchar(32), 
  6 	TR_API_VERSION varchar(10), 
  7 	TR_TIME timestamp DEFAULT CURRENT_TIMESTAMP, 
  8 	TR_TIME_MS bigint, 
  9 	TR_CHANNEL char(6), 
 10 	DURATION int,
 11 	REF_NO varchar(32), 
 12 	STATE char(1),
 13 	ID_TYPE char(2), 
 14 	ID_NO varchar(50), 
 15 	CUST_NO char(16), 
 16 	CARD_NO1 varchar(19), 
 17 	CARD_NO2 varchar(19), 
 18 	CUST_NAME varchar(100), 
 19 	UID varchar(12),
 20 	RSP_CODE varchar(12), 
 21 	RSP_MSG varchar(512), 
 22 	EXTRA_INFO varchar(1024), 
 23 	RESERVE1 varchar(32), 
 24 	RESERVE2 varchar(64), 
 25 	RESERVE3 varchar(128), 
 26 	REQUEST varchar(1024),
 27 	RESPONSE varchar(4000)
 28 );

Succeed.

SQL> 
SQL> ALTER  TABLE TRANS_RECORD ADD PRIMARY KEY (REF_NO, TR_TIME);

Succeed.

SQL> CREATE INDEX TRANS_RECORD_INDEX_1 ON TRANS_RECORD(ID_NO, CARD_NO1); 

Succeed.

SQL> CREATE INDEX TRANS_RECORD_INDEX_2 ON TRANS_RECORD(TR_TIME); 

Succeed.

SQL> 
SQL> select TR_API_ID,
  2        TR_API_VERSION,
  3        TR_TIME,
  4        TR_TIME_MS,
  5        TR_CHANNEL,
  6        DURATION,
  7        REF_NO,
  8        STATE,
  9        ID_TYPE,
 10        ID_NO,
 11        CUST_NO,
 12        CARD_NO1,
 13        CARD_NO2,
 14        CUST_NAME,
 15        UID,
 16        RSP_CODE,
 17        RSP_MSG,
 18        EXTRA_INFO,
 19        RESERVE1,
 20        RESERVE2,
 21        RESERVE3,
 22        REQUEST,
 23        RESPONSE
 24   from TRANS_RECORD
 25  where 1 = 1
 26    and TR_TIME between to_date('2017-12-11 14:08:00', 'yyyy-mm-dd hh24:mi:ss') and to_date('2017-12-12 14:08:02', 'yyyy-mm-dd hh24:mi:ss')
 27  order by TR_TIME desc limit 2, 2;

TR_API_ID                        TR_API_VERSION TR_TIME                          TR_TIME_MS           TR_CHANNEL DURATION     REF_NO                           STATE ID_TYPE ID_NO                                              CUST_NO          CARD_NO1            CARD_NO2            CUST_NAME                                                        UID          RSP_CODE     RSP_MSG                                                          EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST                                                          RESPONSE                                                        
-------------------------------- -------------- -------------------------------- -------------------- ---------- ------------ -------------------------------- ----- ------- -------------------------------------------------- ---------------- ------------------- ------------------- ---------------------------------------------------------------- ------------ ------------ ---------------------------------------------------------------- ---------------------------------------------------------------- -------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------------------------------------------------------------

0 rows fetched.

SQL> 
SQL> 
SQL> insert into TRANS_RECORD (SEQ_NO, SEQ_FLAG,TR_API_ID, TR_API_VERSION, TR_TIME, TR_TIME_MS, TR_CHANNEL, REF_NO, STATE, ID_TYPE, ID_NO, CUST_NO, CARD_NO1, CARD_NO2, CUST_NAME, UID,RSP_CODE, RSP_MSG, EXTRA_INFO, RESERVE1, RESERVE2, RESERVE3, REQUEST)  
  2 values (1,2,'1', 'V1R1C00', '2017-12-11 14:08:00', 123456789012, '0', 'REF_1', '0', 'T', 'id_no_1', 'cust_no_1', 'card_no1_1', 'card_no2_1', 'cust_name_1', 'UID_1','RSP_CODE_1', 'RSP_MSG_1', 'EXTRA_INFO', 'RESERVE1', 'RESERVE2', 'RESERVE3', 'REQUEST');

1 rows affected.

SQL> 
SQL> insert into TRANS_RECORD (SEQ_NO, SEQ_FLAG,TR_API_ID, TR_API_VERSION, TR_TIME, TR_TIME_MS, TR_CHANNEL, REF_NO, STATE, ID_TYPE, ID_NO, CUST_NO, CARD_NO1, CARD_NO2, CUST_NAME, UID, RSP_CODE, RSP_MSG, EXTRA_INFO, RESERVE1, RESERVE2, RESERVE3, REQUEST)  
  2 values (2,3,'1', 'V1R1C00', '2017-12-11 14:08:01', 123456789012, '0', 'REF_1', '0', 'T', 'id_no_1', 'cust_no_1', 'card_no1_1', 'card_no2_1', 'cust_name_1', 'UID_1','RSP_CODE_1', 'RSP_MSG_1', 'EXTRA_INFO', 'RESERVE1', 'RESERVE2', 'RESERVE3', 'REQUEST');

1 rows affected.

SQL> 
SQL> insert into TRANS_RECORD (SEQ_NO, SEQ_FLAG,TR_API_ID, TR_API_VERSION, TR_TIME, TR_TIME_MS, TR_CHANNEL, REF_NO, STATE, ID_TYPE, ID_NO, CUST_NO, CARD_NO1, CARD_NO2, CUST_NAME, UID, RSP_CODE, RSP_MSG, EXTRA_INFO, RESERVE1, RESERVE2, RESERVE3, REQUEST)  
  2 values (3,4,'1', 'V1R1C00', '2017-12-11 14:08:02', 123456789012, '0', 'REF_1', '0', 'T', 'id_no_2', 'cust_no_1', 'card_no1_1', 'card_no2_1', 'cust_name_1', 'UID_1','RSP_CODE_1', 'RSP_MSG_1', 'EXTRA_INFO', 'RESERVE1', 'RESERVE2', 'RESERVE3', 'REQUEST');

1 rows affected.

SQL> 
SQL> insert into TRANS_RECORD (SEQ_NO, SEQ_FLAG,TR_API_ID, TR_API_VERSION, TR_TIME, TR_TIME_MS, TR_CHANNEL, REF_NO, STATE, ID_TYPE, ID_NO, CUST_NO, CARD_NO1, CARD_NO2, CUST_NAME, UID, RSP_CODE, RSP_MSG, EXTRA_INFO, RESERVE1, RESERVE2, RESERVE3, REQUEST)  
  2 values (4,5,'1', 'V1R1C00', '2017-12-11 14:08:02', 123456789012, '0', 'REF_2', '0', 'P', 'id_no_1', 'cust_no_1', 'card_no1_1', 'card_no2_1', 'cust_name_1', 'UID_1','RSP_CODE_1', 'RSP_MSG_1', 'EXTRA_INFO', 'RESERVE1', 'RESERVE2', 'RESERVE3', 'REQUEST');

1 rows affected.

SQL> 
SQL> insert into TRANS_RECORD (SEQ_NO, SEQ_FLAG,TR_API_ID, TR_API_VERSION, TR_TIME, TR_TIME_MS, TR_CHANNEL, REF_NO, STATE, ID_TYPE, ID_NO, CUST_NO, CARD_NO1, CARD_NO2, CUST_NAME, UID, RSP_CODE, RSP_MSG, EXTRA_INFO, RESERVE1, RESERVE2, RESERVE3, REQUEST)  
  2 values (5,6,'1', 'V1R1C00', '2017-12-12 14:08:02', 123456789012, '0', 'REF_1', '0', 'T', 'id_no_1', 'cust_no_1', 'card_no1_2', 'card_no2_1', 'cust_name_1', 'UID_1','RSP_CODE_1', 'RSP_MSG_1', 'EXTRA_INFO', 'RESERVE1', 'RESERVE2', 'RESERVE3', 'REQUEST');

1 rows affected.

SQL> 
SQL> select TR_API_ID,
  2        TR_API_VERSION,
  3        TR_TIME,
  4        TR_TIME_MS,
  5        TR_CHANNEL,
  6        DURATION,
  7        REF_NO,
  8        STATE,
  9        ID_TYPE,
 10        ID_NO,
 11        CUST_NO,
 12        CARD_NO1,
 13        CARD_NO2,
 14        CUST_NAME,
 15        UID,
 16        RSP_CODE,
 17        RSP_MSG,
 18        EXTRA_INFO,
 19        RESERVE1,
 20        RESERVE2,
 21        RESERVE3,
 22        REQUEST,
 23        RESPONSE
 24   from TRANS_RECORD
 25  where 1 = 1
 26    and TR_TIME between to_date('2017-12-11 14:08:00','yyyy-mm-dd hh24:mi:ss') and to_date('2017-12-12 14:08:02','yyyy-mm-dd hh24:mi:ss')
 27  order by TR_TIME desc limit 2, 2;

TR_API_ID                        TR_API_VERSION TR_TIME                          TR_TIME_MS           TR_CHANNEL DURATION     REF_NO                           STATE ID_TYPE ID_NO                                              CUST_NO          CARD_NO1            CARD_NO2            CUST_NAME                                                        UID          RSP_CODE     RSP_MSG                                                          EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST                                                          RESPONSE                                                        
-------------------------------- -------------- -------------------------------- -------------------- ---------- ------------ -------------------------------- ----- ------- -------------------------------------------------- ---------------- ------------------- ------------------- ---------------------------------------------------------------- ------------ ------------ ---------------------------------------------------------------- ---------------------------------------------------------------- -------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------------------------------------------------------------
1                                V1R1C00        2017-12-11 14:08:02.000000       123456789012         0                       REF_2                            0     P       id_no_1                                            cust_no_1        card_no1_1          card_no2_1          cust_name_1                                                      UID_1        RSP_CODE_1   RSP_MSG_1                                                        EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST
1                                V1R1C00        2017-12-11 14:08:01.000000       123456789012         0                       REF_1                            0     T       id_no_1                                            cust_no_1        card_no1_1          card_no2_1          cust_name_1                                                      UID_1        RSP_CODE_1   RSP_MSG_1                                                        EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST

2 rows fetched.

SQL> 
SQL> 
SQL> select TR_API_ID,
  2        TR_API_VERSION,
  3        TR_TIME,
  4        TR_TIME_MS,
  5        TR_CHANNEL,
  6        DURATION,
  7        REF_NO,
  8        STATE,
  9        ID_TYPE,
 10        ID_NO,
 11        CUST_NO,
 12        CARD_NO1,
 13        CARD_NO2,
 14        CUST_NAME,
 15        UID,
 16        RSP_CODE,
 17        RSP_MSG,
 18        EXTRA_INFO,
 19        RESERVE1,
 20        RESERVE2,
 21        RESERVE3,
 22        REQUEST,
 23        RESPONSE
 24   from TRANS_RECORD
 25  where 1 = 1
 26    and ID_NO = 'id_no_1'
 27    and ID_TYPE = 'T'
 28    and CARD_NO1 = 'card_no1_1'
 29    and CARD_NO2 = 'card_no2_1'
 30    and TR_API_ID = '1'
 31    and CUST_NO = 'cust_no_1'
 32    and REF_NO = 'REF_1'
 33    and STATE = '0'
 34    and RSP_CODE = 'RSP_CODE_1'
 35    and TR_API_ID in (2, 1)
 36    and TR_TIME between to_date('2017-12-11 14:08:00','yyyy-mm-dd hh24:mi:ss') and to_date('2017-12-11 14:08:02','yyyy-mm-dd hh24:mi:ss')
 37  order by TR_TIME desc limit 0, 2;

TR_API_ID                        TR_API_VERSION TR_TIME                          TR_TIME_MS           TR_CHANNEL DURATION     REF_NO                           STATE ID_TYPE ID_NO                                              CUST_NO          CARD_NO1            CARD_NO2            CUST_NAME                                                        UID          RSP_CODE     RSP_MSG                                                          EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST                                                          RESPONSE                                                        
-------------------------------- -------------- -------------------------------- -------------------- ---------- ------------ -------------------------------- ----- ------- -------------------------------------------------- ---------------- ------------------- ------------------- ---------------------------------------------------------------- ------------ ------------ ---------------------------------------------------------------- ---------------------------------------------------------------- -------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------------------------------------------------------------
1                                V1R1C00        2017-12-11 14:08:01.000000       123456789012         0                       REF_1                            0     T       id_no_1                                            cust_no_1        card_no1_1          card_no2_1          cust_name_1                                                      UID_1        RSP_CODE_1   RSP_MSG_1                                                        EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST                                                                                                                          
1                                V1R1C00        2017-12-11 14:08:00.000000       123456789012         0                       REF_1                            0     T       id_no_1                                            cust_no_1        card_no1_1          card_no2_1          cust_name_1                                                      UID_1        RSP_CODE_1   RSP_MSG_1                                                        EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST                                                                                                                          

2 rows fetched.

SQL> 
SQL> update TRANS_RECORD set DURATION = 3, STATE = '1', CUST_NO = 'cust_no_2', RSP_CODE = 'RSP_CODE_2', RSP_MSG  = 'RSP_MSG_2', RESPONSE = 'RESPONSE' where REF_NO = 'REF_2' and TR_API_ID = '1' and TR_TIME = to_date('2017-12-11 14:08:02','yyyy-mm-dd hh24:mi:ss');

1 rows affected.

SQL> 
SQL> select DURATION,STATE,CUST_NO,RSP_CODE,RSP_MSG,RESPONSE from TRANS_RECORD where DURATION = 3;

DURATION     STATE CUST_NO          RSP_CODE     RSP_MSG                                                          RESPONSE                                                        
------------ ----- ---------------- ------------ ---------------------------------------------------------------- ----------------------------------------------------------------
3            1     cust_no_2        RSP_CODE_2   RSP_MSG_2                                                        RESPONSE                                                        

1 rows fetched.

SQL> 
SQL> select * from TRANS_RECORD where 1=1 and REF_NO = 'REF_2' and TR_API_ID = '1' and TR_TIME = to_date('2017-12-11 14:08:02','yyyy-mm-dd hh24:mi:ss') order by TR_TIME desc limit 1;

SEQ_NO               SEQ_FLAG     TR_API_ID                        TR_API_VERSION TR_TIME                          TR_TIME_MS           TR_CHANNEL DURATION     REF_NO                           STATE ID_TYPE ID_NO                                              CUST_NO          CARD_NO1            CARD_NO2            CUST_NAME                                                        UID          RSP_CODE     RSP_MSG                                                          EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST                                                          RESPONSE                                                        
-------------------- ------------ -------------------------------- -------------- -------------------------------- -------------------- ---------- ------------ -------------------------------- ----- ------- -------------------------------------------------- ---------------- ------------------- ------------------- ---------------------------------------------------------------- ------------ ------------ ---------------------------------------------------------------- ---------------------------------------------------------------- -------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------------------------------------------------------------
4                    5            1                                V1R1C00        2017-12-11 14:08:02.000000       123456789012         0          3            REF_2                            1     P       id_no_1                                            cust_no_2        card_no1_1          card_no2_1          cust_name_1                                                      UID_1        RSP_CODE_2   RSP_MSG_2                                                        EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST                                                          RESPONSE                                                        

1 rows fetched.

SQL> 
SQL> select SEQ_NO,
  2        SEQ_FLAG,
  3        TR_API_ID,
  4        TR_API_VERSION,
  5        TR_TIME,
  6        TR_CHANNEL,
  7        DURATION,
  8        REF_NO,
  9        STATE,
 10        ID_TYPE,
 11        ID_NO,
 12        CUST_NO,
 13        CARD_NO1,
 14        CARD_NO2,
 15        CUST_NAME,
 16        UID,
 17        RSP_CODE,
 18        RSP_MSG,
 19        EXTRA_INFO,
 20        RESERVE1,
 21        RESERVE2,
 22        RESERVE3,
 23        REQUEST,
 24        RESPONSE
 25   from TRANS_RECORD
 26  where TR_TIME >= to_date('2017-12-11 14:08:00','yyyy-mm-dd hh24:mi:ss')
 27    and TR_TIME < to_date('2017-12-12 14:08:02','yyyy-mm-dd hh24:mi:ss')
 28    and SEQ_NO > 1
 29  order by SEQ_NO asc, SEQ_FLAG asc limit 1000;

SEQ_NO               SEQ_FLAG     TR_API_ID                        TR_API_VERSION TR_TIME                          TR_CHANNEL DURATION     REF_NO                           STATE ID_TYPE ID_NO                                              CUST_NO          CARD_NO1            CARD_NO2            CUST_NAME                                                        UID          RSP_CODE     RSP_MSG                                                          EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST                                                          RESPONSE                                                        
-------------------- ------------ -------------------------------- -------------- -------------------------------- ---------- ------------ -------------------------------- ----- ------- -------------------------------------------------- ---------------- ------------------- ------------------- ---------------------------------------------------------------- ------------ ------------ ---------------------------------------------------------------- ---------------------------------------------------------------- -------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------------------------------------------------------------
2                    3            1                                V1R1C00        2017-12-11 14:08:01.000000       0                       REF_1                            0     T       id_no_1                                            cust_no_1        card_no1_1          card_no2_1          cust_name_1                                                      UID_1        RSP_CODE_1   RSP_MSG_1                                                        EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST                                                                                                                          
3                    4            1                                V1R1C00        2017-12-11 14:08:02.000000       0                       REF_1                            0     T       id_no_2                                            cust_no_1        card_no1_1          card_no2_1          cust_name_1                                                      UID_1        RSP_CODE_1   RSP_MSG_1                                                        EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST                                                                                                                          
4                    5            1                                V1R1C00        2017-12-11 14:08:02.000000       0          3            REF_2                            1     P       id_no_1                                            cust_no_2        card_no1_1          card_no2_1          cust_name_1                                                      UID_1        RSP_CODE_2   RSP_MSG_2                                                        EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST                                                          RESPONSE                                                        

3 rows fetched.

SQL> 
SQL> select * from trans_record where TR_TIME between to_date('2017-12-11 14:08:00','yyyy-mm-dd hh24:mi:ss') and  to_date('2017-12-12 14:08:02','yyyy-mm-dd hh24:mi:ss') order by TR_TIME, SEQ_NO desc limit 2,2;

SEQ_NO               SEQ_FLAG     TR_API_ID                        TR_API_VERSION TR_TIME                          TR_TIME_MS           TR_CHANNEL DURATION     REF_NO                           STATE ID_TYPE ID_NO                                              CUST_NO          CARD_NO1            CARD_NO2            CUST_NAME                                                        UID          RSP_CODE     RSP_MSG                                                          EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST                                                          RESPONSE                                                        
-------------------- ------------ -------------------------------- -------------- -------------------------------- -------------------- ---------- ------------ -------------------------------- ----- ------- -------------------------------------------------- ---------------- ------------------- ------------------- ---------------------------------------------------------------- ------------ ------------ ---------------------------------------------------------------- ---------------------------------------------------------------- -------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------------------------------------------------------------
4                    5            1                                V1R1C00        2017-12-11 14:08:02.000000       123456789012         0          3            REF_2                            1     P       id_no_1                                            cust_no_2        card_no1_1          card_no2_1          cust_name_1                                                      UID_1        RSP_CODE_2   RSP_MSG_2                                                        EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST                                                          RESPONSE                                                        
3                    4            1                                V1R1C00        2017-12-11 14:08:02.000000       123456789012         0                       REF_1                            0     T       id_no_2                                            cust_no_1        card_no1_1          card_no2_1          cust_name_1                                                      UID_1        RSP_CODE_1   RSP_MSG_1                                                        EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST                                                                                                                          

2 rows fetched.

SQL> 
SQL> select tr_time, tr_api_id, tr_channel, rsp_code, count(1) as total_num
  2   from TRANS_RECORD
  3  where TR_TIME between to_date('2017-12-11 14:08:00','yyyy-mm-dd hh24:mi:ss') and to_date('2017-12-12 14:08:02','yyyy-mm-dd hh24:mi:ss')
  4  group by tr_time, tr_api_id, tr_channel, rsp_code
  5  order by TR_TIME desc, tr_channel,RSP_CODE;

TR_TIME                          TR_API_ID                        TR_CHANNEL RSP_CODE     TOTAL_NUM           
-------------------------------- -------------------------------- ---------- ------------ --------------------
2017-12-12 14:08:02.000000       1                                0          RSP_CODE_1   1                   
2017-12-11 14:08:02.000000       1                                0          RSP_CODE_1   1                   
2017-12-11 14:08:02.000000       1                                0          RSP_CODE_2   1                   
2017-12-11 14:08:01.000000       1                                0          RSP_CODE_1   1                   
2017-12-11 14:08:00.000000       1                                0          RSP_CODE_1   1                   

5 rows fetched.

SQL> 
SQL> 
SQL>  (select SEQ_NO,
  2         SEQ_FLAG,
  3         TR_API_ID,
  4         TR_API_VERSION,
  5         TR_TIME,
  6         TR_TIME_MS,
  7         TR_CHANNEL,
  8         DURATION,
  9         REF_NO,
 10         STATE,
 11         ID_TYPE,
 12         ID_NO,
 13         CUST_NO,
 14         CARD_NO1,
 15         CARD_NO2,
 16         CUST_NAME,
 17         UID,
 18         RSP_CODE,
 19         RSP_MSG,
 20         EXTRA_INFO,
 21         RESERVE1,
 22         RESERVE2,
 23         RESERVE3,
 24         REQUEST,
 25         RESPONSE
 26    from TRANS_RECORD
 27   where 1 = 1
 28     and ID_NO = 'id_no_1'
 29     and ID_TYPE = 'T'
 30     and CARD_NO1 = 'card_no1_1'
 31     and CARD_NO2 = 'card_no2_1'
 32     and TR_API_ID = 1
 33     and CUST_NO = 'cust_no_1'
 34     and REF_NO = 'REF_1'
 35     and STATE = '0'
 36     and RSP_CODE = 'RSP_CODE_1'
 37     and TR_API_ID in (1,2)
 38     and TR_TIME >= to_date('2017-12-11 14:08:00','yyyy-mm-dd hh24:mi:ss')
 39     and TR_TIME < to_date('2017-12-12 14:08:02','yyyy-mm-dd hh24:mi:ss')
 40  )
 41  union all 
 42 (
 43 select SEQ_NO,
 44        SEQ_FLAG,
 45        TR_API_ID,
 46        TR_API_VERSION,
 47        TR_TIME,
 48        TR_TIME_MS,
 49        TR_CHANNEL,
 50        DURATION,
 51        REF_NO,
 52        STATE,
 53        ID_TYPE,
 54        ID_NO,
 55        CUST_NO,
 56        CARD_NO1,
 57        CARD_NO2,
 58        CUST_NAME,
 59        UID,
 60        RSP_CODE,
 61        RSP_MSG,
 62        EXTRA_INFO,
 63        RESERVE1,
 64        RESERVE2,
 65        RESERVE3,
 66        REQUEST,
 67        RESPONSE
 68   from TRANS_RECORD
 69  where 1 = 1
 70     and ID_NO = 'id_no_1'
 71     and ID_TYPE = 'T'
 72     and CARD_NO1 = 'card_no1_1'
 73     and CARD_NO2 = 'card_no2_1'
 74     and TR_API_ID = 1
 75     and CUST_NO = 'cust_no_1'
 76     and REF_NO = 'REF_1'
 77     and STATE = '0'
 78     and RSP_CODE = 'RSP_CODE_1'
 79     and TR_API_ID in (1,2)
 80     and TR_TIME >= to_date('2017-12-11 14:08:01','yyyy-mm-dd hh24:mi:ss')
 81     and TR_TIME < to_date('2017-12-12 14:08:03','yyyy-mm-dd hh24:mi:ss')
 82 )
 83 order by TR_TIME desc  limit 1,1;

SEQ_NO               SEQ_FLAG     TR_API_ID                        TR_API_VERSION TR_TIME                          TR_TIME_MS           TR_CHANNEL DURATION     REF_NO                           STATE ID_TYPE ID_NO                                              CUST_NO          CARD_NO1            CARD_NO2            CUST_NAME                                                        UID          RSP_CODE     RSP_MSG                                                          EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST                                                          RESPONSE                                                        
-------------------- ------------ -------------------------------- -------------- -------------------------------- -------------------- ---------- ------------ -------------------------------- ----- ------- -------------------------------------------------- ---------------- ------------------- ------------------- ---------------------------------------------------------------- ------------ ------------ ---------------------------------------------------------------- ---------------------------------------------------------------- -------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ----------------------------------------------------------------
2                    3            1                                V1R1C00        2017-12-11 14:08:01.000000       123456789012         0                       REF_1                            0     T       id_no_1                                            cust_no_1        card_no1_1          card_no2_1          cust_name_1                                                      UID_1        RSP_CODE_1   RSP_MSG_1                                                        EXTRA_INFO                                                       RESERVE1                         RESERVE2                                                         RESERVE3                                                         REQUEST                                                                                                                          

1 rows fetched.

SQL> 
SQL> commit;
Succeed.




