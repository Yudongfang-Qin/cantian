

SQL> DROP TABLE IF EXISTS T_JOIN_PLUS_1;

Succeed.

SQL> DROP TABLE IF EXISTS T_JOIN_PLUS_2;

Succeed.

SQL> DROP TABLE IF EXISTS T_JOIN_PLUS_3;

Succeed.

SQL> DROP TABLE IF EXISTS T_JOIN_PLUS_4;

Succeed.

SQL> DROP TABLE IF EXISTS T_JOIN_PLUS_5;

Succeed.

SQL> DROP TABLE IF EXISTS T_JOIN_PLUS_6;

Succeed.

SQL> CREATE TABLE T_JOIN_PLUS_1 (F_INT1 INT, F_INT2 INT);

Succeed.

SQL> CREATE TABLE T_JOIN_PLUS_2 (F_INT1 INT, F_INT2 INT);

Succeed.

SQL> CREATE TABLE T_JOIN_PLUS_3 (F_INT1 INT, F_INT2 INT);

Succeed.

SQL> CREATE TABLE T_JOIN_PLUS_4 (F_INT1 INT, F_INT2 INT);

Succeed.

SQL> CREATE TABLE T_JOIN_PLUS_5 (F_INT1 INT, F_INT2 INT);

Succeed.

SQL> CREATE TABLE T_JOIN_PLUS_6 (F_INT1 INT, F_INT2 INT);

Succeed.

SQL> 
SQL> --expect error,(+) not support  having cond
SQL> SELECT T1.F_INT1,T2.F_INT1 FROM T_JOIN_PLUS_1 T1,T_JOIN_PLUS_2 T2 GROUP BY T1.F_INT1,T2.F_INT1 HAVING T1.F_INT1 = T2.F_INT1(+);

CT-00601, [1:115]Sql syntax error: invalid usage outer join symbol
SQL> 
SQL> INSERT INTO T_JOIN_PLUS_1(F_INT1,F_INT2) values(1, 11);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_1(F_INT1,F_INT2) values(2, 22);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_1(F_INT1,F_INT2) values(null, 22);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_1(F_INT1,F_INT2) values(20, 22);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_2(F_INT1,F_INT2) values(1, 11);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_2(F_INT1,F_INT2) values(1, 11);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_2(F_INT1,F_INT2) values(2, 11);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_2(F_INT1,F_INT2) values(null, 22);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_2(F_INT1,F_INT2) values(3, 33);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_2(F_INT1,F_INT2) values(3, 33);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_3(F_INT1,F_INT2) values(1, 11);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_3(F_INT1,F_INT2) values(1, 11);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_3(F_INT1,F_INT2) values(2, 11);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_3(F_INT1,F_INT2) values(null, 22);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_3(F_INT1,F_INT2) values(3, 33);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_3(F_INT1,F_INT2) values(3, 33);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_4(F_INT1,F_INT2) values(1, 11);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_4(F_INT1,F_INT2) values(2, 22);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_4(F_INT1,F_INT2) values(null, 22);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_5(F_INT1,F_INT2) values(1, 11);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_5(F_INT1,F_INT2) values(1, 11);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_5(F_INT1,F_INT2) values(2, 11);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_5(F_INT1,F_INT2) values(null, 22);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_5(F_INT1,F_INT2) values(3, 33);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_5(F_INT1,F_INT2) values(3, 33);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_6(F_INT1,F_INT2) values(1, 11);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_6(F_INT1,F_INT2) values(1, 11);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_6(F_INT1,F_INT2) values(2, 11);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_6(F_INT1,F_INT2) values(null, 22);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_6(F_INT1,F_INT2) values(3, 33);

1 rows affected.

SQL> INSERT INTO T_JOIN_PLUS_6(F_INT1,F_INT2) values(3, 33);

1 rows affected.

SQL> COMMIT;

Succeed.

SQL> 
SQL> -- (+) is not allowed when join exists, expect error
SQL> SELECT * FROM T_JOIN_PLUS_1 A LEFT JOIN T_JOIN_PLUS_2 B ON A.F_INT1=B.F_INT1(+);

CT-00601, [1:69]Sql syntax error: invalid usage outer join symbol
SQL> 
SQL> SELECT T1.F_INT1,T2.F_INT1 FROM T_JOIN_PLUS_1 T1,T_JOIN_PLUS_2 T2 WHERE T1.F_INT1 = T2.F_INT1(+) AND T1.F_INT1(+) > 0 ORDER BY 1;

F_INT1       F_INT1      
------------ ------------
1            1           
1            1           
2            2           
20                       

4 rows fetched.

SQL> 
SQL> --oracle 11g not support this scenario , oracle 12c support
SQL> SELECT T_JOIN_PLUS_1.F_INT1,T_JOIN_PLUS_2.F_INT1,T_JOIN_PLUS_3.F_INT1,T_JOIN_PLUS_4.F_INT1,T_JOIN_PLUS_5.F_INT1,T_JOIN_PLUS_6.F_INT1 
  2 FROM T_JOIN_PLUS_1,T_JOIN_PLUS_2,T_JOIN_PLUS_3,T_JOIN_PLUS_4,T_JOIN_PLUS_5,T_JOIN_PLUS_6 
  3 WHERE T_JOIN_PLUS_1.F_INT1(+) = T_JOIN_PLUS_2.F_INT1 
  4 AND T_JOIN_PLUS_2.F_INT1 = T_JOIN_PLUS_3.F_INT1(+) 
  5 AND T_JOIN_PLUS_6.F_INT1(+) = T_JOIN_PLUS_2.F_INT1 
  6 AND T_JOIN_PLUS_6.F_INT1(+) = T_JOIN_PLUS_4.F_INT1 
  7 AND T_JOIN_PLUS_4.F_INT1(+) = T_JOIN_PLUS_5.F_INT1 ORDER BY 1,2,3,4,5,6;

F_INT1       F_INT1       F_INT1       F_INT1       F_INT1       F_INT1      
------------ ------------ ------------ ------------ ------------ ------------
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            2            2                        
1            1            1            2            2                        
1            1            1            2            2                        
1            1            1            2            2                        
1            1            1                         3                        
1            1            1                         3                        
1            1            1                         3                        
1            1            1                         3                        
1            1            1                         3                        
1            1            1                         3                        
1            1            1                         3                        
1            1            1                         3                        
1            1            1                                                  
1            1            1                                                  
1            1            1                                                  
1            1            1                                                  
2            2            2            1            1                        
2            2            2            1            1                        
2            2            2            2            2            2           
2            2            2                         3                        
2            2            2                         3                        
2            2            2                                                  
             3            3            1            1                        
             3            3            1            1                        
             3            3            1            1                        
             3            3            1            1                        
             3            3            1            1                        
             3            3            1            1                        
             3            3            1            1                        
             3            3            1            1                        
             3            3            2            2                        
             3            3            2            2                        
             3            3            2            2                        
             3            3            2            2                        
             3            3                         3                        
             3            3                         3                        
             3            3                         3                        
             3            3                         3                        
             3            3                         3                        
             3            3                         3                        
             3            3                         3                        
             3            3                         3                        
             3            3                                                  
             3            3                                                  
             3            3                                                  
             3            3                                                  
                                       1            1                        
                                       1            1                        
                                       2            2                        
                                                    3                        
                                                    3                        
                                                                             

68 rows fetched.

SQL> 
SQL> SELECT T_JOIN_PLUS_1.F_INT1,T_JOIN_PLUS_2.F_INT1,T_JOIN_PLUS_3.F_INT1,T_JOIN_PLUS_4.F_INT1,T_JOIN_PLUS_5.F_INT1,T_JOIN_PLUS_6.F_INT1 
  2 FROM T_JOIN_PLUS_2
  3 	LEFT  JOIN T_JOIN_PLUS_1 ON T_JOIN_PLUS_1.F_INT1 = T_JOIN_PLUS_2.F_INT1 
  4 	LEFT  JOIN T_JOIN_PLUS_3 ON T_JOIN_PLUS_2.F_INT1 = T_JOIN_PLUS_3.F_INT1
  5 	INNER JOIN T_JOIN_PLUS_5 ON 1=1
  6 	LEFT  JOIN T_JOIN_PLUS_4 ON T_JOIN_PLUS_4.F_INT1 = T_JOIN_PLUS_5.F_INT1
  7 	LEFT  JOIN T_JOIN_PLUS_6 ON T_JOIN_PLUS_4.F_INT1 = T_JOIN_PLUS_6.F_INT1 AND T_JOIN_PLUS_6.F_INT1 = T_JOIN_PLUS_2.F_INT1
  8 ORDER BY 1,2,3,4,5,6;

F_INT1       F_INT1       F_INT1       F_INT1       F_INT1       F_INT1      
------------ ------------ ------------ ------------ ------------ ------------
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            1            1            1           
1            1            1            2            2                        
1            1            1            2            2                        
1            1            1            2            2                        
1            1            1            2            2                        
1            1            1                         3                        
1            1            1                         3                        
1            1            1                         3                        
1            1            1                         3                        
1            1            1                         3                        
1            1            1                         3                        
1            1            1                         3                        
1            1            1                         3                        
1            1            1                                                  
1            1            1                                                  
1            1            1                                                  
1            1            1                                                  
2            2            2            1            1                        
2            2            2            1            1                        
2            2            2            2            2            2           
2            2            2                         3                        
2            2            2                         3                        
2            2            2                                                  
             3            3            1            1                        
             3            3            1            1                        
             3            3            1            1                        
             3            3            1            1                        
             3            3            1            1                        
             3            3            1            1                        
             3            3            1            1                        
             3            3            1            1                        
             3            3            2            2                        
             3            3            2            2                        
             3            3            2            2                        
             3            3            2            2                        
             3            3                         3                        
             3            3                         3                        
             3            3                         3                        
             3            3                         3                        
             3            3                         3                        
             3            3                         3                        
             3            3                         3                        
             3            3                         3                        
             3            3                                                  
             3            3                                                  
             3            3                                                  
             3            3                                                  
                                       1            1                        
                                       1            1                        
                                       2            2                        
                                                    3                        
                                                    3                        
                                                                             

68 rows fetched.

SQL> 
SQL> -- 以下用例在oracle 11gr2下会报错, 在oracle 12c下会执行成功
SQL> -- 当前zenith实现与 oracle 11gr2一致
SQL> -- 从gsql_test移植过来
SQL> 
SQL> drop table if exists gs_join_t1;

Succeed.

SQL> drop table if exists gs_join_t2;

Succeed.

SQL> drop table if exists gs_join_t3;

Succeed.

SQL> 
SQL> create table gs_join_t1  
  2 (  
  3 	f_int1			integer default 0 not null,  
  4 	f_int2			integer,  
  5 	f_int3			integer
  6 );

Succeed.

SQL> create table gs_join_t2 as select * from gs_join_t1;

Succeed.

SQL> create table gs_join_t3 as select * from gs_join_t1;

Succeed.

SQL> 
SQL> SELECT * FROM gs_join_t1 T1,gs_join_t2 T2 START WITH T1.F_INT3 = T2.F_INT3(+) CONNECT BY T1.F_INT3 = T2.F_INT3;

CT-00601, [1:66]Sql syntax error: invalid usage outer join symbol
SQL> SELECT * FROM gs_join_t1 T1,gs_join_t2 T2,gs_join_t3 T3 WHERE T2.F_INT3+T3.F_INT3 = T1.F_INT3(+);

CT-00601, [1:85]Sql syntax error: invalid usage outer join symbol
SQL> SELECT * FROM gs_join_t1 T1,gs_join_t2 T2,gs_join_t3 T3 WHERE T1.F_INT3(+) = T2.F_INT3+T3.F_INT3;

CT-00601, [1:78]Sql syntax error: not support multiple tables on one side of the operator symbol when using (+)
SQL> SELECT * FROM gs_join_t1 T1,gs_join_t2 T2,gs_join_t3 T3 WHERE T1.F_INT3 = T2.F_INT3(+)+T3.F_INT3;

CT-00601, [1:75]Sql syntax error: not support multiple tables on one side of the operator symbol when using (+)
SQL> SELECT * FROM gs_join_t1 T1,gs_join_t2 T2,gs_join_t3 T3 WHERE T1.F_INT3 = T2.F_INT3+T3.F_INT3(+);

CT-00601, [1:75]Sql syntax error: not support multiple tables on one side of the operator symbol when using (+)
SQL> 
SQL> drop table if exists gs_join_t1;

Succeed.

SQL> drop table if exists gs_join_t2;

Succeed.

SQL> drop table if exists gs_join_t3;

Succeed.

SQL> 
SQL> -- array(+)
SQL> drop table if exists join_symbol_array_t1;

Succeed.

SQL> drop table if exists join_symbol_array_t2;

Succeed.

SQL> create table join_symbol_array_t1(id int);

Succeed.

SQL> create table join_symbol_array_t2(id int[4]);

Succeed.

SQL> 
SQL> select * from join_symbol_array_t1 t1, join_symbol_array_t2 t2 where t1.id = t2.id(+);

CT-00601, [1:78]Sql syntax error: unexpected array expression
SQL> drop table join_symbol_array_t1;

Succeed.

SQL> drop table join_symbol_array_t2;
Succeed.




