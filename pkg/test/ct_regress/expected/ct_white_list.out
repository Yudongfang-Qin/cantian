

SQL> -- DTS2018112307847: white list ip check
SQL> -- CASE: VALID IPV4
SQL> alter system set TCP_INVITED_NODES = '1';

CT-00330, Invalid IP address: 1
SQL> alter system set TCP_INVITED_NODES = '1.1';

CT-00330, Invalid IP address: 1.1
SQL> alter system set TCP_INVITED_NODES = '1.1.1';

CT-00330, Invalid IP address: 1.1.1
SQL> alter system set TCP_INVITED_NODES = '1.1.1.1';

Succeed.

SQL> alter system set TCP_INVITED_NODES = '1.1.1.1 ';

Succeed.

SQL> alter system set TCP_INVITED_NODES = '   1.1.1.1   ';

Succeed.

SQL> 
SQL> alter system set TCP_INVITED_NODES = '1/1';

CT-00330, Invalid IP address: 1
SQL> alter system set TCP_INVITED_NODES = '1.1/1';

CT-00330, Invalid IP address: 1.1
SQL> alter system set TCP_INVITED_NODES = '1.1.1/1';

CT-00330, Invalid IP address: 1.1.1
SQL> alter system set TCP_INVITED_NODES = '1.1.1.1/1';

Succeed.

SQL> 
SQL> alter system set TCP_INVITED_NODES = '*.*.*.*';

Succeed.

SQL> alter system set TCP_INVITED_NODES = '1.*.*.*';

Succeed.

SQL> alter system set TCP_INVITED_NODES = '1.1.*.*';

Succeed.

SQL> alter system set TCP_INVITED_NODES = '1.1.1.*';

Succeed.

SQL> 
SQL> -- CASE: INVALID IPV4
SQL> alter system set TCP_INVITED_NODES = ' ';

CT-00330, Invalid IP address: 
SQL> alter system set TCP_INVITED_NODES = 'x';

CT-00330, Invalid IP address: invalid address "x"
SQL> alter system set TCP_INVITED_NODES = '1.x';

CT-00330, Invalid IP address: invalid address "1.x"
SQL> alter system set TCP_INVITED_NODES = '1.1 1';

CT-00330, Invalid IP address: invalid address "1.1 1"
SQL> alter system set TCP_INVITED_NODES = '1.1.1.1 1';

CT-00330, Invalid IP address: invalid address "1.1.1.1 1"
SQL> alter system set TCP_INVITED_NODES = '1.1.1.-1';

CT-00330, Invalid IP address: invalid address "1.1.1.-1"
SQL> alter system set TCP_INVITED_NODES = '1.1.1.256';

CT-00330, Invalid IP address: 1.1.1.256
SQL> alter system set TCP_INVITED_NODES = '-1.1.1.0';

CT-00330, Invalid IP address: invalid address "-1.1.1.0"
SQL> alter system set TCP_INVITED_NODES = '256.1.1.0';

CT-00330, Invalid IP address: 256.1.1.0
SQL> alter system set TCP_INVITED_NODES = '*.*.*.*/1';

CT-00330, Invalid IP address: invalid address "*.*.*.*/1"
SQL> alter system set TCP_INVITED_NODES = '1.*.*.*/1';

CT-00330, Invalid IP address: invalid address "1.*.*.*/1"
SQL> alter system set TCP_INVITED_NODES = '1.1.*.*/1';

CT-00330, Invalid IP address: invalid address "1.1.*.*/1"
SQL> alter system set TCP_INVITED_NODES = '1.1.1.*/1';

CT-00601, Sql syntax error: Convert int32 failed, text = */1
SQL> 
SQL> -- CASE: VALID IPV6
SQL> alter system set TCP_INVITED_NODES = '::';

Succeed.

SQL> alter system set TCP_INVITED_NODES = '::1';

Succeed.

SQL> alter system set TCP_INVITED_NODES = '1::1';

Succeed.

SQL> alter system set TCP_INVITED_NODES = '::/0';

Succeed.

SQL> alter system set TCP_INVITED_NODES = '::/64';

Succeed.

SQL> alter system set TCP_INVITED_NODES = '::/128';

Succeed.

SQL> alter system set TCP_INVITED_NODES = 'fe80::9217:acff:feab:fcd0';

Succeed.

SQL> alter system set TCP_INVITED_NODES = 'fe80::9217:acff:feab:fcd0%eeeeeeeeeeth0';

CT-00330, Invalid IP address: invalid local link "eeeeeeeeeeth0"
SQL> alter system set TCP_INVITED_NODES = 'fe80::9217:acff:feab:fcd0/0';

Succeed.

SQL> alter system set TCP_INVITED_NODES = 'fe80::9217:acff:feab:fcd0/64';

Succeed.

SQL> alter system set TCP_INVITED_NODES = 'fe80::9217:acff:feab:fcd0/128';

Succeed.

SQL> alter system set TCP_INVITED_NODES = '  fe80::9217:acff:feab:fcd0/128  ';

Succeed.

SQL> alter system set TCP_INVITED_NODES = '::%eeeeeeeeeeth0';

CT-00330, Invalid IP address: invalid local link "eeeeeeeeeeth0"
SQL> alter system set TCP_INVITED_NODES = '::%eeeeeeeeeeth0/21';

CT-00330, Invalid IP address: invalid local link "eeeeeeeeeeth0"
SQL> 
SQL> -- DTS2018112307847: white list ip check
SQL> -- CASE: VALID IPV4
SQL> alter system set TCP_EXCLUDED_NODES = '1';

CT-00330, Invalid IP address: 1
SQL> alter system set TCP_EXCLUDED_NODES = '1.1';

CT-00330, Invalid IP address: 1.1
SQL> alter system set TCP_EXCLUDED_NODES = '1.1.1';

CT-00330, Invalid IP address: 1.1.1
SQL> alter system set TCP_EXCLUDED_NODES = '1.1.1.1';

Succeed.

SQL> alter system set TCP_EXCLUDED_NODES = '1.1.1.1 ';

Succeed.

SQL> alter system set TCP_EXCLUDED_NODES = '   1.1.1.1   ';

Succeed.

SQL> 
SQL> alter system set TCP_EXCLUDED_NODES = '1/1';

CT-00330, Invalid IP address: 1
SQL> alter system set TCP_EXCLUDED_NODES = '1.1/1';

CT-00330, Invalid IP address: 1.1
SQL> alter system set TCP_EXCLUDED_NODES = '1.1.1/1';

CT-00330, Invalid IP address: 1.1.1
SQL> alter system set TCP_EXCLUDED_NODES = '1.1.1.1/1';

Succeed.

SQL> 
SQL> alter system set TCP_EXCLUDED_NODES = '*.*.*.*';

Succeed.

SQL> alter system set TCP_EXCLUDED_NODES = '1.*.*.*';

Succeed.

SQL> alter system set TCP_EXCLUDED_NODES = '1.1.*.*';

Succeed.

SQL> alter system set TCP_EXCLUDED_NODES = '1.1.1.*';

Succeed.

SQL> 
SQL> -- CASE: INVALID IPV4
SQL> alter system set TCP_EXCLUDED_NODES = ' ';

CT-00330, Invalid IP address: 
SQL> alter system set TCP_EXCLUDED_NODES = 'x';

CT-00330, Invalid IP address: invalid address "x"
SQL> alter system set TCP_EXCLUDED_NODES = '1.x';

CT-00330, Invalid IP address: invalid address "1.x"
SQL> alter system set TCP_EXCLUDED_NODES = '1.1 1';

CT-00330, Invalid IP address: invalid address "1.1 1"
SQL> alter system set TCP_EXCLUDED_NODES = '1.1.1.1 1';

CT-00330, Invalid IP address: invalid address "1.1.1.1 1"
SQL> alter system set TCP_EXCLUDED_NODES = '1.1.1.-1';

CT-00330, Invalid IP address: invalid address "1.1.1.-1"
SQL> alter system set TCP_EXCLUDED_NODES = '1.1.1.256';

CT-00330, Invalid IP address: 1.1.1.256
SQL> alter system set TCP_EXCLUDED_NODES = '-1.1.1.0';

CT-00330, Invalid IP address: invalid address "-1.1.1.0"
SQL> alter system set TCP_EXCLUDED_NODES = '256.1.1.0';

CT-00330, Invalid IP address: 256.1.1.0
SQL> alter system set TCP_EXCLUDED_NODES = '*.*.*.*/1';

CT-00330, Invalid IP address: invalid address "*.*.*.*/1"
SQL> alter system set TCP_EXCLUDED_NODES = '1.*.*.*/1';

CT-00330, Invalid IP address: invalid address "1.*.*.*/1"
SQL> alter system set TCP_EXCLUDED_NODES = '1.1.*.*/1';

CT-00330, Invalid IP address: invalid address "1.1.*.*/1"
SQL> alter system set TCP_EXCLUDED_NODES = '1.1.1.*/1';

CT-00601, Sql syntax error: Convert int32 failed, text = */1
SQL> 
SQL> -- CASE: VALID IPV6
SQL> alter system set TCP_EXCLUDED_NODES = '::';

Succeed.

SQL> alter system set TCP_EXCLUDED_NODES = '::1';

Succeed.

SQL> alter system set TCP_EXCLUDED_NODES = '1::1';

Succeed.

SQL> alter system set TCP_EXCLUDED_NODES = '::/0';

Succeed.

SQL> alter system set TCP_EXCLUDED_NODES = '::/64';

Succeed.

SQL> alter system set TCP_EXCLUDED_NODES = '::/128';

Succeed.

SQL> alter system set TCP_EXCLUDED_NODES = 'fe80::9217:acff:feab:fcd0';

Succeed.

SQL> alter system set TCP_EXCLUDED_NODES = 'fe80::9217:acff:feab:fcd0%eeeeeeeeeeth0';

CT-00330, Invalid IP address: invalid local link "eeeeeeeeeeth0"
SQL> alter system set TCP_EXCLUDED_NODES = 'fe80::9217:acff:feab:fcd0/0';

Succeed.

SQL> alter system set TCP_EXCLUDED_NODES = 'fe80::9217:acff:feab:fcd0/64';

Succeed.

SQL> alter system set TCP_EXCLUDED_NODES = 'fe80::9217:acff:feab:fcd0/128';

Succeed.

SQL> alter system set TCP_EXCLUDED_NODES = '  fe80::9217:acff:feab:fcd0/128  ';

Succeed.

SQL> alter system set TCP_EXCLUDED_NODES = '::%eeeeeeeeeeth0';

CT-00330, Invalid IP address: invalid local link "eeeeeeeeeeth0"
SQL> alter system set TCP_EXCLUDED_NODES = '::%eeeeeeeeeeth0/21';

CT-00330, Invalid IP address: invalid local link "eeeeeeeeeeth0"
SQL> 
SQL> -- restore
SQL> alter system set TCP_EXCLUDED_NODES = '';

Succeed.

SQL> alter system set TCP_INVITED_NODES = '';

Succeed.

SQL> 
SQL> 
SQL> -- DTS2018121504764
SQL> alter system set TCP_INVITED_NODES ='2401:7400:0000:0001:0000:0000:0000:0005,2401:7400:0000:0001:0000:0000:0000:0006,2401:7400:0000:0001:0000:0000:0000:0007,2401:7400:0000:0001:0000:0000:0000:0008,2401:7400:0000:0001:0000:0000:0000:0009,2401:7400:0000:0001:0000:0000:0000:0010,2401:7400:0000:0001:0000:0000:0000:0011,2401:7400:0000:0001:0000:0000:0000:0012,2401:7400:0000:0001:0000:0000:0000:0013,2401:7400:0000:0001:0000:0000:0000:0014,2401:7400:0000:0001:0000:0000:0000:0015,2401:7400:0000:0001:0000:0000:0000:0016,2401:7400:0000:0001:0000:0000:0000:0017,2401:7400:0000:0001:0000:0000:0000:0018,2401:7400:0000:0001:0000:0000:0000:0019,2401:7400:0000:0001:0000:0000:0000:0020,2401:7400:0000:0001:0000:0000:0000:0021,2401:7400:0000:0001:0000:0000:0000:0022,2401:7400:0000:0001:0000:0000:0000:0023,2401:7400:0000:0001:0000:0000:0000:0024,2401:7400:0000:0001:0000:0000:0000:0025,2401:7400:0000:0001:0000:0000:0000:0026,2401:7400:0000:0001:0000:0000:0000:0027,2401:7400:0000:0001:0000:0000:0000:0028,2401:7400:0000:0001:0000:0000:0000:0029,2401:7400:0000:0001:0000:0000:0000:0030';

CT-00210, The value of parameter "TCP_INVITED_NODES" is too large, at most 1023
SQL> alter system set TCP_EXCLUDED_NODES ='2401:7400:0000:0001:0000:0000:0000:0005,2401:7400:0000:0001:0000:0000:0000:0006,2401:7400:0000:0001:0000:0000:0000:0007,2401:7400:0000:0001:0000:0000:0000:0008,2401:7400:0000:0001:0000:0000:0000:0009,2401:7400:0000:0001:0000:0000:0000:0010,2401:7400:0000:0001:0000:0000:0000:0011,2401:7400:0000:0001:0000:0000:0000:0012,2401:7400:0000:0001:0000:0000:0000:0013,2401:7400:0000:0001:0000:0000:0000:0014,2401:7400:0000:0001:0000:0000:0000:0015,2401:7400:0000:0001:0000:0000:0000:0016,2401:7400:0000:0001:0000:0000:0000:0017,2401:7400:0000:0001:0000:0000:0000:0018,2401:7400:0000:0001:0000:0000:0000:0019,2401:7400:0000:0001:0000:0000:0000:0020,2401:7400:0000:0001:0000:0000:0000:0021,2401:7400:0000:0001:0000:0000:0000:0022,2401:7400:0000:0001:0000:0000:0000:0023,2401:7400:0000:0001:0000:0000:0000:0024,2401:7400:0000:0001:0000:0000:0000:0025,2401:7400:0000:0001:0000:0000:0000:0026,2401:7400:0000:0001:0000:0000:0000:0027,2401:7400:0000:0001:0000:0000:0000:0028,2401:7400:0000:0001:0000:0000:0000:0029,2401:7400:0000:0001:0000:0000:0000:0030';

CT-00210, The value of parameter "TCP_EXCLUDED_NODES" is too large, at most 1023
SQL> 
SQL> alter system set TCP_INVITED_NODES = 300;

CT-00330, Invalid IP address: 300
SQL> alter system set TCP_EXCLUDED_NODES = '(300)';

CT-00330, Invalid IP address: 300
SQL> 
SQL> 


