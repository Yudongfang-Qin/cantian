
SQL> alter system set delay_cleanout = true;

Succeed.

SQL> drop table if exists delay_clean_test_table;

Succeed.

SQL> create table delay_clean_test_table(c_id int , c_char varchar2(8000), c_char1 varchar2(8000),c_char2 varchar2(8000), c_char3 varchar2(8000));

Succeed.

SQL> declare
  2 i integer;
  3 varchar2_str varchar(8000);
  4 sql_str varchar(9000);
  5 begin
  6 varchar2_str := lpad(' ', 7000, 'a');
  7 sql_str := 'insert into delay_clean_test_table values(2,'''||varchar2_str||''', null, null, null)';
  8 for i in 1 .. 16000 loop
  9 execute immediate sql_str;
 10 end loop;
 11 commit;
 12 end;
 13 /

PL/SQL procedure successfully completed.

SQL> commit;

Succeed.

SQL> SELECT * FROM DBA_SEGMENTS WHERE SEGMENT_TYPE='TABLE' AND SEGMENT_NAME ='DELAY_CLEAN_TEST_TABLE';

OWNER                                                            SEGMENT_NAME                                                     PARTITION_NAME                                                   SEGMENT_TYPE TABLESPACE_NAME                                                  BYTES                PAGES                EXTENTS
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ------------ ---------------------------------------------------------------- -------------------- -------------------- --------------------
SYS                                                              DELAY_CLEAN_TEST_TABLE                                                                                                            TABLE        SYSTEM                                                           131268608            16024                2003

1 rows fetched.

SQL> delete from delay_clean_test_table;

16000 rows affected.

SQL> commit;

Succeed.

SQL> SELECT * FROM DBA_SEGMENTS WHERE SEGMENT_TYPE='TABLE' AND SEGMENT_NAME ='DELAY_CLEAN_TEST_TABLE';

OWNER                                                            SEGMENT_NAME                                                     PARTITION_NAME                                                   SEGMENT_TYPE TABLESPACE_NAME                                                  BYTES                PAGES                EXTENTS
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ------------ ---------------------------------------------------------------- -------------------- -------------------- --------------------
SYS                                                              DELAY_CLEAN_TEST_TABLE                                                                                                            TABLE        SYSTEM                                                           131268608            16024                2003

1 rows fetched.

SQL> declare
  2 i integer;
  3 varchar2_str varchar(8000);
  4 sql_str varchar(9000);
  5 begin
  6 varchar2_str := lpad(' ', 7000, 'a');
  7 sql_str := 'insert into delay_clean_test_table values(2,'''||varchar2_str||''', null, null, null)';
  8 for i in 1 .. 8000 loop
  9 execute immediate sql_str;
 10 end loop;
 11 commit;
 12 end;
 13 /

PL/SQL procedure successfully completed.

SQL> commit;

Succeed.

SQL> SELECT * FROM DBA_SEGMENTS WHERE SEGMENT_TYPE='TABLE' AND SEGMENT_NAME ='DELAY_CLEAN_TEST_TABLE';

OWNER                                                            SEGMENT_NAME                                                     PARTITION_NAME                                                   SEGMENT_TYPE TABLESPACE_NAME                                                  BYTES                PAGES                EXTENTS
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ------------ ---------------------------------------------------------------- -------------------- -------------------- --------------------
SYS                                                              DELAY_CLEAN_TEST_TABLE                                                                                                            TABLE        SYSTEM                                                           131268608            16024                2003                

1 rows fetched.

SQL> alter system set delay_cleanout = false;

Succeed.

SQL> delete from delay_clean_test_table;

8000 rows affected.

SQL> SELECT * FROM DBA_SEGMENTS WHERE SEGMENT_TYPE='TABLE' AND SEGMENT_NAME ='DELAY_CLEAN_TEST_TABLE';

OWNER                                                            SEGMENT_NAME                                                     PARTITION_NAME                                                   SEGMENT_TYPE TABLESPACE_NAME                                                  BYTES                PAGES                EXTENTS
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ------------ ---------------------------------------------------------------- -------------------- -------------------- --------------------
SYS                                                              DELAY_CLEAN_TEST_TABLE                                                                                                            TABLE        SYSTEM                                                           131268608            16024                2003                

1 rows fetched.

SQL> declare
  2 i integer;
  3 varchar2_str varchar(8000);
  4 sql_str varchar(9000);
  5 begin
  6 varchar2_str := lpad(' ', 7000, 'a');
  7 sql_str := 'insert into delay_clean_test_table values(2,'''||varchar2_str||''', null, null, null)';
  8 for i in 1 .. 8000 loop
  9 execute immediate sql_str;
 10 end loop;
 11 commit;
 12 end;
 13 /

PL/SQL procedure successfully completed.

SQL> commit;

Succeed.

SQL> SELECT * FROM DBA_SEGMENTS WHERE SEGMENT_TYPE='TABLE' AND SEGMENT_NAME ='DELAY_CLEAN_TEST_TABLE';

OWNER                                                            SEGMENT_NAME                                                     PARTITION_NAME                                                   SEGMENT_TYPE TABLESPACE_NAME                                                  BYTES                PAGES                EXTENTS
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ------------ ---------------------------------------------------------------- -------------------- -------------------- --------------------
SYS                                                              DELAY_CLEAN_TEST_TABLE                                                                                                            TABLE        SYSTEM                                                           131268608            16024                2003                

1 rows fetched.

SQL> declare
  2 i integer;
  3 varchar2_str varchar(8000);
  4 sql_str varchar(9000);
  5 begin
  6 varchar2_str := lpad(' ', 7000, 'a');
  7 sql_str := 'insert into delay_clean_test_table values(2,'''||varchar2_str||''', null, null, null)';
  8 for i in 1 .. 8000 loop
  9 execute immediate sql_str;
 10 end loop;
 11 commit;
 12 end;
 13 /

PL/SQL procedure successfully completed.

SQL> commit;

Succeed.

SQL> SELECT * FROM DBA_SEGMENTS WHERE SEGMENT_TYPE='TABLE' AND SEGMENT_NAME ='DELAY_CLEAN_TEST_TABLE';

OWNER                                                            SEGMENT_NAME                                                     PARTITION_NAME                                                   SEGMENT_TYPE TABLESPACE_NAME                                                  BYTES                PAGES                EXTENTS
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ------------ ---------------------------------------------------------------- -------------------- -------------------- --------------------
SYS                                                              DELAY_CLEAN_TEST_TABLE                                                                                                            TABLE        SYSTEM                                                           131268608            16024                2003                

1 rows fetched.

SQL> declare
  2 i integer;
  3 varchar2_str varchar(8000);
  4 sql_str varchar(9000);
  5 begin
  6 varchar2_str := lpad(' ', 7000, 'a');
  7 sql_str := 'insert into delay_clean_test_table values(2,'''||varchar2_str||''', null, null, null)';
  8 for i in 1 .. 8000 loop
  9 execute immediate sql_str;
 10 end loop;
 11 commit;
 12 end;
 13 /

PL/SQL procedure successfully completed.

SQL> commit;

Succeed.

SQL> SELECT * FROM DBA_SEGMENTS WHERE SEGMENT_TYPE='TABLE' AND SEGMENT_NAME ='DELAY_CLEAN_TEST_TABLE';

OWNER                                                            SEGMENT_NAME                                                     PARTITION_NAME                                                   SEGMENT_TYPE TABLESPACE_NAME                                                  BYTES                PAGES                EXTENTS
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ------------ ---------------------------------------------------------------- -------------------- -------------------- --------------------
SYS                                                              DELAY_CLEAN_TEST_TABLE                                                                                                            TABLE        SYSTEM                                                           196870144            24032                3004

1 rows fetched.

SQL> drop table if exists delay_clean_test_table;

Succeed.

SQL> alter system set delay_cleanout = true;
Succeed.
