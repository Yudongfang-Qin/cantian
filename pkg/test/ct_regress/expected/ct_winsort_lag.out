

SQL> alter system set cbo = on;

Succeed.

SQL> drop table if exists t_aggr_lag_1;

Succeed.

SQL> create table t_aggr_lag_1(f0 int, f1 bigint, f2 double, f3 number(20,10), f4 date, f5 timestamp, f6 char(100), f7 varchar(100), f8 binary(100), f9 clob, f10 blob);

Succeed.

SQL> 
SQL> insert into t_aggr_lag_1(f0) values(10);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(10);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(5);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(5);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(20);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(20);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(15);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(15);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(15);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(5);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(10);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(20);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(null);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(null);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(null);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(1);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(1);

1 rows affected.

SQL> insert into t_aggr_lag_1(f0) values(1);

1 rows affected.

SQL> insert into t_aggr_lag_1(f1) values(2147483648);

1 rows affected.

SQL> insert into t_aggr_lag_1(f1) values(null);

1 rows affected.

SQL> insert into t_aggr_lag_1(f1) values(2147483650);

1 rows affected.

SQL> insert into t_aggr_lag_1(f2) values(null);

1 rows affected.

SQL> insert into t_aggr_lag_1(f3) values(null);

1 rows affected.

SQL> insert into t_aggr_lag_1(f4) values('2018-02-23 13:18:23');

1 rows affected.

SQL> insert into t_aggr_lag_1(f4) values(null);

1 rows affected.

SQL> insert into t_aggr_lag_1(f4) values('2018-02-23 13:18:25');

1 rows affected.

SQL> insert into t_aggr_lag_1(f4) values('2018-02-23 13:18:24');

1 rows affected.

SQL> insert into t_aggr_lag_1(f5) values('2018-02-23 13:18:23.345');

1 rows affected.

SQL> insert into t_aggr_lag_1(f5) values(null);

1 rows affected.

SQL> insert into t_aggr_lag_1(f5) values('2018-02-23 13:18:23.347');

1 rows affected.

SQL> insert into t_aggr_lag_1(f5) values('2018-02-23 13:18:23.346');

1 rows affected.

SQL> insert into t_aggr_lag_1(f6) values(null);

1 rows affected.

SQL> insert into t_aggr_lag_1(f6) values('a');

1 rows affected.

SQL> insert into t_aggr_lag_1(f6) values('a');

1 rows affected.

SQL> insert into t_aggr_lag_1(f6) values('b');

1 rows affected.

SQL> insert into t_aggr_lag_1(f6) values('b');

1 rows affected.

SQL> insert into t_aggr_lag_1(f6) values('c');

1 rows affected.

SQL> insert into t_aggr_lag_1(f6) values('c');

1 rows affected.

SQL> insert into t_aggr_lag_1(f6) values('aaaaa');

1 rows affected.

SQL> insert into t_aggr_lag_1(f6) values('bbbbb');

1 rows affected.

SQL> insert into t_aggr_lag_1(f6) values('ccccc');

1 rows affected.

SQL> insert into t_aggr_lag_1(f7) values('2018-02-23 13:18:23.345');

1 rows affected.

SQL> insert into t_aggr_lag_1(f7) values(null);

1 rows affected.

SQL> insert into t_aggr_lag_1(f7) values('2018-02-23 13:18:23.347');

1 rows affected.

SQL> insert into t_aggr_lag_1(f7) values('2018-02-23 13:18:23.346');

1 rows affected.

SQL> insert into t_aggr_lag_1(f8, f9, f10) values('1D', '222', '3133');

1 rows affected.

SQL> insert into t_aggr_lag_1(f8, f9, f10) values('1F', '222', '3323');

1 rows affected.

SQL> insert into t_aggr_lag_1(f8, f9, f10) values('1E', '222', '3333');

1 rows affected.

SQL> commit;

Succeed.

SQL> 
SQL> 
SQL> select  lag(f0,-1,0) over(order by f0) from t_aggr_lag_1;

CT-00242, The function argument is out of range
SQL> select  lag(f0,0,0) over (order by f0) from t_aggr_lag_1;

LAG(F0,0,0) OVER (ORDER BY F0)
------------------------------
1                             
1                             
1                             
5                             
5                             
5                             
10                            
10                            
10                            
15                            
15                            
15                            
20                            
20                            
20                            
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              

48 rows fetched.

SQL> select  lag(f0,1,0) over (order by f0) from t_aggr_lag_1;

LAG(F0,1,0) OVER (ORDER BY F0)
------------------------------
0                             
1                             
1                             
1                             
5                             
5                             
5                             
10                            
10                            
10                            
15                            
15                            
15                            
20                            
20                            
20                            
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              

48 rows fetched.

SQL> select  lag(f0,2,0) over (order by f0) from t_aggr_lag_1;

LAG(F0,2,0) OVER (ORDER BY F0)
------------------------------
0                             
0                             
1                             
1                             
1                             
5                             
5                             
5                             
10                            
10                            
10                            
15                            
15                            
15                            
20                            
20                            
20                            
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              

48 rows fetched.

SQL> select  lag(f0,3,0) over (order by f0) from t_aggr_lag_1;

LAG(F0,3,0) OVER (ORDER BY F0)
------------------------------
0                             
0                             
0                             
1                             
1                             
1                             
5                             
5                             
5                             
10                            
10                            
10                            
15                            
15                            
15                            
20                            
20                            
20                            
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              

48 rows fetched.

SQL> select  lag(f0,30,0) over (order by f0) from t_aggr_lag_1;

LAG(F0,30,0) OVER (ORDER BY F0)
-------------------------------
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
0                              
1                              
1                              
1                              
5                              
5                              
5                              
10                             
10                             
10                             
15                             
15                             
15                             
20                             
20                             
20                             
                               
                               
                               

48 rows fetched.

SQL> select  lag(f0,30,'#') over (order by f0) from t_aggr_lag_1;

CT-00636, [1:24]Invalid number -- unexpected character
SQL> select  cume_dist() over(order by f0)||lag(f0,30,'#') over (order by f0) from t_aggr_lag_1;

CT-00636, [1:38]Invalid number -- unexpected character
SQL> select  lag(f0,30) over (order by f0) from t_aggr_lag_1;

LAG(F0,30) OVER (ORDER BY F0)
-----------------------------
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
1                            
1                            
1                            
5                            
5                            
5                            
10                           
10                           
10                           
15                           
15                           
15                           
20                           
20                           
20                           
                             
                             
                             

48 rows fetched.

SQL> select  lag(f0,30,NULL) over (order by f0) from t_aggr_lag_1;

LAG(F0,30,NULL) OVER (ORDER BY F0)
----------------------------------
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
1                                 
1                                 
1                                 
5                                 
5                                 
5                                 
10                                
10                                
10                                
15                                
15                                
15                                
20                                
20                                
20                                
                                  
                                  
                                  

48 rows fetched.

SQL> select  lag(f6,1,'default') over (order by f6) from t_aggr_lag_1;

LAG(F6,1,'DEFAULT') OVER (ORDER BY F6)                          
----------------------------------------------------------------
default                                                         
a                                                                                                   
a                                                                                                   
aaaaa                                                                                               
b                                                                                                   
b                                                                                                   
bbbbb                                                                                               
c                                                                                                   
c                                                                                                   
ccccc                                                                                               
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                

48 rows fetched.

SQL> select  lag(f6,2,'default') over (order by f6) from t_aggr_lag_1;

LAG(F6,2,'DEFAULT') OVER (ORDER BY F6)                          
----------------------------------------------------------------
default                                                         
default                                                         
a                                                                                                   
a                                                                                                   
aaaaa                                                                                               
b                                                                                                   
b                                                                                                   
bbbbb                                                                                               
c                                                                                                   
c                                                                                                   
ccccc                                                                                               
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                

48 rows fetched.

SQL> select  lag(f6,3,'default') over (order by f6) from t_aggr_lag_1;

LAG(F6,3,'DEFAULT') OVER (ORDER BY F6)                          
----------------------------------------------------------------
default                                                         
default                                                         
default                                                         
a                                                                                                   
a                                                                                                   
aaaaa                                                                                               
b                                                                                                   
b                                                                                                   
bbbbb                                                                                               
c                                                                                                   
c                                                                                                   
ccccc                                                                                               
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                

48 rows fetched.

SQL> select  lag(f6,5,'default') over (order by f0) from t_aggr_lag_1;

LAG(F6,5,'DEFAULT') OVER (ORDER BY F0)                          
----------------------------------------------------------------
default                                                         
default                                                         
default                                                         
default                                                         
default                                                         
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
a                                                                                                   
a                                                                                                   
b                                                                                                   
b                                                                                                   
c                                                                                                   
c                                                                                                   
aaaaa                                                                                               
bbbbb                                                                                               
ccccc                                                                                               
                                                                
                                                                

48 rows fetched.

SQL> select  lag(f6,6,'default') over (order by f6) from t_aggr_lag_1 order by f0, 1;

LAG(F6,6,'DEFAULT') OVER (ORDER BY F6)                          
----------------------------------------------------------------
b                                                                                                   
                                                                
                                                                
                                                                
                                                                
                                                                
b                                                                                                   
                                                                
                                                                
                                                                
                                                                
                                                                
bbbbb                                                                                               
                                                                
                                                                
a                                                                                                   
a                                                                                                   
aaaaa                                                                                               
c                                                                                                   
c                                                                                                   
ccccc                                                                                               
default                                                         
default                                                         
default                                                         
default                                                         
default                                                         
default                                                         
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                

48 rows fetched.

SQL> select  lag(f6,6, 0) over (order by f6) from t_aggr_lag_1 order by f6;

LAG(F6,6, 0) OVER (ORDER BY F6)                                 
----------------------------------------------------------------
0                                                               
0                                                               
0                                                               
0                                                               
0                                                               
0                                                               
a                                                                                                   
a                                                                                                   
aaaaa                                                                                               
b                                                                                                   
b                                                                                                   
bbbbb                                                                                               
c                                                                                                   
c                                                                                                   
ccccc                                                                                               
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                

48 rows fetched.

SQL> select  lag(f6,null,'default') over (order by f6) from t_aggr_lag_1 order by f0;

CT-00636, Invalid number -- not supprort the offset expr type
SQL> select  lag(f6,'default') over (order by f6) from t_aggr_lag_1 order by f0;

CT-00636, Invalid number -- unexpected character
SQL> select  lag(null,1) over (order by f6) from t_aggr_lag_1 order by f0;

LAG(NULL,1) OVER (ORDER BY F6)
------------------------------
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              
                              

48 rows fetched.

SQL> select  lag(null,null) over (order by f6) from t_aggr_lag_1 order by f0;

CT-00636, Invalid number -- not supprort the offset expr type
SQL> select f0, f6 , lag(f0,2,0) over(order by f0), lag(f6,3,'default') over (order by f0) from t_aggr_lag_1;

F0           F6                                                               LAG(F0,2,0) OVER(ORDER BY F0) LAG(F6,3,'DEFAULT') OVER (ORDER BY F0)                          
------------ ---------------------------------------------------------------- ----------------------------- ----------------------------------------------------------------
1                                                                             0                             default                                                         
1                                                                             0                             default                                                         
1                                                                             1                             default                                                         
5                                                                             1                                                                                             
5                                                                             1                                                                                             
5                                                                             5                                                                                             
10                                                                            5                                                                                             
10                                                                            5                                                                                             
10                                                                            10                                                                                            
15                                                                            10                                                                                            
15                                                                            10                                                                                            
15                                                                            15                                                                                            
20                                                                            15                                                                                            
20                                                                            15                                                                                            
20                                                                            20                                                                                            
                                                                              20                                                                                            
                                                                              20                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
             a                                                                                                                                                                                                  
             a                                                                                                                                                                                                  
             b                                                                                                                                                                                                  
             b                                                                                                                                  a                                                                                                   
             c                                                                                                                                  a                                                                                                   
             c                                                                                                                                  b                                                                                                   
             aaaaa                                                                                                                              b                                                                                                   
             bbbbb                                                                                                                              c                                                                                                   
             ccccc                                                                                                                              c                                                                                                   
                                                                                                            aaaaa                                                                                               
                                                                                                            bbbbb                                                                                               
                                                                                                            ccccc                                                                                               
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            

48 rows fetched.

SQL> select f0, f6 , lag(f0,2,0) over(order by f0), lag(f6,3,'default') over (order by f0) from t_aggr_lag_1;

F0           F6                                                               LAG(F0,2,0) OVER(ORDER BY F0) LAG(F6,3,'DEFAULT') OVER (ORDER BY F0)                          
------------ ---------------------------------------------------------------- ----------------------------- ----------------------------------------------------------------
1                                                                             0                             default                                                         
1                                                                             0                             default                                                         
1                                                                             1                             default                                                         
5                                                                             1                                                                                             
5                                                                             1                                                                                             
5                                                                             5                                                                                             
10                                                                            5                                                                                             
10                                                                            5                                                                                             
10                                                                            10                                                                                            
15                                                                            10                                                                                            
15                                                                            10                                                                                            
15                                                                            15                                                                                            
20                                                                            15                                                                                            
20                                                                            15                                                                                            
20                                                                            20                                                                                            
                                                                              20                                                                                            
                                                                              20                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
             a                                                                                                                                                                                                  
             a                                                                                                                                                                                                  
             b                                                                                                                                                                                                  
             b                                                                                                                                  a                                                                                                   
             c                                                                                                                                  a                                                                                                   
             c                                                                                                                                  b                                                                                                   
             aaaaa                                                                                                                              b                                                                                                   
             bbbbb                                                                                                                              c                                                                                                   
             ccccc                                                                                                                              c                                                                                                   
                                                                                                            aaaaa                                                                                               
                                                                                                            bbbbb                                                                                               
                                                                                                            ccccc                                                                                               
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            
                                                                                                                                                                            

48 rows fetched.

SQL> select f0, f6 , lag(f5,1,f5) over(order by f0), lag(f7, 2, f7) over (order by f0) from t_aggr_lag_1;

F0           F6                                                               LAG(F5,1,F5) OVER(ORDER BY F0)   LAG(F7, 2, F7) OVER (ORDER BY F0)                               
------------ ---------------------------------------------------------------- -------------------------------- ----------------------------------------------------------------
1                                                                                                                                                                              
1                                                                                                                                                                              
1                                                                                                                                                                              
5                                                                                                                                                                              
5                                                                                                                                                                              
5                                                                                                                                                                              
10                                                                                                                                                                             
10                                                                                                                                                                             
10                                                                                                                                                                             
15                                                                                                                                                                             
15                                                                                                                                                                             
15                                                                                                                                                                             
20                                                                                                                                                                             
20                                                                                                                                                                             
20                                                                                                                                                                             
                                                                                                                                                                               
                                                                                                                                                                               
                                                                                                                                                                               
                                                                                                                                                                               
                                                                                                                                                                               
                                                                                                                                                                               
                                                                                                                                                                               
                                                                                                                                                                               
                                                                                                                                                                               
                                                                                                                                                                               
                                                                                                                                                                               
                                                                                                                                                                               
                                                                                                                                                                               
                                                                              2018-02-23 13:18:23.345000                                                                       
                                                                                                                                                                               
                                                                              2018-02-23 13:18:23.347000                                                                       
                                                                              2018-02-23 13:18:23.346000                                                                       
             a                                                                                                                                                                                                     
             a                                                                                                                                                                                                     
             b                                                                                                                                                                                                     
             b                                                                                                                                                                                                     
             c                                                                                                                                                                                                     
             c                                                                                                                                                                                                     
             aaaaa                                                                                                                                                                                                 
             bbbbb                                                                                                                                                                                                 
             ccccc                                                                                                                                                                                                 
                                                                                                                                                                               
                                                                                                                                                                               
                                                                                                               2018-02-23 13:18:23.345                                         
                                                                                                                                                                               
                                                                                                               2018-02-23 13:18:23.347                                         
                                                                                                               2018-02-23 13:18:23.346                                         
                                                                                                                                                                               

48 rows fetched.

SQL> 
SQL> update (select f0,f1,f2,f3 from t_aggr_lag_1) t set f0=2 where f0=10;

CT-00130, Operation update is not supported on view, func, join table, json table, subqueries or system table
SQL> 
SQL> drop table if exists test_lag_func_001;

Succeed.

SQL> create table test_lag_func_001( 
  2 COL_1 bigint, 
  3 COL_2 TIMESTAMP WITHOUT TIME ZONE, 
  4 COL_3 bool,
  5 COL_4 decimal,
  6 COL_5 text,
  7 COL_6 smallint,
  8 COL_7 char(30),
  9 COL_8 double precision,
 10 COL_9 longtext,
 11 COL_10 character varying(30),
 12 COL_11 bool ,
 13 COL_12 bytea ,
 14 COL_13 real ,
 15 COL_14 numeric ,
 16 COL_15 blob ,
 17 COL_16 integer ,
 18 COL_17 int ,
 19 COL_18 TIMESTAMP WITH TIME ZONE ,
 20 COL_19 binary_integer ,
 21 COL_20 interval day to second ,
 22 COL_21 boolean, 
 23 COL_22 nchar(30),
 24 COL_23 binary_bigint,
 25 COL_24 nchar(100),
 26 COL_25 character(1000), 
 27 COL_26 text,
 28 COL_27 float,
 29 COL_28 double,
 30 COL_29 bigint,
 31 COL_30 TIMESTAMP WITH LOCAL TIME ZONE ,
 32 COL_31 TIMESTAMP,
 33 COL_32 image,
 34 COL_33 interval year to month,
 35 COL_34 character(30),
 36 COL_35 smallint,
 37 COL_36 blob,
 38 COL_37 char(300),
 39 COL_38 float,
 40 COL_39 raw(100),
 41 COL_40 clob ,
 42 COL_41 binary_double,
 43 COL_42 number(6,2),
 44 COL_43 decimal(6,2),
 45 COL_44 varchar2(50),
 46 COL_45 varchar(30),
 47 COL_46 nvarchar2(100),
 48 COL_47 numeric(12,6),
 49 COL_48 nvarchar(30),
 50 COL_49 date,
 51 COL_50 image ,
 52 COL_51 integer,
 53 COL_52 binary_double,
 54 COL_53 decimal(12,6),
 55 COL_54 raw(8000),
 56 COL_55 clob,
 57 COL_56 varchar2(8000),
 58 COL_57 datetime,
 59 COL_58 number(12,6),
 60 COL_59 nvarchar2(4000),
 61 COL_60 varbinary(2000) ,
 62 COL_61 binary(200),
 63 COL_62 datetime,
 64 COL_63 binary(100),
 65 COL_64 varchar(1000),
 66 COL_65 date,
 67 constraint pk_lag_fun_id primary key(COL_1)
 68 );

Succeed.

SQL> 
SQL> drop sequence if exists V_lag_func_seq;

Succeed.

SQL> create sequence V_lag_func_seq increment by 1 start with 100000;

Succeed.

SQL> 
SQL> begin
  2 	for i in 1..9000 loop
  3       insert into test_lag_func_001 values(
  4 	  V_lag_func_seq.nextval,
  5 	  TIMESTAMPADD(HOUR,i,'2019-01-03 14:14:12'),
  6 	  true,
  7 	  3.1415926+V_lag_func_seq.nextval,
  8 	  'abc',
  9 	  i,
 10 	  'abc',
 11 	  i+1.456789445455,
 12 	  'abc',
 13 	  'abc',
 14 	  false,
 15 	  '10',
 16 	  3.1415926+V_lag_func_seq.nextval,
 17 	  i/4,
 18 	  '10',
 19 	  i,
 20 	  i,
 21 	  TIMESTAMPADD(DAY,i,'2019-01-03 14:14:12'),
 22 	  '1',
 23 	  (INTERVAL '4 5:12:10.222' DAY TO SECOND(3)),
 24 	  0,
 25 	  'abc',
 26 	  V_lag_func_seq.nextval,
 27 	  'abc',
 28 	  'abc',
 29 	  'abc',
 30 	  i/4,
 31 	  V_lag_func_seq.nextval-99,
 32 	  i*3.1415,
 33 	  TIMESTAMPADD(MINUTE,i,'2019-01-03 14:14:12'),
 34 	  to_timestamp('2019-01-03 14:58:54.000000','YYYY-MM-DD HH24:MI:SS.FFFFFF'),
 35 	  'abc',
 36 	  (INTERVAL '12' YEAR),
 37 	  'abc',
 38 	  i,
 39 	  '10',
 40 	  'abc',
 41 	  i/2.15,
 42 	  '0F',
 43 	  'abc',
 44 	  1.0E+100,
 45 	  3.14+i,
 46 	  i+445.255,
 47 	  'abc',
 48 	  'abc',
 49 	  'abc',
 50 	  125563.141592,
 51 	  'abc',
 52 	  TIMESTAMPADD(DAY,i,'2019-01-03 14:14:12'),
 53 	  'abc',
 54 	  V_lag_func_seq.nextval+2,
 55 	  -1.79E+100,
 56 	  98*0.99,
 57 	  '10',
 58 	  'abc',
 59 	  'abc',
 60 	  TIMESTAMPADD(SECOND,i,'2019-01-03 14:14:12'),
 61 	  25563.1415,
 62 	  'abc',
 63 	  '10',
 64 	  '10',
 65 	  TIMESTAMPADD(MONTH,i/100,'2019-01-03 14:14:12'),
 66 	  '010101111111100000000000000',
 67 	  'abc',
 68 	  TIMESTAMPADD(SECOND,i,'2019-01-03 15:19:00')
 69 	  );
 70       commit;
 71     end loop;
 72 end;
 73 /

PL/SQL procedure successfully completed.

SQL> 
SQL> select COL_17,COL_63,lag(COL_63,8600,'1010101111111111111111111111111111111111111111') over (order by COL_17) from test_lag_func_001 order by COL_17,COL_63 limit 1 offset 8500;

COL_17       COL_63                                                           LAG(COL_63,8600,'1010101111111111111111111111111111111111111111'
------------ ---------------------------------------------------------------- ----------------------------------------------------------------
8501         010101111111100000000000000                                      1010101111111111111111111111111111111111111111                  

1 rows fetched.

SQL> alter system set cbo = off;

Succeed.

SQL> drop table t_aggr_lag_1;

Succeed.

SQL> drop sequence V_lag_func_seq;

Succeed.

SQL> drop table test_lag_func_001;

Succeed.

SQL> 
SQL> drop table if exists lead_t1;

Succeed.

SQL> create table lead_t1(a varchar(90), b int, c varchar(20) not null);

Succeed.

SQL> insert into lead_t1 values(1,11,'a1');

1 rows affected.

SQL> insert into lead_t1 values(2,12,'a4');

1 rows affected.

SQL> insert into lead_t1 values(3,13,'a7');

1 rows affected.

SQL> insert into lead_t1 values(null,14,'a10');

1 rows affected.

SQL> commit;

Succeed.

SQL>
SQL> select a, b, lead(c,1,current_timestamp) over (order by a asc)  as "LEAD_LAG" from lead_t1 order by a asc, b desc;

CT-00601, [1:42]Sql syntax error: the length of default value as string is larger
SQL> select a, b, lead(c,1,a) over (order by a asc)  as "LEAD_LAG" from lead_t1 order by a asc, b desc;

CT-00601, [1:26]Sql syntax error: the length of default value as string is larger
SQL> select a, b, lead(c,1,'dsdddddddddddddddddddddd') over (order by a asc)  as "LEAD_LAG" from lead_t1 order by a asc, b desc;

CT-00601, [1:51]Sql syntax error: the length of default value as string is larger
SQL> select a, b, lead(c,case when a >0 then 1 else 2 end,null) over (order by a asc)  as "LEAD_LAG" from lead_t1 order by a asc, b desc;

CT-00636, Invalid number -- not supprort the offset expr type
SQL> select a, b, NVL(lead(c,1) over (order by a asc),0)  as "LEAD_LAG" from lead_t1 order by a asc, b desc;

A                                                                B            LEAD_LAG            
---------------------------------------------------------------- ------------ --------------------
1                                                                11           a4                  
2                                                                12           a7                  
3                                                                13           a10                   
                                                                 14           0                  

4 rows fetched.

SQL> drop table if exists lead_t1;

Succeed.

SQL> 
SQL> --default_expr_len DTS202107190G5W8AP1300
SQL> DROP TABLE if exists T_LEAD_OVER_DATA;

Succeed.

SQL> CREATE TABLE T_LEAD_OVER_DATA(
  2         ID INT,
  3         NAME VARCHAR(20),
  4         DEPT VARCHAR(20),
  5         LEADER_ID INT,
  6         SALARY INT,
  7         CREATE_DATE DATE,
  8         work_num decimal(10,2)
  9 );

Succeed.

SQL> INSERT INTO T_LEAD_OVER_DATA VALUES (1,'AA4',5,999,1851,to_date('2019-10-15 10:18:12','YYYY-MM-DD HH24:mi:ss'),8346.96556923);

1 rows affected.

SQL> INSERT INTO T_LEAD_OVER_DATA VALUES (2,'AA6',6,333,3973,to_date('2007-08-11 10:18:12','YYYY-MM-DD HH24:mi:ss'),7790.93363579);

1 rows affected.

SQL> INSERT INTO T_LEAD_OVER_DATA VALUES (3,'AA9',8,777,0,to_date('2007-08-11 10:18:12','YYYY-MM-DD HH24:mi:ss'),NULL);

1 rows affected.

SQL> INSERT INTO T_LEAD_OVER_DATA VALUES (4,'AA9',5,888,NULL,to_date('2015-11-11 10:18:12','YYYY-MM-DD HH24:mi:ss'),0);

1 rows affected.

SQL> INSERT INTO T_LEAD_OVER_DATA VALUES (5,'AA8',9,555,NULL,to_date('2006-09-15 10:18:12','YYYY-MM-DD HH24:mi:ss'),8586.13426323);

1 rows affected.

SQL> INSERT INTO T_LEAD_OVER_DATA VALUES (6,'AA9',3,111,7771,to_date('2019-10-15 10:18:12','YYYY-MM-DD HH24:mi:ss'),4781.87355446);

1 rows affected.

SQL> INSERT INTO T_LEAD_OVER_DATA VALUES (7,'AA7',1,777,NULL,to_date('2018-05-15 10:18:12','YYYY-MM-DD HH24:mi:ss'),NULL);

1 rows affected.

SQL> INSERT INTO T_LEAD_OVER_DATA VALUES (8,'AA10',7,888,2308,to_date('2015-11-11 10:18:12','YYYY-MM-DD HH24:mi:ss'),NULL);

1 rows affected.

SQL> INSERT INTO T_LEAD_OVER_DATA VALUES (9,'AA1',3,555,0,to_date('2007-08-11 10:18:12','YYYY-MM-DD HH24:mi:ss'),NULL);

1 rows affected.

SQL> INSERT INTO T_LEAD_OVER_DATA VALUES (10,'AA9',10,444,3611,NULL,NULL);

1 rows affected.

SQL> INSERT INTO T_LEAD_OVER_DATA VALUES (11,'AA4',8,333,0,to_date('2015-11-25 10:18:12','YYYY-MM-DD HH24:mi:ss'),3197.3310937);

1 rows affected.

SQL> INSERT INTO T_LEAD_OVER_DATA VALUES (12,'AA7',5,333,NULL,to_date('2007-08-11 10:18:12','YYYY-MM-DD HH24:mi:ss'),4714.66120179);

1 rows affected.

SQL> INSERT INTO T_LEAD_OVER_DATA VALUES (13,'AA9',4,333,7756,to_date('2007-08-11 10:18:12','YYYY-MM-DD HH24:mi:ss'),8819.58623779);

1 rows affected.

SQL> INSERT INTO T_LEAD_OVER_DATA VALUES (14,'AA2',8,777,6923,to_date('2016-10-25 10:18:12','YYYY-MM-DD HH24:mi:ss'),2938.55854802);

1 rows affected.

SQL> INSERT INTO T_LEAD_OVER_DATA VALUES (15,'AA10',9,111,8047,to_date('2015-11-11 10:18:12','YYYY-MM-DD HH24:mi:ss'),5032.75518094);

1 rows affected.

SQL> INSERT INTO T_LEAD_OVER_DATA VALUES (16,'AA9',10,999,4857,to_date('2025-07-11 10:18:12','YYYY-MM-DD HH24:mi:ss'),0);

1 rows affected.

SQL> commit;

Succeed.

SQL> SELECT id,name,LEAD(NAME,1,id) OVER(partition by name,work_num order by id) as lead FROM T_LEAD_OVER_DATA ORDER BY 1,2,3;

ID           NAME                 LEAD                
------------ -------------------- --------------------
1            AA4                  1                   
2            AA6                  2                   
3            AA9                  AA9                 
4            AA9                  AA9                 
5            AA8                  5                   
6            AA9                  6                   
7            AA7                  7                   
8            AA10                 8                   
9            AA1                  9                   
10           AA9                  10                  
11           AA4                  11                  
12           AA7                  12                  
13           AA9                  13                  
14           AA2                  14                  
15           AA10                 15                  
16           AA9                  16                  

16 rows fetched.

SQL> SELECT id,name,LEAD('+++',1,id) OVER(partition by CREATE_DATE,name,dept order by id,DEPT) as lead FROM T_LEAD_OVER_DATA ORDER BY 1,2,3;

CT-00601, [1:33]Sql syntax error: the length of default value as string is larger
SQL> SELECT id,name,LEAD('+++',1,id+100000) OVER(partition by CREATE_DATE,name,dept order by id,DEPT) as lead FROM T_LEAD_OVER_DATA ORDER BY 1,2,3;

CT-00601, [1:40]Sql syntax error: the length of default value as string is larger
SQL> SELECT id,name,LEAD('$%$%$^%&%^*^&%',abs(1),id*10) OVER(partition by name,work_num order by id) as lead FROM T_LEAD_OVER_DATA ORDER BY 1,2,3;

CT-00601, [1:52]Sql syntax error: the length of default value as string is larger
SQL> SELECT id,name,LEAD('$%$%$^%&%^*^&%',abs(1),-2147483648) OVER(partition by name,work_num order by id) as lead FROM T_LEAD_OVER_DATA ORDER BY 1,2,3;

ID           NAME                 LEAD          
------------ -------------------- --------------
1            AA4                  -2147483648   
2            AA6                  -2147483648   
3            AA9                  $%$%$^%&%^*^&%
4            AA9                  $%$%$^%&%^*^&%
5            AA8                  -2147483648   
6            AA9                  -2147483648   
7            AA7                  -2147483648   
8            AA10                 -2147483648   
9            AA1                  -2147483648   
10           AA9                  -2147483648   
11           AA4                  -2147483648   
12           AA7                  -2147483648   
13           AA9                  -2147483648   
14           AA2                  -2147483648   
15           AA10                 -2147483648   
16           AA9                  -2147483648   

16 rows fetched.

SQL> SELECT id,name,LEAD('rsresegge',1,floor(id+id*id-id/id)) OVER(partition by name,DEPT,CREATE_DATE order by id,LEADER_ID) as lead FROM T_LEAD_OVER_DATA ORDER BY 1,2,3;

CT-00601, [1:58]Sql syntax error: the length of default value as string is larger
SQL> DROP TABLE T_LEAD_OVER_DATA;
Succeed.




