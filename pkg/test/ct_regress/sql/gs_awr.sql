call wsr$create_snapshot;
wsr "2021-6-17 20:00:00" "2021-6-17 20:20:00"

create table DTS2019010800266(xx varchar2(8000), yy varchar2(8000));
select * from DTS2019010800266 
 where xx = '111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111'
   and yy >= '111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111'
   and yy <= '222111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111112';   

create table DTS2019052804148 (xx varchar2(8000), yy varchar2(8000));
select * from DTS2019052804148  
 where xx = '111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111'
   and yy >= '111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111'
   and yy <= '222111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111112';   

call sys.wsr$modify_setting(I_IN_LOG_DAYS=> 20);
call sys.wsr$modify_setting(I_IN_SESSION_INTERVAL=> 30);   
call sys.wsr$modify_setting(STR_IN_SESSION_STATUS=> 'Y'); 
   
call wsr$create_snapshot;
alter system set SQL_STAT = false;
wsr 1 2 "1.html"
alter system set SQL_STAT = true;
alter system set TIMED_STATISTICS = true;
wsr 1 2 "1.html"

wsr 1 2 "./xxxx/1.html"

create user user1 identified by Root1234;
grant connect, statistics to user1;
create user user2 identified by Root1234;
grant connect, statistics to user2;

conn user1/Root1234@127.0.0.1:1611
wsr 1 2 "2.html"
call sys.wsr$create_snapshot;
call sys.wsr$drop_snapshot_range(1, 2);
call sys.WSR$DROP_SNAPSHOT_PARTITION('WSR_SQLAREA', 1);
call sys.WSR$DROP_SNAPSHOT_TIME;
call sys.wsr$modify_setting(str_in_status=> 'Y');
call sys.wsr$modify_setting(i_in_interval_minutes => 30);
call sys.wsr$modify_setting(i_in_retention_days => 30);
call sys.wsr$modify_setting(i_in_topsql=> 100);

select count(null) from ADM_HIST_LONGSQL;
select count(null) from DV_LONG_SQL;
select count(null) from SYS.WSR_LONGSQL;
select count(null) from SYS.WSR_SQLTEXT;
select count(null) from SYS.WSR_SQLPLAN;

conn user2/Root1234@127.0.0.1:1611
wsr 1 2000 "3.html"
wsr "2021-6-17 20:00:00" "2021-6-17 20:20:00" "123.html"
call sys.wsr$create_snapshot;
call sys.wsr$drop_snapshot_range(1, 2);

call sys.WSR$DROP_CTIME_PARTITION('WSR_SQLTEXT', 2);
select count(null) from sys.WSR_EXCEPTION_LOG;

select count(null) from ADM_HIST_LONGSQL;
select count(null) from DV_LONG_SQL;
select count(null) from SYS.WSR_LONGSQL;
select count(null) from SYS.WSR_SQLTEXT;
select count(null) from SYS.WSR_SQLPLAN;
select count(null) from SYS.WSR_INSTANCE_SNAP;
select count(null) from SYS.WSR_SESSION_SQL;
select count(null) from SYS.WSR_EXCEPTION_LOG;
select count(1) from SYS.WSR_EXCEPTION_LOG;
select count(null) from SYS.WSR_SESSION_EVENTS;

conn sys/Huawei@123@127.0.0.1:1611
drop user user1 cascade;
drop user user2 cascade;
